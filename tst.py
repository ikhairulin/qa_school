import re

long_strings = [
'location: https://auth.mail.ru/sdc?from=https%3A%2F%2Fe.mail.ru%2Fmessages%2Finbox%3Fapp_id_mytracker%3D58519%26authid%3Dlmgn291q.7vi%26back%3D1%26dwhsplit%3Ds10273.b1ss12743s%26from%3Dlogin%26x-login-auth%3D1%26back%3D1%26from%3Dnavi',
'Location: https://e.mail.ru/messages/inbox?app_id_mytracker=58519&authid=lmgn291q.7vi&back=1&dwhsplit=s10273.b1ss12743s&from=login&x-login-auth=1&back=1&from=navi',
'{"id": 75065835, "updated": "", "version": "24.05.23", "isWhiteline": true, "isTargetBlank": true, "isModern": true, "visitCookieAliases": ["tv.mail.ru", "horo.mail.ru", "my.mail.ru"], "bizLinks": "", "parentalControlMode": "", "experimentId": "", "siteZone": "45", "siteId": "169", "sitezone": "45", "siteid": "169", "appIdMytracker": "58519", "isDebug": "", "activeEmail": "", "maxAccounts": "20", "loginUrl": "", "loginPage": "", "logoutUrl": "", "logoutPage": "https%3A%2F%2Fmail.ru%2F%3Ffrom%3Dlogout%26ref%3Dmain", "registerBackUrl": "", "colorTheme": "system", "counters": {"thisPropertyIsOnlyForValidJSON": "1","counterAuthMenuOpen": 1126003,"counterLogin": 75068996,"counterLogout": 75068944,"counterRegistration": 75068995,"counterPassAndSecurity": 75068940,"counterPersonal": 75068936,"counterChangeMailbox": 1126018,"counterAddMailbox": 1126064}, "social": {"vk": false,"ok": false,"fb": false}, "experiments": {"thisPropertyIsOnlyForValidJSON": "1","switchUnionQuotaBlock": true,"switchUnionQuotaBlockRadars": true,"unionQuotaLandingUrl": "https://cloud.mail.ru/promo/quota/","switchCloudStoriesCounter": true,"isCloudStoriesCounterDwh": true,"switchCloudStoriesCounterCrossNav": true,"isCloudStoriesCounterDwhCrossNav": true},"authGate": true,"authGateVersion": "https://img.imgsmail.ru/hb/e.mail.ru/auth.gate/2.10.0/authGate.js","authGateSuccessRedirectUrl": "https://e.mail.ru/messages/inbox?back=1","enableExtDomains": true,"isShowLoveCounter": true,"isShowOkCounter": true,"isShowVKCounter": true,"socialCountersTimer": "300000","updateSocialCountersOnVisibilityChange": true,"stayInAccountListOnVisibilityChange": true,"securitySettingsLink": "https://id.mail.ru/security","isOnMarusia": true,"marusiaWidgetUrl": "https://marusia-web.go.mail.ru","metricsCookieEnable": true,"metricsCookieExpires": 7,"mytrackerid": 58519,"metricsCookieParams": "utm_source, utm_medium, utm_campaign, utm_content, utm_term, mt_click_id, mt_link_id","addTargetToNaviData": true,"cloudCounterTimer": "300000","sendDwh": true,"csrfToken": "0f24b1b822ba44e0b9a63b7466086329","omicron_ShortSegments": "6376,6387.w","omicron_Version": "1792"}',
'{"id": 7585195065835, "updated": "", "version": "24.05.23", "isWhiteline": true, "isTargetBlank": true, "isModern": true, "visitCookieAliases": ["tv.mail.ru", "horo.mail.ru", "my.mail.ru"], "bizLinks": "", "parentalControlMode": "", "experimentId": "", "siteZone": "45", "siteId": "169", "sitezone": "45", "siteid": "169", "appIdMytracker": "", "isDebug": "", "activeEmail": "", "maxAccounts": "20", "loginUrl": "", "loginPage": "", "logoutUrl": "", "logoutPage": "https%3A%2F%2Fmail.ru%2F%3Ffrom%3Dlogout%26ref%3Dmain", "registerBackUrl": "", "colorTheme": "system", "counters": {"thisPropertyIsOnlyForValidJSON": "1","counterAuthMenuOpen": 1126003,"counterLogin": 75068996,"counterLogout": 75068944,"counterRegistration": 75068995,"counterPassAndSecurity": 75068940,"counterPersonal": 75068936,"counterChangeMailbox": 1126018,"counterAddMailbox": 1126064}, "social": {"vk": false,"ok": false,"fb": false}, "experiments": {"thisPropertyIsOnlyForValidJSON": "1","switchUnionQuotaBlock": true,"switchUnionQuotaBlockRadars": true,"unionQuotaLandingUrl": "https://cloud.mail.ru/promo/quota/","switchCloudStoriesCounter": true,"isCloudStoriesCounterDwh": true,"switchCloudStoriesCounterCrossNav": true,"isCloudStoriesCounterDwhCrossNav": true},"authGate": true,"authGateVersion": "https://img.imgsmail.ru/hb/e.mail.ru/auth.gate/2.10.0/authGate.js","authGateSuccessRedirectUrl": "https://e.mail.ru/messages/inbox?back=1","enableExtDomains": true,"isShowLoveCounter": true,"isShowOkCounter": true,"isShowVKCounter": true,"socialCountersTimer": "300000","updateSocialCountersOnVisibilityChange": true,"stayInAccountListOnVisibilityChange": true,"securitySettingsLink": "https://id.mail.ru/security","isOnMarusia": true,"marusiaWidgetUrl": "https://marusia-web.go.mail.ru","metricsCookieEnable": true,"metricsCookieExpires": 7,"mytrackerid": 58519,"metricsCookieParams": "utm_source, utm_medium, utm_campaign, utm_content, utm_term, mt_click_id, mt_link_id","addTargetToNaviData": true,"cloudCounterTimer": "300000","sendDwh": true,"csrfToken": "0f24b1b822ba44e0b9a63b7466086329","omicron_Version": "1792"}',
'{"password":"","dirtyFields":["Username","Password","HiddenNums","Code","captcha"],"provider":0,"domain":"mail.ru","login":"","domains":[{"name":"mail.ru","external":false},{"name":"inbox.ru","external":false},{"name":"bk.ru","external":false},{"name":"list.ru","external":false},{"name":"internet.ru","external":false},{"name":"yandex.ru","external":true,"authType":"yandex_oauth"},{"name":"gmail.com","external":true,"authType":"goauth"},{"name":"hotmail.com","external":true,"authType":"msoauth"},{"name":"outlook.com","external":true,"authType":"msoauth"},{"name":"yahoo.com","external":true,"authType":"yahoo_oauth"}],"config":{"platform":{"os":"","osver":"","type":"desktop"},"device":{"dtid":"","wtrid":""},"xray":{"xrayRadarUrl":"/api/v1/utils/xray","verbose":false,"idle":false,"radarPrefix":"","split":"s10273.b1ss12743s","defaultParams":{"p":"login","email":"","dwh":{"from":"navi"}}},"experiments":["undefined",".","disable:pushauth","qrauth","qrauth:polling"],"accounts":[],"xsplit":{"12743":"","vid":"yes","device-type":"desktop","-":"-","fast-auth-skin":"skin-0","beard-skin":"skin-0"},"paths":{"js":"//img.imgsmail.ru/login/{build}/{lang}/app.js","css":"//img.imgsmail.ru/login/{build}/css/","images":"//img.imgsmail.ru/login/{build}/images/","authGate":"//img.imgsmail.ru/ag/2.0.9/authGate.js"},"twoSteps":true,"promo":{"pushAuth":false,"hidePushAuthLink":true,"pulsarOnPassFail":false},"pushAuthMethods":{"email":false,"push":true,"trustedPush":false,"sms":true,"otp":false,"webauthn":true},"urls":{"fontBaseUrl":"https://img.imgsmail.ru/hb/e.mail.ru/static/fonts","vkLoginUrl":"https://id.vk.com/auth?app_id=7799655&origin=&redirect_uri=https%3A%2F%2Fid.vk.com%2Fto_vk_mail","fest":"/cache/templates/","authOrigin":"https://auth.mail.ru","captchaUrl":"https://c.mail.ru/c/1","passremindUrl":"https://e.mail.ru/password/restore/","touchPassremindUrl":"https://touch.mail.ru/password/restore/","signupUrl":"https://e.mail.ru/signup","portalOrigin":"https://portal.mail.ru","page":"https://e.mail.ru/messages/inbox","pageMobile":"https://touch.mail.ru/","xRayRadarUrl":"//xray.imgsmail.ru","statdRadarUrl":"//stat.radar.imgsmail.ru"},"regExps":{"isBack":{},"sota":{},"authOrigin":{},"bundlesLoader":{}},"ssi":{},"userUniqueTheme":{"logo_with_vk":{"logoSrc":"https://img.imgsmail.ru/static.promo/logo/rebranding/header_contrast_mail.svg","logoWidth":162}},"xrayConfig":{"xrayRadarUrl":"/api/v1/utils/xray","verbose":false,"radarPrefix":""},"mailCoreLoggerConfig":{"errors":{"preset":"login","rules":{"thunderbird":{"log":false,"tag":"ign","test":"/thunderbird/.test(source)"}},"silent":true}},"suggestedDomainsConfig":{"suggestedDomains":{"gmail_com":["gmail.ru.com","gmail.ru"],"yandex_ru":["yndeks.ru","ayndex.ru","yndeks.ru"]},"validDomains":["infox.ru","inbow.ru","mail.com","email.ru","myteam1.onpremise.email","myteam2.onpremise.email","school1465.ru","school1468.ru","fa.ru","king-gifts.ru","kinggifts.ru","ymail.com"],"enable":true},"errnoUsernameBlacklist":[],"vkConnectCloseTime":{"min":0,"max":60000,"interval":5000},"openersToHidePortalAndFooter":["vkminiapp","o2","minigames"],"vkcConfigVersion":"0.0.2","defaultDomains":[{"name":"mail.ru","external":false},{"name":"inbox.ru","external":false},{"name":"bk.ru","external":false},{"name":"list.ru","external":false},{"name":"internet.ru","external":false},{"name":"yandex.ru","external":true,"authType":"yandex_oauth"},{"name":"gmail.com","external":true,"authType":"goauth"},{"name":"hotmail.com","external":true,"authType":"msoauth"},{"name":"outlook.com","external":true,"authType":"msoauth"},{"name":"yahoo.com","external":true,"authType":"yahoo_oauth"}],"vkMail":{"pageVKMailHost":"vk.mail.ru","mailHosts":["e.mail.ru","touch.mail.ru","octavius.mail.ru","octavius.alpha.test.mail.ru","octavius.kappa.test.mail.ru","octavius.lambda.test.mail.ru","octavius.iota.test.mail.ru"]},"o2BanLoginExternalList":["goauth"],"radarPrefix":"","radarSplit":"s10273.b1ss12743s","recaptchaSitekey":"6LecopgUAAAAAFusFGTX3rw-L_BG4QtvAOahTCTs","signUpLinkText":"","can_restore":"1","pushAuthNoPass":true,"qrauth":{"background":"rgba(0, 95, 249, 0.04)","highlight":{"max":-1,"color":"rgba(0, 95, 249, 0.12)","delay":3000,"duration":200,"fn":"cubic-bezier(0.45, 0, 0.45, 0)"}},"userUniqueThemeId":"logo_with_vk","portal":{"logo":{"name":"href","href":"https://mail.ru","target":"_self","img":"//img.imgsmail.ru/login/{build}/images/logo2x.png"},"mode":["responsive"]},"mmgameclubDeepLink":"mmgameclub://my.mail.ru","ActiveAccount":"@","CurrentEmail":"","CurrentFullName":" ","HasAnyAuth":false,"isAutoTest":false,"isAlphaServer":false,"isTestServer":false,"IsProductionServer":true,"socialAccounts":[],"supportedDevices":{"Android":"4","iPhone OS":"8","Windows Phone":"8"},"mode":"simple","ux":{},"mrcuCookie":"C50C6500ABD106C3CFF5FFFFFFFF","fromSota":false},"restore":{"id":"","phones":[],"support_disabled":false},"captcha":"","search":{"account_host":"account.mail.ru","allow_external":"1","app_id_mytracker":"58519","from":"navi","mode":"simple","parent_url":"https://mail.ru/","project":"home","responsive":"compact","source":"mailbox","success_redirect":"https://e.mail.ru/messages/inbox?back=1","type":"login","v":"2.10.0"},"isAuthorized":false,"csrf":"0f24b1b822ba44e0b9a63b7466086329","errorMessages":{"Username":null,"Password":null,"Code":null,"HiddenNums":null,"captcha":null},"app":{"state":"unknown","saveAuth":true,"hidden":false,"contentMounted":false,"isDarkMode":false,"forceWebAuthn":false,"enableCustomHandler":false},"authRestore":{"enabled":null,"hasPhone":false,"canPush":false,"trusted":false,"hasAdditionalEmail":false,"hasWebauthnPlatform":false,"hasWebauthnCrossPlatform":false,"auth":"password","setAuthMethod":"","type":null,"token":null,"phone":null,"phoneHiddenNums":"","email":"","phoneList":[],"additionalEmail":"","ratelimit":false,"pushCodeSent":false,"smsCodeSent":false,"pushTimeout":0,"smsTimeout":0,"hasBoundEsia":false,"pending":false,"pushLastSentAt":0,"smsLastSentAt":0,"url":"","code":"","notifierId":null,"codeLength":null,"error":null,"trustedAttemptsRemaining":0},"twoSteps":{"name":"login","pending":false,"error":null,"hadPasswordError":false,"prev":null},"promo":{},"choice":{"step":"unavailable","accounts":[],"current":null,"lost":null,"disabled":false},"isCookiesDisabled":true,"socialAuthState":{"vkAuthInfo":{"token":"","accounts":[]},"error":null,"socialType":null,"bindPhone":null,"loading":false,"isTokenFromExt":false,"bindToken":null,"jsApiVkPreflight":null,"vkIdButtonState":"ready"},"loginAppState":{"phoneLoginSmsTimeout":30000,"loginTransport":"email","initialLoginTransport":"email","activeTab":0,"authOrigin":"https://auth.mail.ru","tabs":[{"name":"email","text":"По почте","testId":"email-tab"},{"name":"phone","text":"По телефону","testId":"phone-tab"}],"needPhoneLoginReset":false,"enablePhoneAuth":false}}',
'Location: https://e.mail.ru/messages/inbox?app_id_mytracker=58519&authid=lmgn291q.7vi&back=1&dwhsplit=s10273.b1ss12743s&from=login&x-login-auth=1&back=1&from=navi',
'location: https://auth.mail.ru/sdc?from=https%3A%2F%2Fe.mail.ru%2Fmessages%2Finbox%3Fapp_id_mytracker%3D58519%26authid%3Dlmgn291q.7vi%26back%3D1%26dwhsplit%3Ds10273.b1ss12743s%26from%3Dlogin%26x-login-auth%3D1%26back%3D1%26from%3Dnavi',
'Location: https://e.mail.ru/messages/inbox?app_id_mytracker=58519&authid=lmgn291q.7vi&back=1&dwhsplit=s10273.b1ss12743s&from=login&x-login-auth=1&back=1&from=navi',
]

long_strings2 = [
'Location: https://auth.mail.ru/sdc?from=https%3A%2F%2Fo2.mail.ru%2Fxlogin%3Fclient_id%3Db4c073bb6c5a4b1b84d2c7d2a1bceb9b%26response_type%3Dtoken%26scope%3D%26redirect_uri%3Dhttps%253A%252F%252Fe.mail.ru%26state%3Dcid%253D1%2526e%25',
'Location: https://o2.mail.ru/xlogin?client_id=b4c073bb6c5a4b1b84d2c7d2a1bceb9b&response_type=token&scope=&redirect_uri=https%3A%2F%2Fe.mail.ru&state=cid%3D1%26e%3D__mailru_oauth_1694542874416_0.5112705781299065__&mode=hidden',
'ilbox-quotas-popup":{"dangerColorPercent":"90","intervals":{"80":"7d","90":"3d","95":"1s"},"moreLink":"https://e.mail.ru/settings/cleanmailbox"},"marusia-read-all-letters":"","marusia-read-letter":"","mentions-mark":"@","messages-attaches-blobcloud":"","messages-attaches-blobcloud-path":"//blobcloud.e.mail.ru/upload/","metathread_redirect":"","metathreads-limit":"10","metathreads-more":"5","metathreads-settings-order":"newsLetters,social,toMyself,receipts,news,official,inbox,school,games","mimic-api-encryptor-limit":"12000","mimic-crypto-api":"plain|1000","mimic-endpoint":"/api-proxy/rb-mimic/v1","mimic-location-href-v4":"/inbox","mimic-sent-bigimageformat":"","mimic-shadow-dom":"","mimic-sidebar-bigimageformat":"","mimic-sidebar-multiformat":"","mini-app-id":"51478058","mobile-addressbook-url":"https://contacts.mail.ru/","moneta-receipt-wrapper":"","nav-up":"","new-ab-compose-view":"","new-ab-suggests":"","new-letter-list-touch-mode":"","new-toolbar":"","new-toolbar-projects-news":"","no-css-grid-log-kaktam":"","no-space-left-disabled":"","noads-button-delay":"1209600","noads-button-href":"https://cloud.mail.ru/promo/quota?feature=ad&utm_source=mail_disable_ad&utm_medium=octavius_btn&utm_campaign=ed.quota","noads-button-show-like-promo-exp":"","noads-button-show-like-promo-force":"","notifications-tab-supported":"","notify-change-password":"3600s","notify-change-password-2fa":"","notify-collector-close-limit":"3","notify-collector-time-interval":"86400","notify-security-checkup":"1h,1m,1h,7d,30d,3m,60d,90d","notify-security-checkup-allow":"ADD_EXTRA_EMAIL,ADD_EXTRA_EMAIL_2FA,PASSWORD,ADD_PHONE,CHECK_PHONE_ACTIVE,CHECK_PHONE_ACTIVE_2FA,SECURITY_CHECKUP,SECURITY_CHECKUP_2FA","notify-security-checkup-disable-check-flags":"","npc-reserved-flags":"7,8,9,10","ntfr_exp-backoff":"{\"minDelay\":120010,\"maxDelay\":3600000,\"jitter\":0.4,\"factor\":2}","ntfr_intervals":"{\"keepalive\":240000,\"successConnect\":3600000}","ntfr_notifier_url":"wss://rebus.calls.mail.ru/api/v3/ws","ntfr_reconnect-attempts":"3","o2-base-url":"https://o2.mail.ru","oauth-client-id":"b4c073bb6c5a4b1b84d2c7d2a1bceb9b","octavius-android-tablet-targeting":"","octavius-button-adv-off-disabled":"",'
]


long_strings3 = [
    'act=0f24b1b822ba44e0b9a63b7466086329; path=/; domain=.mail.ru; Secure; HttpOnly;',
    'E: false,PLATFORM: "Windows",CSRF: "0f24b1b822ba44e0b9a63b7466086329",HONEYPOT: ',
    '"sendDwh": true,"csrfToken": "0f24b1b822ba44e0b9a63b7466086329","omicron_Version": "1792"}',
    '"type":"login","v":"2.10.0"},"isAuthorized":false,"csrf":"0f24b1b822ba44e0b9a63b7466086329","errorMessages":{"Username":null,"Password":null,"Code":',
    'mt_click_id, mt_link_id","addTargetToNaviData": true,"csrfToken": "0f24b1b822ba44e0b9a63b7466086329"}',
    'sendDwh\": true,\"csrfToken\": \"0f24b1b822ba44e0b9a63b7466086329\",\"omicron_ShortSegments\":',
    'sThreads":"0"},"regionId":"50","authCSRFToken":"0f24b1b822ba44e0b9a63b7466086329","api":[{"meth',
    '"300000","sendDwh": true,"csrfToken": "0f24b1b822ba44e0b9a63b7466086329","omicron_ShortSegments": "6379.w","omicron_',
    ' "m",CSRF: "0f24b1b822ba44e0b9a63b7466086329",HONEYPOT: ',
    '"300000","sendDwh": true,"csrfToken": "0f24b1b822ba44e0b9a63b7466086329","omicron_ShortSegments"'
]

long_strings4 = [
    '"idle":false,"radarPrefix":"","split":"s10273.b1ss12743s","defaultParams":{"p":"login","email":"',
    'radarPrefix":"","radarSplit":"s10273.b1ss12743s","recaptchaSitekey":"6LecopgUAAAAAFusFGTX3rw-',
    'radarPrefix":"","split":"s10273.b1ss12743s","defaultParams":',
    'q.7vi&back=1&dwhsplit=s10273.b1ss12743s&from=login&x-login-auth=1&back=1&from=nav',
    '7vi%26back%3D1%26dwhsplit%3Ds10273.b1ss12743s%26from%3Dlogin%26x-login-aut',
    'k=1&dwhsplit=s10273.b1ss12743s&from=login&x-login-auth=1&back=1&from=navi',
]


long_strings5=[
'patron.updateToken("acffe23c82446afd200bf33eac347460:bOr3G7ETPT0YBzPSSYfaWcpJgtR3UsokifuH0cYKqzR7InRpbWUiOjE2OTUzOTM4OTQsInR5cGUiOiJjc3JmIiwibm9uY2UiOiI5NzQ0Zjk3MzZjZDcwNzkyIn0");']

pattern = r'"?(?:mytrackerid|appIdMytracker|app_id_mytracker)"?(?:[:=]|%3D)\s?"?(.*?)"?[,&%]'
pattern2 = r'"?client[-_]id"?(?:[:=]|%3D)"?(.*?)"?[,&%]'
pattern3 = r'"?(?:act|CSRF|csrf)(?:Token)?"?(?:=|:)\s?"?(.*?)"?[,;}]'
pattern4 = r'"?[Ss]plit"?(?:[:=]|%3D)"?(.*?)"?[,&%]'
pattern5 = r'updateToken\("(.{32}:.{123})'


for i in long_strings5:
    match = re.search(pattern5, i)
    if match:
        assert match.group(1) == 'acffe23c82446afd200bf33eac347460:bOr3G7ETPT0YBzPSSYfaWcpJgtR3UsokifuH0cYKqzR7InRpbWUiOjE2OTUzOTM4OTQsInR5cGUiOiJjc3JmIiwibm9uY2UiOiI5NzQ0Zjk3MzZjZDcwNzkyIn0', 'Ошибка, паттерн не отработал полностью'
        print(f'True - {match.group(1)}')
    else:
        print("False")
