(self.webpackChunk_mail_octavius=self.webpackChunk_mail_octavius||[]).push([[2708,4958,7732,4834,9125],{28293:function(e,t,n){var a={"./ru":88217,"./ru.js":88217};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=28293},19125:function(e,t,n){"use strict";n.r(t);var a=n(81171),o=n(63745),r=n.n(o),l=n(5378),i=n(32707),s=n(22313);t.default=function(e){var t=e.iconType,n=i.mx[s.g[t]]||i.mx[l.BD.THUMB_UNKNOWN];return r().createElement(a.Icon,{icon:n,sizeX:5})}},34958:function(e,t,n){"use strict";n.r(t),n.d(t,{LetterHeaderActions:function(){return h}});var a=n(28266),o=n.n(a),r=n(21211),l=n(63745),i=n.n(l),s=n(62336),c=n(30178),d=n(8745),u=n(25654),m=n(99648),p=n(56934),f=function(){return(f=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},h=function(e){var t=(0,m.b)(e),n=t.broadcast,a=t.attrs,l=t.globals,h=t.selectedLettersInfo,E=t.syntheticBlock,v=l.isDisableEdit,g=l.ponyMode,y=l.letter,b=l.readMode,_=l.hasNext,T=l.filterRoute,k=l.hasPrev,C=l.searchRoute,S=l.is3Pane,O=l.is2Pane,M=a.mobile,w=a.letterNotFound,A=a.selected,R=!!A&&A.length>0,N=(b||R)&&!w,U=b&&O,D=R&&S,B={"touch-nav":M,letter:y,ponymode:g,remitEvents:s.j,broadcastEvent:n,useContext:E.radarContext},I={"is-search":C,"is-filter":T,hidden:!U};return e._node.classList[!N?"add":"remove"](p.Z.display_none),i().createElement("div",{"data-qa-id":(0,c.qa)("portal"),"data-qa-type":(0,c.qa)("letter-actions"),className:o()(p.Z.display_mode,D?p.Z.single:p.Z.not_single,r.ENABLE_LETTERS_DIVIDERS&&!I.hidden&&p.Z.short_padding)},i().createElement(u.l,f({},B,I,{type:D?"deselect-back":"back",notDelete:b,short:!0})),i().createElement(d.E,f({},{attrs:a,globalEnv:B,globals:l,selectedLettersInfo:h,displayMode:N})),i().createElement(u.l,f({},B,I,{type:"prev",disabled:v||!k})),i().createElement(u.l,f({},B,I,{type:"next",disabled:v||!_})))}},14553:function(e,t,n){"use strict";n.r(t),n.d(t,{WidgetColumn:function(){return P}});var a=n(17717),o=n.n(a),r=n(81171),l=n(60033),i=n.n(l),s=n(88255),c=n(28266),d=n.n(c),u=n(21211),m=n(63745),p=n.n(m),f=n(5378),h=n(32707),E=n(73794),v=n(54908),g=n(10476),y=n(40520),b=n(52226),_=n(33722),T=n(52692),k=n(50542),C={border:"_2IRpRccFCfe36ihBTjV1pj",open:"A7oaoZsaW4Ml9vya9dgyt",openerWrapper:"wQFurHTKB81kQgnN-ihyM",opener:"svANd540n043bB5YxteNg",tooltip:"SWo-nlMY709XRe2NeuOEu",list:"NPjmvNXLPZaAN18IQ-FFf",hidden:"_22KK-B2H4WzS9bjAa-gOrr",arrowMoveLeft:"_1eU6iUwcmUHIRm8Mq8d5b9",changeWidth:"_2z6saM85M55dfdQsST3XVt"},S=function(){var e=(0,m.useRef)(null);return(0,m.useEffect)((function(){if(e.current){var t=o().get("octavius-productivity-widget-reminder");if(!(t.state||t.getCount().show>=u.COUNT_REPLAY_ANIMATION)){var n=u.TIMEOUT_FIRST_ANIMATION;if(t.getCount().show>0){var a=1e3*t.getTime(),r=(new Date).getTime();n=a+u.TIMEOUT_NEXT_ANIMATION-r}var l,i=(l=n,(0,T.c)((function(){if(!k.default.isComposeActive())e.current.classList.add(C.arrowMoveLeft),o().get("octavius-productivity-widget-reminder").save({time:!0,hit:!0}),(0,b.K9)()}),l));return function(){i()}}}})),{playAnimationRef:e}},O=n(74838),M=n(82427),w=n(75132),A=n(83260),R=function(e){var t,n,a,o,r=e.widgetType,l=e.widgetIsOpen,i=e.broadcast,c=(0,O.l)(r),d=c[0],u=c[1],p=(0,O.l)(l),f=p[0],h=p[1],E=(t=function(){if(d!==r||f!==l)i((0,v.BU)(s.XL,{value:{widget:d,open:f}}))},n=200,o=(0,M.D)(t),(0,w.G)((function(){return(0,A.debounce)(o,n,a)})).current);(0,m.useEffect)((function(){u(r),h(l)}),[r,l,u,h]);var g=(0,M.D)((function(e){if(d!==e)E(),u(e)})),y=(0,M.D)((function(e){if(f!==e)E(),h(e)}));return{widget:d,setWidget:g,open:f,setOpen:y}},N=n(19308),U=y.j.Text,D=function(){return(0,b.lP)("arrow")},B=function(e){var t,n=e.onClick,a=e.open,o=S().playAnimationRef;return(0,m.useEffect)((function(){if(!a)(0,b.Jk)("arrow");return function(){!function(e){e.current.classList.remove(C.arrowMoveLeft)}(o)}}),[a]),p().createElement("div",{className:d()(C.openerWrapper,(0,E.d)("widget-column"),(t={},t[C.hidden]=a,t)),onClick:n,onMouseOver:D},p().createElement("div",{className:C.opener,ref:o},p().createElement(r.Icon,{icon:h.yk[f.tW.NAVIGATION_ARROW_LIST_PREVIOUS]})),p().createElement("div",{className:C.tooltip},p().createElement(U,{width:3},i18n("Показать панель планирования"))))},I={position:"sidebar"},P=function(){var e,t=(0,g.C)({name:"WidgetColumn",mediators:["layout-manager","todo-manager"]}),n=t[0],a=n.showWidgetColumn,r=n.widgetType,l=n.widgetIsOpen,c=t[1],f=R({broadcast:c,widgetType:r,widgetIsOpen:l}),h=f.widget,E=f.setWidget,y=f.open,T=f.setOpen;(0,m.useEffect)((function(){if(u.HIDE_TOYS===u.BL_PROP_NAME)i().send("wid-c-".concat(h,"-").concat(y?"open":"close"))}),[]),(0,m.useLayoutEffect)((function(){return function(){c((0,v.BU)(s._))}}),[c]);var k=u.WIDGET_COLUMN?a:y;return p().createElement(_.M.Provider,{value:I},p().createElement("div",{className:d()(C.border,(e={},e[C.open]=y,e[C.close]=!y,e[C.hidden]=!k,e))},u.WIDGET_COLUMN&&p().createElement(B,{open:y,onClick:function(){(0,b._i)("arrow",b.GE[h]),T(!0);var e=o().get("octavius-productivity-widget-reminder");if(!(null==e?void 0:e.state))null==e||e.save({state:!0,time:!0})}}),p().createElement(N.y,{open:y,widget:h,setOpen:T,setWidget:E,showList:u.WIDGET_COLUMN})))}},22313:function(e,t,n){"use strict";n.d(t,{g:function(){return a}});var a={asx:"THUMB_PLAYLIST",m3u:"THUMB_PLAYLIST",m3u8:"THUMB_PLAYLIST",playlist:"THUMB_PLAYLIST",virus:"THUMB_VIRUS",odc:"THUMB_CHART",otc:"THUMB_CHART",chart:"THUMB_CHART",cb7:"THUMB_EBOOK",cbr:"THUMB_EBOOK",cba:"THUMB_EBOOK",cbt:"THUMB_EBOOK",cbz:"THUMB_EBOOK",djv:"THUMB_EBOOK",djvu:"THUMB_EBOOK",ebook:"THUMB_EBOOK",fb2:"THUMB_EBOOK",epub:"THUMB_EBOOK",mad:"THUMB_MARKDOWN",markdown:"THUMB_MARKDOWN","android-package":"THUMB_ANDROID_PACKAGE",apk:"THUMB_ANDROID_PACKAGE",rss:"THUMB_WEB_FEED","web-feed":"THUMB_WEB_FEED",ics:"THUMB_CALEDAR",ifb:"THUMB_CALEDAR",vcs:"THUMB_CALEDAR",calendar:"THUMB_CALEDAR",ldif:"THUMB_CARD",vcard:"THUMB_CARD",vcf:"THUMB_CARD",card:"THUMB_CARD",folder:"THUMB_FOLDER","folder-camera":"THUMB_FOLDER_CAMERA","folder-shared":"THUMB_FOLDER_SHARED","folder-mounted":"THUMB_FOLDER_SHARED","folder-virus":"THUMB_FOLDER_VIRUS",chm:"THUMB_HTML",mathml:"THUMB_HTML",mht:"THUMB_HTML",mhtml:"THUMB_HTML",mml:"THUMB_HTML",htm:"THUMB_HTML",html:"THUMB_HTML",xhtml:"THUMB_HTML",apng:"THUMB_PICTURE",hdp:"THUMB_PICTURE",ico:"THUMB_PICTURE",j2k:"THUMB_PICTURE",jp2:"THUMB_PICTURE",jpe:"THUMB_PICTURE",jpf:"THUMB_PICTURE",jpm:"THUMB_PICTURE",jpx:"THUMB_PICTURE",jxr:"THUMB_PICTURE",svg:"THUMB_PICTURE",svgz:"THUMB_PICTURE",wdp:"THUMB_PICTURE",webp:"THUMB_PICTURE",jpg:"THUMB_PICTURE",jpeg:"THUMB_PICTURE",gif:"THUMB_PICTURE",bmp:"THUMB_PICTURE",tif:"THUMB_PICTURE",tiff:"THUMB_PICTURE",png:"THUMB_PICTURE",heic:"THUMB_PICTURE",tga:"THUMB_PICTURE",ai:"THUMB_PICTURE",image:"THUMB_PICTURE",raw:"THUMB_PICTURE",graphics:"THUMB_PICTURE",picture:"THUMB_PICTURE",psd:"THUMB_PHOTOSHOP",photoshop:"THUMB_PHOTOSHOP",cab:"THUMB_ARCHIVE",dmg:"THUMB_ARCHIVE",ear:"THUMB_ARCHIVE",tar:"THUMB_ARCHIVE",tbz:"THUMB_ARCHIVE",tgz:"THUMB_ARCHIVE",war:"THUMB_ARCHIVE",arj:"THUMB_ARCHIVE",zipz:"THUMB_ARCHIVE",bzip2:"THUMB_ARCHIVE",bz2:"THUMB_ARCHIVE",gz:"THUMB_ARCHIVE","7z":"THUMB_ARCHIVE",rar:"THUMB_ARCHIVE",zip:"THUMB_ARCHIVE",jar:"THUMB_ARCHIVE",hyp:"THUMB_ARCHIVE",archive:"THUMB_ARCHIVE",conf:"THUMB_PLAIN_TEXT",diff:"THUMB_PLAIN_TEXT",ini:"THUMB_PLAIN_TEXT",mime:"THUMB_PLAIN_TEXT",text:"THUMB_PLAIN_TEXT",log:"THUMB_PLAIN_TEXT",txt:"THUMB_PLAIN_TEXT",lng:"THUMB_PLAIN_TEXT","plain-text":"THUMB_PLAIN_TEXT",asm:"THUMB_SOURCE",atom:"THUMB_SOURCE",cc:"THUMB_SOURCE",cpp:"THUMB_SOURCE",css:"THUMB_SOURCE",cxx:"THUMB_SOURCE",dtd:"THUMB_SOURCE",f:"THUMB_SOURCE",f77:"THUMB_SOURCE",f90:"THUMB_SOURCE",for:"THUMB_SOURCE",gemspec:"THUMB_SOURCE",h:"THUMB_SOURCE",hh:"THUMB_SOURCE",hpp:"THUMB_SOURCE",java:"THUMB_SOURCE",masm:"THUMB_SOURCE",p:"THUMB_SOURCE",pas:"THUMB_SOURCE",pl:"THUMB_SOURCE",pm:"THUMB_SOURCE",rake:"THUMB_SOURCE",ru:"THUMB_SOURCE",s:"THUMB_SOURCE",sgm:"THUMB_SOURCE",sgml:"THUMB_SOURCE",t:"THUMB_SOURCE",tex:"THUMB_SOURCE",texi:"THUMB_SOURCE",texinfo:"THUMB_SOURCE",txi:"THUMB_SOURCE",vbs:"THUMB_SOURCE",xml:"THUMB_SOURCE",yaml:"THUMB_SOURCE",yml:"THUMB_SOURCE",c:"THUMB_SOURCE",js:"THUMB_SOURCE",php:"THUMB_SOURCE",py:"THUMB_SOURCE",rb:"THUMB_SOURCE",source:"THUMB_SOURCE",json:"THUMB_JSON",aifc:"THUMB_AUDIO",mid:"THUMB_AUDIO",oga:"THUMB_AUDIO",ra:"THUMB_AUDIO",wave:"THUMB_AUDIO",ram:"THUMB_AUDIO",midi:"THUMB_AUDIO",wav:"THUMB_AUDIO",ogg:"THUMB_AUDIO",aiff:"THUMB_AUDIO",flac:"THUMB_AUDIO",m4a:"THUMB_AUDIO",wma:"THUMB_AUDIO",mp3:"THUMB_AUDIO",audio:"THUMB_AUDIO",msg:"THUMB_EMAIL",mbox:"THUMB_EMAIL",clx:"THUMB_EMAIL",eml:"THUMB_EMAIL",email:"THUMB_EMAIL",bat:"THUMB_EXE",com:"THUMB_EXE",msi:"THUMB_EXE",sh:"THUMB_EXE",exe:"THUMB_EXE",exec:"THUMB_EXE",executable:"THUMB_EXE",pdf:"THUMB_PDF",m2ts:"THUMB_VIDEO",m4v:"THUMB_VIDEO",matroska:"THUMB_VIDEO",mk3d:"THUMB_VIDEO",mka:"THUMB_VIDEO",mks:"THUMB_VIDEO",mkv:"THUMB_VIDEO",mng:"THUMB_VIDEO",mp4v:"THUMB_VIDEO",mts:"THUMB_VIDEO",ogv:"THUMB_VIDEO",qt:"THUMB_VIDEO",ts:"THUMB_VIDEO",tsa:"THUMB_VIDEO",tsv:"THUMB_VIDEO",vob:"THUMB_VIDEO",wmx:"THUMB_VIDEO",flv:"THUMB_VIDEO",mpg:"THUMB_VIDEO","3gp":"THUMB_VIDEO",mov:"THUMB_VIDEO",asf:"THUMB_VIDEO",mp4:"THUMB_VIDEO",mpeg:"THUMB_VIDEO",avi:"THUMB_VIDEO",wmv:"THUMB_VIDEO",webm:"THUMB_VIDEO",video:"THUMB_VIDEO",docm:"THUMB_DOCUMENT",dot:"THUMB_DOCUMENT",dotx:"THUMB_DOCUMENT",odt:"THUMB_DOCUMENT",ott:"THUMB_DOCUMENT",pages:"THUMB_DOCUMENT",doc:"THUMB_DOCUMENT",docx:"THUMB_DOCUMENT",rtf:"THUMB_DOCUMENT",wps:"THUMB_DOCUMENT",wpd:"THUMB_DOCUMENT",document:"THUMB_DOCUMENT",csv:"THUMB_SPREADSHEET",numbers:"THUMB_SPREADSHEET",ods:"THUMB_SPREADSHEET",ots:"THUMB_SPREADSHEET",xls:"THUMB_SPREADSHEET",xlsx:"THUMB_SPREADSHEET",xlsb:"THUMB_SPREADSHEET",xlsm:"THUMB_SPREADSHEET",excel:"THUMB_SPREADSHEET",spreadsheet:"THUMB_SPREADSHEET",key:"THUMB_PRESENTATION",keynote:"THUMB_PRESENTATION",odp:"THUMB_PRESENTATION",otp:"THUMB_PRESENTATION",pot:"THUMB_PRESENTATION",potm:"THUMB_PRESENTATION",potx:"THUMB_PRESENTATION",ppsm:"THUMB_PRESENTATION",pptm:"THUMB_PRESENTATION",ppt:"THUMB_PRESENTATION",pptx:"THUMB_PRESENTATION",pps:"THUMB_PRESENTATION",ppsx:"THUMB_PRESENTATION",presentation:"THUMB_PRESENTATION","excel-online":"THUMB_EXCEL_ONLINE","powerpoint-online":"THUMB_POWERPOINT_ONLINE","word-online":"THUMB_WORD_ONLINE"}},26235:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Ei}});var a=n(81171),o=n(63745),r=n.n(o),l={title:i18n("Ошибка при сохранении файлов"),close:i18n("Закрыть")},i=n(4278),s=n(28266),c=n.n(s),d=n(40520),u="_2DuBfto-XbFgBB7jA-SEgn",m="YHziy8PL3svFrkypcrlrt",p="_1wKDuGpSBaf5FGUQlz3_23",f="_2O5l0pEqLgDOdXsU1kbpi0",h="_181ioJY6x3hE1wEID1tAce",E="_1sffr8cSZ156jZ5eSUhFby",v=function(e){var t,n=e.title,o=e.negativeButtonText,l=e.positiveButtonText,i=e.unknownButtonText,s=e.disabled,v=e.small,g=e.indented,y=e.onPositiveClick,b=e.onNegativeClick,_=e.onUnknownClick,T=c()(((t={})[u]=!0,t[h]=v,t[E]=v&&g,t));return r().createElement(d.Z,null,(function(e){var t=e.Button;return r().createElement("div",{className:T},r().createElement("div",{className:m},r().createElement(a.Text,{secondary:!0,text:n})),r().createElement("div",{className:p},r().createElement(t,{onClick:b,disabled:s,mode:"secondary",appearance:"neutral",size:"s"},o),r().createElement("div",{className:f}),!!i&&r().createElement(r().Fragment,null,r().createElement(t,{onClick:_,disabled:s,mode:"secondary",appearance:"neutral",size:"s"},r().createElement(a.Text,{text:i,mode:"small"})),r().createElement("div",{className:f})),r().createElement(t,{onClick:y,disabled:s,mode:"secondary",appearance:"neutral",size:"s"},l)))}))},g=n(79929),y="_2V7LTszlTINOh3CSVOQfgq",b="_10uBzyD3XY00dgex_ehMnA",_="pVdU5AdXYDsvEp4hoDuFG",T="_3b_tW5VKCs76_dYO9ZQ9Hs",k="_2FSFbDla5oQAn2yQ7xcT8P",C="_2VZ0EY32IZhrTr-9mcUA08",S="_2mVf7d9ZpxUMYYij7Lj7Z3",O=function(e){var t,n,o=e.small,l=e.indented,i=e.onNotInterestingClick,s=e.onAlreadyPurchasedClick,u=e.onOtherClick,m=e.onCancelClick,p=c()(((t={})[y]=!0,t[b]=o,t[_]=o&&l,t)),f=c()(((n={})[C]=!0,n[S]=o,n));return r().createElement("div",{className:p},r().createElement(d.Z,null,(function(e){var t=e.Button;return r().createElement("div",{className:T},r().createElement(t,{onClick:m,size:"s",mode:"tertiary",before:r().createElement("div",{style:{display:"flex"}},r().createElement(a.Icon,{icon:g.ACTIONS_CLOSE}))}))})),r().createElement("div",{className:f},r().createElement("span",{onClick:i,className:k},i18n("Не интересует тема")),r().createElement("span",{onClick:s,className:k},i18n("Уже куплено")),r().createElement("span",{onClick:u,className:k},i18n("Иная причина"))))},M=n(19125),w=n(22e3),A=n(56480);function R(e,t){var n=t.one,a=t.many;return 1===e?n:a}var N,U,D=n(21211),B=n(12199),I=n(78381),P="PYWbz7iDRANq-rcj1HnGD",x="_1Fx4sel0_yQc_829Y-NC57",H="_3VRa3Oke0jvi15ZZiAXsTI",L="_3tFIEVfLI2js4Xt03prydF",F="_2JRHs7IIUxr_vQQ6y-UYrH",Z="_1X2w25WlZYhC74I5Q5IB4I",q="NdtqSOtLWhHc3hGqG5-oL",j="_1u-Wwswc_xWFA0QXNNvySF",V="lddh6oGGYau2ap2qfKJ0q",W="QQBOLGk7zzSEd8HnB6WrE",Y="_3SrHpMNsn2QgsuRm822qgo",z="_2Zu7wp58wMDPJnM_cDP_3l",G="_2s3_4wFY391gFTwt29a0_g",K="_2k5-U5g15ZVDMngyN7bQmH",X={healthy:"CHECK_SHIELD",probablyHealthy:"CHECK_SHIELD",unchecked:"STATUS_WARNING_ROUND",danger:"STATUS_WARNING_ROUND"},Q=function(e){var t,n,o,l=e.safetyStatus,i=e.hasBackground,s=e.attachCount,d=e.mobile,u={healthy:{text:R(s,{one:d?i18n("Файл проверен"):i18n("Файл проверен антивирусом"),many:d?i18n("Файлы проверены"):i18n("Файлы проверены антивирусом")}),hint:R(s,{one:i18n("Вирусов в нём не нашли"),many:i18n("Вирусов в них не нашли")})},probablyHealthy:{text:R(s,{one:d?i18n("Файл безопасен"):i18n("Почта считает файл безопасным"),many:d?i18n("Файлы безопасны"):i18n("Почта считает файлы безопасными")}),hint:R(s,{one:null,many:null})},unchecked:{text:R(s,{one:d?i18n("Файл не проверен"):i18n("Файл не проверен антивирусом"),many:d?i18n("Файлы не проверены"):i18n("Файлы не проверены антивирусом")}),hint:R(s,{one:i18n("Не открывайте его, если не доверяете отправителю"),many:i18n("Не открывайте их, если не доверяете отправителю")})},danger:{text:i18n("Обнаружены вирусы"),hint:R(s,{one:i18n("Не открывайте файл, он может навредить"),many:i18n("Не открывайте файлы, они могут навредить")})}},m=X[l],p=u[l],f=p.text,h=p.hint,E="healthy"===l,v="probablyHealthy"===l,g="danger"===l,y="unchecked"===l,b=c()(q,((t={})[j]=E||v,t[V]=y,t[W]=g,t)),_=c()(Y,((n={})[z]=E||v,n[G]=y,n[K]=g,n)),T=c()(x,((o={})[H]=i,o[L]=i&&(E||v),o[F]=i&&y,o[Z]=i&&g,o));return r().createElement("div",{className:P},r().createElement("div",{className:T},r().createElement("span",{className:b},r().createElement(I.Z,{name:m,component:B.Z})),D.SHOW_ATTACH_SAFETY_STATUS_TOOLTIP?r().createElement("span",{className:_},r().createElement(a.Tooltip,{overlay:r().createElement(a.Text,{mode:"small",text:h}),overlayContainer:document.body,showByClick:!0,testId:"attach-safety-status-tooltip"},f)):r().createElement("span",{className:_},f)))},J=n(60033),$=n.n(J),ee=n(5378),te=n(32707),ne=n(22313),ae=function(e){var t=e.attachIcon,n=e.size,o=void 0===n?23:n;return r().createElement(a.Icon,{icon:t,sizeX:o})},oe=a.TwoKitTheming.createUseStyles((function(e){return{spacer:{width:e.x2.value},controlsBarBottom:{display:"flex",width:"100%",justifyContent:"space-between"},controlsBarItem:{display:"flex",margin:e.x3.value,width:"calc(100% - 2*".concat(e.x3.value,")")}}})),re=function(e){var t=e.iconDownload,n=e.iconUpload,o=e.downloadBtnTitle,l=e.downloadBtnTooltip,i=e.uploadBtnTitle,s=e.uploadBtnTooltip,c=e.link,d=e.onCloudUploadClick,u=e.onDownloadClick,m=e.isDownload,p=e.isCloudUpload,f=oe(e);return r().createElement("div",{className:f.controlsBarBottom,"data-test-id":"controlsBarBottom"},m&&r().createElement(a.Tooltip,{overlay:r().createElement(a.Text,{mode:"small",text:l}),overlayContainer:document.body},r().createElement("a",{className:f.controlsBarItem,onClick:u,"data-test-id":"download",href:c},r().createElement(a.Icon,{icon:t}),r().createElement("div",{className:f.spacer}),r().createElement(a.Text,{text:o,mode:"small"}))),p&&r().createElement(a.Tooltip,{overlay:r().createElement(a.Text,{mode:"small",text:s}),overlayContainer:document.body},r().createElement("div",{className:f.controlsBarItem,onClick:d,"data-test-id":"cloud"},r().createElement(a.Icon,{icon:n}),r().createElement("div",{className:f.spacer}),r().createElement(a.Text,{text:i,mode:"small"}))))},le="_1cxy2LRKQ87SyaqdQ6reTe",ie="_1rxuLJo77v4lUrVe4mnNM6",se="_5Fs81lZrvIDR55HR5JtzB",ce="_1d_4AzngkI4NdXO72TE-IY",de="_1QDMIBW3LTw2-mmIP68Ub6",ue=function(e){var t=e.attachName,n=e.icon,o=e.couldExpired,l=e.expiredText,i=e.onExpiredClick,s=te.mx[ee.BD.LINK];return r().createElement("div",{className:le,"data-test-id":"thumb-header"},n&&r().createElement("div",{className:se},r().createElement(a.Icon,{icon:n,sizeX:5})),t&&r().createElement("div",{className:ie},r().createElement(a.Text,{mode:"small",text:t})),o&&r().createElement(a.Tooltip,{overlay:function(){return r().createElement("div",{className:ce,"data-test-id":"thumb-footer-link-overlay"},r().createElement(a.Text,{mode:"small",text:l}))},overlayContainer:document.body},r().createElement("div",{className:de,"data-test-id":"link"},r().createElement(a.Icon,{icon:s,onClick:i}))))},me="_3JaY_XKz-_Ywfpcjy91efA",pe="_2IOjOGA3e62io7V05XBC71",fe=function(){return r().createElement("div",{className:me,"data-test-id":"attach-warning-content"},r().createElement("div",{className:pe},r().createElement(a.Text,{text:i18n("Файл заражен"),secondary:!0})))},he="Nz9IjvD763mPUnVv4IDIj",Ee="_2eoVLi9EUpT0iSnJNzqBm9",ve=function(){var e=(0,a.fillIcon)(g.STATUS_ERROR,{fill:"white"});return r().useEffect((function(){$().send("attach_show_warn_overlay")}),[]),r().createElement("div",{className:he,"data-test-id":"attach-warning-overlay"},r().createElement("div",{className:Ee},r().createElement(a.Avatar,{small:!0,warning:!0,icon:e})),r().createElement("div",null,r().createElement(a.Text,{mode:"h5",text:i18n("Файл заражен")}),r().createElement(a.Margin,{mobileX:1,desktopX:1}),r().createElement(a.Text,{text:i18n("Осторожно: Касперский нашел в этом файле вирус")})))},ge=function(){return(ge=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},ye=function(e){var t,n=e.title,o=e.preview,l=e.fullPreview,i=e.iconType,s=e.downloadBtnTitle,c=e.downloadBtnTooltip,d=e.uploadBtnTitle,u=e.uploadBtnTooltip,m=e.linkTitle,p=e.isLink,f=e.link,h=e.onDownloadClick,E=e.onCloudUploadClick,v=e.onOpenClick,g=e.testId,y=e.attachWarningTooltip,b=e.disableCloudUpload,_=a.TwoKitTheming.useTheme(),T=y&&(0,a.fillIcon)(te.mx[ee.BD.WARNING],{fill:_.colorIconNegative.normal.value})||te.mx[ne.g[i]]||te.mx[ee.BD.THUMB_UNKNOWN],k=te.mx[ee.BD.ACTIONS_DOWNLOAD_ALT],C=te.mx[ee.BD.ACTIONS_TO_CLOUD],S=o&&!l||y,O=r().createElement(ue,ge({},!l&&{attachName:n},S&&{icon:T},{couldExpired:p,expiredText:m,onExpiredClick:v})),M=r().createElement(re,{isDownload:!y,isCloudUpload:!b&&!y,iconDownload:k,iconUpload:C,downloadBtnTitle:s,downloadBtnTooltip:c,uploadBtnTitle:d,uploadBtnTooltip:u,link:f,onDownloadClick:h,onCloudUploadClick:E}),w=ge(ge({tooltip:function(){if(y)return r().createElement(ve,null);else return n}(),testId:"thumb",footer:M},y&&{tooltipProps:{promo:!0,arrow:!0,arrowMode:"soft"},bgMode:"error",footerMode:"naked"}),{onClickOpen:v,header:O}),A=o?l?"previewFull":"preview":"noPreview",R=function(){if(y)return r().createElement(fe,null);if("noPreview"===A)return r().createElement(ae,{attachIcon:T});else return o};switch(r().useEffect((function(){$().send("attach_show_".concat(y?"warn_tltp":"health"))}),[]),A){case"preview":t=r().createElement(a.Thumb,ge({},w,{mode:"preview",content:R(),testId:g,onClickOpen:v}));break;case"previewFull":t=r().createElement(a.Thumb,ge({},w,{mode:"previewFull",content:R(),testId:g,onClickOpen:v}));break;case"noPreview":t=r().createElement(a.Thumb,ge({},w,{mode:"noPreview",content:R(),testId:g,onClickOpen:v}))}return r().createElement(r().Fragment,null,t)},be="pjQlFxOKi2oRlK2qST1m6",_e="_3L1OP_26_tOJUigKZMCQzI",Te="_3m-VQOK91WGFrn1CJMxTRz",ke="_3dMGqPWv-hkTqHelgvF0T2",Ce="_1Ko2vm-w49kO9M0mYUoDSc",Se="_1WJxOkau14yQgz68dWAGWL",Oe=function(e){var t,n,a,o=e.text,l=e.isLight,i=e.isDarkMode,s=e.onCloseClick,d=e.onClick,u=c()(((t={})[_e]=!0,t[ke]=i,t[Ce]=l,t)),m=c()(((n={})[be]=!0,n[Se]=!i,n)),p=c()(((a={})[Te]=!0,a));return r().createElement("button",{onClick:d,className:u},r().createElement("div",{className:m},o),r().createElement("div",{className:p,onClick:s}))},Me=n(74127),we=function(){return{popup:{textAlign:"left"},controls:{display:"flex"}}},Ae=(N=function(e,t){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}N(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Re=function(e,t,n,a){var o,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)if(o=e[i])l=(r<3?o(l):r>3?o(t,n,l):o(t,n))||l;return r>3&&l&&Object.defineProperty(t,n,l),l},Ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={show:!0},t.onClose=function(){t.setState({show:!1}),t.props.onClose()},t.onAttachClick=function(){var e=t.props.onAttachClick;t.onClose(),e()},t}return Ae(t,e),t.prototype.render=function(){var e=this,t=this.props.classes,n=this.state.show;return r().createElement(a.Popup,{show:n,onHide:this.onClose,closeByEsc:!0,width:"420px",testId:"file-limit-popup"},r().createElement(a.Panel,{popup:!0,onClose:this.onClose},r().createElement("div",{className:t.popup},r().createElement(a.Text,{mode:"h3"},i18n("Будут прикреплены 100 файлов")),r().createElement("div",null,r().createElement(a.Margin,{mobile:10,desktop:16}),r().createElement(a.Text,null,i18n("Вы можете присоединить к письму не более 100 файлов"))),r().createElement(a.Margin,{mobile:10,desktop:40}),r().createElement(a.Hr,{oversize:!0}),r().createElement(a.Margin,{mobile:10,desktop:20}),r().createElement(d.Z,null,(function(n){var o=n.Button;return r().createElement("div",{className:t.controls},r().createElement(o,{onClick:e.onAttachClick,"data-test-id":"attach-button",size:"l"},i18n("Прикрепить")),r().createElement(a.Space,null),r().createElement(o,{mode:"secondary",appearance:"neutral",onClick:e.onClose,"data-test-id":"cancel-button",size:"l"},i18n("Отмена")))})))))},t=Re([(0,a.withStyles)(we)],t)}(r().PureComponent),Ue=n(76163),De=function(e){var t=e.children,n=e.getPlatform,a=e.link,o=e.Node,l=r().useMemo((function(){if("function"==typeof n)return{android:D.ANDROID_APP_DEEPLINK,ios:D.IOS_APP_DEEPLINK,vkcom:D.ANDROID_APP_DEEPLINK}[n()]}),[n]);if(!a&&!l)return null;else return r().createElement(o,{href:a||l,target:"_blank"},t)},Be="_2s56hG5wBhW2ZTTkOnDlYe",Ie="_2WDzPi24RK87sWea-37YZj",Pe="_2mf7Dx10FNGNKSn8HlPnG6",xe=(0,Ue.vU)({unknownError:i18n("Что-то пошло не так"),downloadApp:i18n("Скачать приложение")}),He=function(e){var t=e.errorText,n=void 0===t?xe.unknownError:t,a=e.actionText,o=void 0===a?xe.downloadApp:a,l=e.actionHref;return r().createElement(d.Z,null,(function(e){var t=e.platform,a=e.Button,i=e.Spacing,s=e.Title;return r().createElement("div",{className:Be},r().createElement("div",{className:Ie},r().createElement("img",{className:Pe,src:"//img.imgsmail.ru/hb/e.mail.ru/static/vk-mini-app/images/unknown-error.png",srcSet:"//img.imgsmail.ru/hb/e.mail.ru/static/vk-mini-app/images/unknown-error@2x.png 2x",alt:""}),r().createElement(i,null),r().createElement(s,{level:"1"},n)),r().createElement(De,{Node:a,link:l,getPlatform:t},o))}))},Le=n(42339),Fe=n(28430),Ze="_3oIyeg5-APZE-wMgE1Sa4R",qe="_5aXw-8m9Z2YfntoapsIrl",je="yBGr5VSpZsrNAzlkZNINP",Ve="_1WFYMWbtt3C453rYcJ6cj",We="_25HeWmeK-5bvP9wNFp7Xsx",Ye=function(e){var t=e.children,n=e.onChangeExpandState,o=e.placement,l=e.reservePlacement,i=e.adDescription,s=e.overlayContainer,c=r().useMemo((function(){return(0,Fe.yP)(i)}),[i]);return r().createElement("div",{className:Ze},r().createElement(a.Dropdown,{placement:null!=o?o:"bottom",reservePlacement:null!=l?l:"top",pureOverlay:!0,overlay:function(){return r().createElement("div",{className:qe},r().createElement("div",{className:je},D.TRANSLATE_ABOUT_AD?i18n("Рекламная интеграция"):"Рекламная интеграция"),r().createElement("a",{className:Ve,href:c,target:"_blank",rel:"noopener noreferrer"},r().createElement("img",{className:We,src:"https://img.imgsmail.ru/hb/e.mail.ru/static/icons/img/82/AB7DCF.svg",alt:""}),D.TRANSLATE_ABOUT_AD?i18n("О рекламодателе"):"О рекламодателе"))},overlayContainer:s,onChangeExpandState:n},t))},ze="_13OlX00wr6HZedRW0_4y5q",Ge="_1U0AAuV1rA5qIf9yWHDLEe",Ke="_1n83Qbln9HESp-GH8yTvnY",Xe=function(e){switch(e){case"vertical":return te.yk[ee.tW.NAVIGATION_MORE_VERTICAL];default:case"horizontal":return te.yk[ee.tW.NAVIGATION_MORE]}},Qe=function(e){var t,n=e.className,o=e.mode,l=e.pressed,i=e.onClick,s=e.contrast;return r().createElement("div",{className:c()(ze,(t={},t[Ke]=l,t[Ge]=s,t[n]=!!n,t)),onClick:i},r().createElement(a.Icon,{icon:Xe(o)}))},Je=function(e){var t,n=e.adDescription,a=e.onChangeExpandState,o=e.placement,l=e.reservePlacement,i=e.className,s=e.mode,d=e.overlayContainer,u=e.onClick,m=e.contrast,p=r().useState(!1),f=p[0],h=p[1];return r().useEffect((function(){null==a||a(f)}),[a,f]),r().createElement(Ye,{adDescription:n,onChangeExpandState:h,placement:o,reservePlacement:l,overlayContainer:d},r().createElement(Qe,{mode:s,pressed:f,className:c()((t={},t[i]=!!i,t)),onClick:u,contrast:m}))},$e="_1NwMwhTfjiaK5NkfLxVun0",et="_24W00GUXAc1hiwoPHdD3UE",tt="_2x4zBiAo7Avv0IZuceXWWf",nt="_1q-jtefI3wS9HUis6j0FXl",at="CqAGbQM2kVpRixOIkdj8D",ot="Q4Vjzfg5le4oTgqWpRLMx",rt="_2E1HVnCJ8JRhMo9qhBnxyQ",lt=function(){return(lt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},it=(0,Fe.Qe)(D.KASPERSKY_ABOUT_AD_RAW)?D.KASPERSKY_ABOUT_AD_RAW:D.KASPERSKY_ABOUT_AD_DEFAULT,st=function(e){return e?te.yk[ee.tW.KASPERSKY_LOGO_ALTER_ENG]:te.yk[ee.tW.KASPERSKY_LOGO_ALTER_RUS]},ct=function(e){var t=e.children,n=e.onLogoLinkClick;return r().createElement("a",{href:D.KASPERSKY_LOGO_HREF,target:"_blank",rel:"noopener noreferrer",onClick:n,className:tt},t)},dt=function(e){var t,n,o,l,i=e.isEngLogo,s=e.onLogoLinkClick,d=e.contrast,u=r().useState(!1),m=u[0],p=u[1];if(!D.KASPERSKY_LOGO_WITH_AD_DROPDOWN)return r().createElement(ct,{onLogoLinkClick:s},r().createElement(a.Icon,{icon:(l=i,l?te.yk[ee.tW.KASPERSKY_LOGO_ENG]:te.yk[ee.tW.KASPERSKY_LOGO_RUS])}));else return r().createElement("div",{className:c()($e,(t={},t[et]=d,t))},r().createElement(ct,{onLogoLinkClick:s},r().createElement(a.Icon,{icon:st(i)})),r().createElement("span",{className:nt},"•"),r().createElement("div",{className:at},D.TRANSLATE_ABOUT_AD?i18n("реклама"):"реклама"),r().createElement(Je,{className:c()(ot,(n={},n[rt]=!m,n)),adDescription:lt((o={},o[Fe.Jo.Subject]=D.KASPERSKY_LOGO_HREF,o),it),onChangeExpandState:p,contrast:d}))},ut=a.TwoKitTheming.createUseStyles((function(e){var t=e.x2,n=e.x4,a=e.x5,o=e.x6,r=e.x10,l=e.colorBackgroundSecondary;return{titleBlock:{paddingBottom:n.value},folderList:{height:"240px",background:l.normal.value,overflow:"auto",marginLeft:"-32px",marginRight:"-32px",padding:"".concat(t.value," 0")},folder:{display:"flex",alignItems:"center",height:r.value,borderRadius:t.value,paddingLeft:t.value,marginLeft:o.value,marginRight:o.value},notChosenFolder:{"&:hover":{background:l.hover.value}},chosenFolder:{background:l.active.value},folderIcon:{marginRight:t.value,marginTop:"3px","& svg":{fill:"#FFCA5A"}},folderName:{overflow:"hidden",textOverflow:"ellipsis"},buttonsBlock:{paddingTop:a.value}}})),mt=function(e){var t=e.tree,n=e.onSave,l=e.onClose,i=ut(e),s=(0,o.useState)(null),u=s[0],m=s[1],p=(0,o.useState)(!0),f=p[0],h=p[1],E=function(){n(t[u])};return r().createElement(a.Popup,{show:!0,width:"var(--vkui--size_popup_small--regular)",testId:"choose-save-folder-popup"},r().createElement(a.Panel,{popup:!0,closable:!0,onClose:l},r().createElement("div",{className:i.titleBlock},r().createElement(a.Text,{mode:"h3"},i18n("Сохранить в папку"))),r().createElement("div",{className:i.folderList},t.map((function(e,t){var n=t===u?i.chosenFolder:i.notChosenFolder,o=c()(i.folder,n);return r().createElement("div",{key:t,className:o,onClick:function(){return function(e){m(e),h(!1)}(t)},"data-test-id":"folder-item-".concat(t)},r().createElement("div",{className:i.folderIcon},r().createElement(a.Icon,{icon:g.NAVIGATION_FOLDER})),r().createElement("div",{className:i.folderName},r().createElement(a.Text,null,e)))}))),r().createElement("div",{className:i.buttonsBlock},r().createElement(d.Z,null,(function(e){var t=e.Button;return r().createElement(t,{disabled:f,onClick:E,size:"l","data-test-id":"save-button"},i18n("Сохранить"))})))))},pt=n(93286),ft=n(92042),ht=n.n(ft),Et=n(63062),vt=n(21091),gt=a.TwoKitTheming.createUseStyles((function(e){var t=e.x3,n=e.x4,a=e.x5;return{titleBlock:{paddingBottom:n.value},spacer:{width:t.value},buttonsBlock:{paddingTop:a.value,display:"flex"},buttonsBlockReverse:{flexDirection:"row-reverse",justifyContent:"flex-end"}}}));!function(e){e.spam="spam:force",e.undo="undo",e.resolve="layer:resolve",e.unsubscribe="unsubscribe",e.remove="remove"}(U||(U={}));var yt={headerUnsubscribe:i18n("Это не только спам"),headerConfirm:i18n("Переместить в «Спам»?"),contentUnsubscribe:i18n("Здесь есть рассылка, на которую вы подписались.{br} Если вы её не читаете, отпишитесь.{br} Выделенные письма от этих отправителей попадут в{space}корзину.",{"unsafe-br":"<br/>","unsafe-space":"&nbsp;"}),contentConfirmSingle:i18n("Выделенное письмо будет перемещено в «Спам»"),contentConfirmPlural:i18n("Выделенные письма будут перемещены в «Спам»")},bt=function(e){var t=[],n=[];return e.forEach((function(e){var a,o,r,l=null===(r=null===(o=null===(a=e.get("correspondents"))||void 0===a?void 0:a.from)||void 0===o?void 0:o[0])||void 0===r?void 0:r.email;if(!n.includes(l))n.push(l);t.push(e.get("last"))})),{senders:n,ids:t}},_t=function(e){var t=gt(e),n=e.onEvent,l=e.unsubscribeModels,i=e.models,s=e.type,u=e.actionType,m=(0,o.useState)(!0),p=m[0],f=m[1],h=(0,o.useState)(void 0),E=h[0],v=h[1],g=(0,o.useState)([]),y=g[0],b=g[1],_=function(){n({type:U.resolve,details:{close:!0}})},T=function(e,t){if(void 0===t)t=!0;if(null==e?void 0:e.length)n({type:U.spam,details:{model:e}});f(!1),t&&_()},k=(0,o.useCallback)((function(){var e=bt(i).senders,t="confirm"===s?"layer-confirm-move-to-spam_spam-as-submit_click":"layer-confirm-move-to-spam_spam-as-cancel_click";(0,pt.ZP)({type:t,dwh:{letters_length:i.length,senders_length:e.length,action_type:u}}),T(i)}),[i]),C=function(){var e,t=!1,a=bt(l).senders,o=Et.default.add({text:(e=a.length,(0,vt.I)(e)),actions:[{text:i18n("Отменить")}],qa:"notify-unsubscribe-from-spam-layer"});if(o)o.on("action",(function(){t=!0,o.close()})),o.on("closed",(function(){if(!t)return(0,pt.ZP)({type:"unsubscribe_from_spam",dwh:{letters_length:y.length,senders_length:a.length,action_type:u}}),e=y,n({type:U.unsubscribe,details:{ids:e,silent:!0}}),void _();var e;(0,pt.ZP)({type:"unsubscribe_from_spam_cancel",dwh:{letters_length:l.length,senders_length:a.length,action_type:u}}),function(){if(null==E?void 0:E.undo)return E.undo().then((function(){n({type:U.undo})}))}().then((function(){return _()}))}))},S=(0,o.useCallback)((function(){var e=i.filter((function(e){return!l.includes(e)}));T(e,!1);var t=bt(l).senders;(0,pt.ZP)({type:"layer-confirm-move-to-spam_unsubscribe_click",dwh:{spam_letters_length:e.length,senders_length:t.length,letters_length:l.length,action_type:u}}),function(e){var t=bt(e).ids;b(t)}(l),n({type:U.remove,details:{model:l,actionCallback:v}}),f(!1)}),[l,i]),O=(0,o.useCallback)((function(){(0,pt.ZP)({type:"layer-confirm-move-to-spam_close",dwh:{type:s,action_type:u}}),_()}),[]),M=(0,o.useCallback)((function(){(0,pt.ZP)({type:"layer-confirm-move-to-spam_cancel_click",dwh:{letters_length:i.length,action_type:u}}),_()}),[]);if((0,o.useEffect)((function(){if(E)C()}),[E]),!p)return r().createElement(r().Fragment,null);else return r().createElement(a.Popup,{show:!0,testId:"confirm-move-to-spam"},r().createElement(a.Panel,{popup:!0,closable:!0,onClose:O,mobileCross:!0},r().createElement("div",{className:t.titleBlock},r().createElement(a.Text,{mode:"h3"},function(){if(l.length)return yt.headerUnsubscribe;else return yt.headerConfirm}())),r().createElement("div",null,r().createElement("span",{dangerouslySetInnerHTML:{__html:function(){if(l.length)return yt.contentUnsubscribe;if(i.length>1||i[0]instanceof ht()&&i[0].get("length")>1)return yt.contentConfirmPlural;else return yt.contentConfirmSingle}()}})),"confirm"===s&&r().createElement(d.Z,null,(function(e){var n,a=e.Button;return r().createElement("div",{className:c()(t.buttonsBlock,(n={},n[t.buttonsBlockReverse]=D.BUTTON_MOVE_TO_SPAM_CANCEL_LEFT_POSITION,n))},r().createElement(a,{size:"l",mode:D.BUTTON_MOVE_TO_SPAM_CANCEL_PRIMARY?"secondary":"primary",appearance:D.BUTTON_MOVE_TO_SPAM_CANCEL_PRIMARY?"neutral":"accent","data-test-id":"submit",onClick:k},i18n("Переместить")),r().createElement("div",{className:t.spacer}),r().createElement(a,{size:"l",mode:D.BUTTON_MOVE_TO_SPAM_CANCEL_PRIMARY?"primary":"secondary",appearance:D.BUTTON_MOVE_TO_SPAM_CANCEL_PRIMARY?"accent":"neutral","data-test-id":"cancel",onClick:M},i18n("Отменить")))})),"unsubscribe"===s&&r().createElement(d.Z,null,(function(e){var n=e.Button;return r().createElement("div",{className:t.buttonsBlock},r().createElement(n,{size:"l","data-test-id":"submit",onClick:S},i18n("Отписаться")),r().createElement("div",{className:t.spacer}),r().createElement(n,{size:"l",mode:"secondary",appearance:"neutral","data-test-id":"cancel",onClick:k},i18n("В спам")))}))))},Tt=a.TwoKitTheming.createUseStyles((function(e){var t=e.x3,n=e.x4,a=e.x5;return{titleBlock:{paddingBottom:n.value},spacer:{width:t.value},buttonsBlock:{paddingTop:a.value,display:"flex"}}})),kt={fakeDoorTitle:i18n("Функция вот-вот появится"),fakeDoorMessage:i18n("Спасибо за ваш интерес! Мы обязательно сообщим, когда всё будет готово"),close:i18n("Понятно")},Ct=function(e){var t=e.onClose,n=Tt(e);return r().createElement(a.Popup,{show:!0,width:"var(--vkui--size_popup_small--regular)"},r().createElement(a.Panel,{popup:!0,closable:!0,onClose:t},r().createElement("div",{className:n.titleBlock},r().createElement(a.Text,{mode:"h3"},kt.fakeDoorTitle)),r().createElement("div",null,r().createElement("span",null,kt.fakeDoorMessage)),r().createElement("div",{className:n.buttonsBlock},r().createElement(a.Button,{primary:!0,testId:"submit",onClick:t},kt.close))))},St=n(30178),Ot=a.TwoKitTheming.createUseStyles((function(e){var t=e.x3,n=e.x4,a=e.x8;return{titleBlock:{paddingBottom:n.value},spacer:{width:t.value},buttonsBlock:{paddingTop:a.value,display:"flex"},imageContainer:{position:"absolute",bottom:0,right:0,height:"120px"},image:{height:"100%"},button:{zIndex:1}}})),Mt=function(e){var t=Ot(e),n=e.onClose,o=e.onSubmit,l=e.showImage,i=e.imageSrc,s=e.lockClose,c=e.hideCancel;return r().createElement(a.Popup,{show:!0,width:420,closeByBackdropClick:!s,closeByEsc:!s,testId:"promo-enabled-push",onHide:n,overflowVisible:!0},r().createElement(a.Panel,{popup:!s,closable:!s,onClose:n,closeByEsc:!s},r().createElement("div",{className:t.titleBlock},r().createElement(a.Text,{mode:"h3",text:i18n("Уведомления в браузере")})),r().createElement(a.Text,{text:i18n("Включите уведомления, чтобы не пропускать важные письма")}),r().createElement("div",{className:t.buttonsBlock},r().createElement("div",{className:t.button},r().createElement(a.Button,{primary:!0,testId:"submit",onClick:o},i18n("Включить"))),r().createElement("div",{className:t.spacer}),!(s||c)&&r().createElement("div",{className:t.button},r().createElement(a.Button,{testId:"cancel",onClick:n},i18n("Отмена")))),l&&r().createElement("div",{className:t.imageContainer,"data-test-id":(0,St.qa)("promo-image")},r().createElement("img",{className:t.image,src:i}))))},wt="_1pl7vWcbXz5W3zZPRB8QkV",At="_3jwEnb6b5yXYJQX3srMIQM",Rt=function(e){var t=(0,o.useState)([]),n=t[0],a=t[1],r=(0,o.useState)(!1),l=r[0],i=r[1],s=(0,o.useState)(!1),c=s[0],d=s[1];return(0,o.useEffect)((function(){e().then((function(e){i(!0),a(e.map((function(e){return e.data})))})).catch((function(){d(c)}))}),[]),[n,l,c]},Nt=function(){return r().createElement(r().Fragment,null,r().createElement(a.Margin,{desktopX:2,mobileX:1}),r().createElement("div",{className:wt},r().createElement(a.Progress,{primary:!0})))},Ut=function(e){var t=e.text,n=e.testId,o=e.error;return r().createElement(r().Fragment,null,r().createElement(a.Margin,{desktopX:8,mobileX:8}),r().createElement("div",{className:wt},r().createElement(a.Text,{text:t,testId:n,secondary:!0,error:o})),r().createElement(a.Margin,{desktopX:6,mobileX:6}))},Dt=function(e){var t=e.onChoose,n=e.onClose,l=e.fetchTemplates,i=e.appliedTemplate,s=(0,o.useState)(i),c=s[0],u=s[1],m=Rt(l),p=m[0],f=m[1],h=m[2],E=function(){var e=p.find((function(e){return e.id===c}));e&&t(e),n()};return r().createElement(a.Popup,{width:window.innerWidth-16,show:!0,testId:"select-template-popup"},r().createElement(a.Panel,{popup:!0,header:i18n("Выбор шаблона"),closable:!0,controls:r().createElement(d.Z,null,(function(e){var t=e.Button;return r().createElement("div",null,r().createElement(t,{"data-test-id":"submit",size:"l",onClick:E,disabled:!f||!c||h||0===p.length,stretched:!0},i18n("Выбрать")),r().createElement(a.Space,null),r().createElement(t,{"data-test-id":"cancel",size:"l",mode:"secondary",appearance:"neutral",disabled:!f,onClick:n,stretched:!0},i18n("Отменить")))})),onClose:n},!f&&!h&&r().createElement(Nt,null),h&&r().createElement(Ut,{text:i18n("Не удалось загрузить шаблоны"),error:!0}),f&&0===p.length&&r().createElement(Ut,{text:i18n("У вас отсутствуют сохраненные шаблоны"),testId:"no-templates"}),r().createElement("div",null,p.map((function(e){var t=e.id,n=e.value;return r().createElement("div",{key:t,className:At},r().createElement(a.Radio,{label:n,checked:c===t,name:t,value:t,onChange:function(){return u(t)},testId:"template:".concat(n)}),r().createElement(a.Margin,{desktopX:2,mobileX:2}))})))))},Bt=n(4727),It=n(47759),Pt=n(92049),xt=n(51422),Ht=n(29404),Lt=n(14077),Ft=n(90557),Zt=n(33440),qt=n(79087),jt=n(86450),Vt=n(45114),Wt=n(38205),Yt=n(43353),zt=n(19291),Gt=n(4076),Kt=n(59574),Xt=n(15598),Qt=n(37240),Jt=n(41026),$t=n(45069),en=n(71474),tn=n(62718),nn=n(17914),an=n(56882),on=n(15498),rn=n(73794),ln=function(){return(ln=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},sn=new rn.k("letter-body");function cn(){var e=this,t=ln(ln({},this.props),this.state),n=!(!t["quotes-raw"]&&!t["quotes-formatted"].length),a=t["body-raw"],o=t["dark-mode"],l=t.message;return r().createElement("div",{"data-qa-id":(0,St.qa)("letter-body"),ref:this.letterBodyRef,className:sn.root({mobile:t.mobile,"formatted-quotes":!t["quotes-mode-raw"]&&t["quotes-formatted"].length,"raw-quotes":t["quotes-mode-raw"]&&t["quotes-raw"],quotes:n,"dark-mode":o})},r().createElement("div",{"data-qa-id":(0,St.qa)("body"),className:sn.elem("body",{"no-scroll":t["preview-mode"]})},r().createElement("div",{ref:"body",className:sn.elem("body-wrapper")},r().createElement("div",{tabIndex:-1,ref:"js-body",className:sn.elem("body-content")},!!a&&r().createElement(I.Z,{ref:this.bodyParserRef,id:"body-parser",content:a,darkosha:this.getOrCreateDarkosha(),message:l,"dark-mode":o,remitEvents:{zoom:"letter:zoom"},broadcastEvent:(0,xt.Yv)(this),component:an.Z,key:"html-parser"})))),!!n&&r().createElement(r().Fragment,null,!!t.collapsable&&r().createElement("div",{className:sn.elem("badge")},r().createElement(I.Z,{badge:!0,secondary:!0,ico:"navigation:more","data-qa-id":(0,St.qa)("blockquote-toggler"),centered:!0,remitEvents:{click:"blockquote:toggle"},broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,key:"button2"})),!t.collapsable&&r().createElement("div",{"data-qa-id":(0,St.qa)("blockquote-title"),className:sn.elem("title")},i18n("вся переписка")),r().createElement("div",{ref:"blockquotes","data-qa-id":(0,St.qa)("blockquotes"),className:sn.elem("blockquotes")},!(t.collapsable&&this.isCollapsed())&&r().createElement(r().Fragment,null,!!t["quotes-mode-raw"]&&r().createElement("div",{"data-qa-id":(0,St.qa)("raw"),className:sn.elem("blockquotes-raw")},r().createElement(I.Z,{ref:this.quoteParserRef,id:"quote-parser",content:t["quotes-raw"],darkosha:this.getOrCreateDarkosha(),message:l,component:an.Z,key:"html-parser"})),!t["quotes-mode-raw"]&&t["quotes-formatted"].map((function(n,a){return r().createElement(I.Z,{key:"letter-blockquote",index:a,blockquote:n,ponymode:t.ponymode,message:l,darkosha:e.getOrCreateDarkosha(),remitEvents:{"blockquote-zoom":"letter:zoom"},updateRemitEventsName:!0,broadcastEvent:(0,xt.Yv)(e),component:on.Z})}))))))}var dn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),un=function(){return(un=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},mn=function(e,t,n){if(n||2===arguments.length)for(var a,o=0,r=t.length;o<r;o++)if(a||!(o in t)){if(!a)a=Array.prototype.slice.call(t,0,o);a[o]=t[o]}return e.concat(a||Array.prototype.slice.call(t))}([],Object.values(nn.u.events),!0),pn=function(e){function t(t){var n=e.call(this,t)||this;return n.letterBodyMounted=!1,n.events=nn.u.events,n.asyncDidMountRender=nn.u.asyncDidMountRender,n.onBlockquoteToggle=nn.u.onBlockquoteToggle,n.onLetterZoom=nn.u.onLetterZoom,n.handelDataAttributeClick=nn.u.handelDataAttributeClick,n.handleClickAllowedAttr=nn.u.handleClickAllowedAttr,n.handleClickRightFinePayment=nn.u.handleClickRightFinePayment,n.handleClickFinePayment=nn.u.handleClickFinePayment,n.handleClickToMyself=nn.u.handleClickToMyself,n.handleClickMonetaLink=nn.u.handleClickMonetaLink,n.handleClickMonetaPayment=nn.u.handleClickMonetaPayment,n.getOrCreateDarkosha=nn.u.getOrCreateDarkosha,n.applyDarkosha=nn.u.applyDarkosha,n.renderBody=nn.u.renderBody,n.format=nn.u.format,n.formatNew=nn.u.formatNew,n.formatFallback=nn.u.formatFallback,n.rerenderParser=nn.u.rerenderParser,n.isCollapsed=nn.u.isCollapsed,n.triggerBlockquoteChange=nn.u.triggerBlockquoteChange,n.highlightCurrentUserMention=nn.u.highlightCurrentUserMention,n.render=cn,n.letterBodyRef=r().createRef(),n.bodyParserRef=r().createRef(),n.quoteParserRef=r().createRef(),mn.forEach((function(e){n[e]=n[e].bind(n)})),n}return dn(t,e),Object.defineProperty(t.prototype,"el",{get:function(){return this.letterBodyRef.current},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ids",{get:function(){var e={};if(this.bodyParserRef.current)e["body-parser"]=this.bodyParserRef.current.component;if(this.quoteParserRef.current)e["quote-parser"]=this.quoteParserRef.current.component;return e},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.letterBodyMounted=!0,nn.u.didMount.bind(this)()},t.prototype.componentDidUpdate=function(e,t){var n=un(un({},this.props),this.state),a=un(un({},e),t);if(n.id!==a.id){var o=n.id,r=a.id;if(!o||!r||o===r)return;this.renderBody()}},t.prototype.componentWillUnmount=function(){this.letterBodyMounted=!1,nn.u.didUnmount.bind(this)()},t.prototype.isMounted=function(){return this.letterBodyMounted},t}(r().Component),fn=(0,xt.v$)("letter-body",pn,{syncMediatorsOnRender:!1});fn.defaultProps=nn.u.defaults;var hn=fn,En=n(62387),vn=n(15907),gn=n(89746),yn=n(3754),bn="Dij-kL-gfkN5i71rllDra",_n=function(e){var t=e.model,n=e.tags,o=function(e){var n;(0,En.dB)(t,e);var a=null===(n=null==t?void 0:t.getFolder())||void 0===n?void 0:n.id;$().send("click_delete_label",{dwh:{folder_id:Number(a),from:"message",label_name:e,letter_id:null==t?void 0:t.id,mode:vn.default.getType(),is_compact:vn.default.getUiLayout().ponyMode}})},l=D.TAGS_ORDER.filter((function(e){return null==n?void 0:n.includes(e)})).map((function(e){return r().createElement(gn.Z,{key:e,tag:e,onCloseClick:o})})).reverse(),i=(null==l?void 0:l.length)===(null===D.TAGS_ORDER||void 0===D.TAGS_ORDER?void 0:D.TAGS_ORDER.length);return r().createElement(r().Fragment,null,!!(null==l?void 0:l.length)&&r().createElement("div",{"data-qa-id":(0,St.qa)("letter-tags"),className:bn},l,!i&&r().createElement(a.Dropdown,{overlay:r().createElement(yn.Z,{model:t,tags:n,xrayFrom:"message_change_menu"}),pureOverlay:!0,placement:"bottomLeft",reservePlacement:"topLeft",overlayContainer:document.body},r().createElement(gn.Z,{onClick:function(){var e,n=null===(e=null==t?void 0:t.getFolder())||void 0===e?void 0:e.id;$().send("click_on_add_label_button",{dwh:{folder_id:Number(n),from:"message_change_menu",letter_id:null==t?void 0:t.id,mode:vn.default.getType(),is_compact:vn.default.getUiLayout().ponyMode}})}}))))},Tn=n(52950),kn=function(){return(kn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},Cn=new rn.k("marusia-rl-button");function Sn(){var e=kn(kn({},this.props),this.state);return r().createElement("div",{className:Cn.root()},r().createElement("img",{src:this.getLogoSrc(),onClick:(0,xt.CH)(this,{name:"marusia:rl:button:click",details:e.model}),className:Cn.elem("img")}),r().createElement("div",{className:Cn.elem("button")},r().createElement(I.Z,{text:i18n("Прочитать письмо"),ico:"actions:play",icoSize:"xs",compact:!0,shadowless:!0,invert:!0,centered:!0,remitEvents:{click:"marusia:rl:button:click"},remitDetails:{model:e.model},broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,key:"button2"})))}var On=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Mn=function(e,t,n){if(n||2===arguments.length)for(var a,o=0,r=t.length;o<r;o++)if(a||!(o in t)){if(!a)a=Array.prototype.slice.call(t,0,o);a[o]=t[o]}return e.concat(a||Array.prototype.slice.call(t))}([],Object.values(Tn.u.events),!0),wn=function(e){function t(t){var n=e.call(this,t)||this;return n.blockIsMounted=!1,n.rootClassName=Tn.u.rootClassName,n.events=Tn.u.events,n.onClick=Tn.u.onClick,n.getLogoSrc=Tn.u.getLogoSrc,n.radarSend=Tn.u.radarSend,n.render=Sn,Mn.forEach((function(e){n[e]=n[e].bind(n)})),n}return On(t,e),t.prototype.componentDidMount=function(){this.blockIsMounted=!0,Tn.u.didMount.bind(this)()},t.prototype.componentWillUnmount=function(){this.blockIsMounted=!1},t.prototype.isMounted=function(){return this.blockIsMounted},t}(r().Component),An=(0,xt.v$)("marusia-read-letter-button",wn,{syncMediatorsOnRender:!1}),Rn=n(37968),Nn=function(){return(Nn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},Un=new rn.k("notification-badge");function Dn(){var e,t=Nn(Nn({},this.props),this.state);return r().createElement("div",{className:Un.root()},!!t.show&&r().createElement("div",{"data-qa-id":(0,St.qa)("".concat(t["test-id"])),className:Un.elem("badge",(e={react:!0},e["color_".concat(t.colorMode)]=!!t.colorMode,e["size_".concat(t.size)]=!!t.size,e))}),this.props.children)}var Bn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),In=function(){return(In=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},Pn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getCssRule=Rn.u.getCssRule,t.setInlineStyles=Rn.u.setInlineStyles,t.render=Dn,t}return Bn(t,e),t.prototype.componentDidUpdate=function(e,t){var n=In(In({},this.props),this.state),a=In(In({},e),t);if(n.ponymode!==a.ponymode)this.setInlineStyles();if(n.show!==a.show&&n.show)this.setInlineStyles()},t.prototype.didMount=function(){Rn.u.didMount.bind(this)()},t}(r().Component),xn=(0,xt.v$)("notification-badge",Pn,{syncMediatorsOnRender:!1});xn.defaultProps=Rn.u.defaults;var Hn,Ln=xn,Fn="_2oRHl88bWX55jteN4U-fwG",Zn=function(){return(Zn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},qn=new rn.k("letter");function jn(e){var t=e["amp-error"];return r().createElement(r().Fragment,null,r().createElement("span",{"data-qa-id":(0,St.qa)("amp-icon"),className:qn.elem("amp-icon",{error:t}),title:i18n("При отображении динамического контента письма возникли ошибки")},r().createElement(I.Z,{inlineRoot:!0,name:"status:breaking",size:"s",component:B.Z,key:"ico"})))}function Vn(e,t,n,a){var o=this,l=e.ponymode,i=a?t.slice(0,a):t,s=e.model.getFolder();return r().createElement(r().Fragment,null,i.map((function(t,a){var c=t.email==e["current-user"].getEmail(),d=a+1===i.length;return r().createElement(I.Z,{inlineRoot:!0,key:"letter-contact-".concat(a),useMediators:["contact-selection"],contact:t,dir:n,isCurrent:c,dangerous:"from"===n&&o.isProbablyPhishing(),"pony-mode":l,isLast:d,remitEvents:{click:{stop:!0,prevent:!0,name:"contact:click"}},remitDetails:t,broadcastEvent:(0,xt.Yv)(o),component:Qt.Z,className:Fn,folder:s})})))}function Wn(e){var t=e.model;return r().createElement(r().Fragment,null,r().createElement("div",{"data-qa-id":(0,St.qa)("unread"),className:qn.elem("unread",{plain:!(t.is("flags.forward")||t.is("flags.reply"))})},r().createElement(I.Z,{disabled:e["disable-edit"],name:"unread",compact:!e.compact,small:e.compact,forward:t.is("flags.forward"),reply:t.is("flags.reply"),state:t.is("flags.unread"),remitEvents:{click:{prevent:!0,name:"togglestatus:unread"}},remitDetails:{model:e.model,state:t.is("flags.unread")},broadcastEvent:(0,xt.Yv)(this),component:$t.Z,key:"letter-status2"})))}function Yn(e){return!e["preview-mode"]&&r().createElement("div",{className:qn.elem("tags")},r().createElement(a.Dropdown,{placement:"topLeft",pureOverlay:!0,overlay:r().createElement(yn.Z,{model:e.model,tags:e.model.get("flags.tags"),xrayFrom:"message_icon_menu"})},r().createElement(I.Z,{"radar-id":"add-tag",text:i18n("Добавить метку"),ico:"status:tag",secondary:!0,short:!0,centered:!0,touch:e.touch,"data-qa-id":"add-tag",component:"button2"})))}function zn(e){return!e["preview-mode"]&&r().createElement("div",{"data-qa-id":(0,St.qa)("dark-mode-toggle"),className:qn.elem("dark-mode-toggle")},!e["preview-mode"]&&r().createElement(I.Z,{name:"dark-mode",state:e["dark-mode-enabled"],remitEvents:{click:{prevent:!0,name:"dark-mode:toggle"}},broadcastEvent:(0,xt.Yv)(this),component:$t.Z,key:"letter-status2"}))}function Gn(e){var t=e.model;return r().createElement(r().Fragment,null,r().createElement("div",{"data-qa-id":(0,St.qa)("flag"),className:qn.elem("flag")},!e["preview-mode"]&&r().createElement(I.Z,{disabled:!this.isEnableMark(),name:"flagged",state:t.is("flags.flagged"),remitEvents:{click:{prevent:!0,name:"togglestatus:flagged"}},remitDetails:{model:e.model,state:t.is("flags.flagged")},broadcastEvent:(0,xt.Yv)(this),component:$t.Z,key:"letter-status2"})))}function Kn(e){return r().createElement(r().Fragment,null,r().createElement("div",{"data-qa-id":(0,St.qa)("calls:invite"),className:qn.elem("flag",{},{addClass:[(0,rn.d)("letter-head-calls-button")]})},!e["preview-mode"]&&r().createElement(I.Z,{"radar-id":"head-call",title:i18n("Позвонить"),ico:"categories:camera",base:!0,secondary:!0,touch:e.touch,model:e.model,disabled:!this.isEnableCall(),centered:!0,remitEvents:{click:{prevent:!0,name:"calls:invite"}},remitDetails:e.model,broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,key:"button2"})))}function Xn(e){return r().createElement(r().Fragment,null,r().createElement("div",{"data-qa-id":(0,St.qa)("print"),className:qn.elem("flag")},!e["preview-mode"]&&r().createElement(I.Z,{"radar-id":"head-print",title:i18n("Распечатать"),ico:"actions:print",base:!0,secondary:!0,touch:e.touch,model:e.model,centered:!0,remitEvents:{click:{prevent:!0,name:"print"}},remitDetails:e.model,broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,key:"button2"})))}function Qn(e){return r().createElement(r().Fragment,null,r().createElement("div",{"data-qa-id":(0,St.qa)("calendar:create"),className:qn.elem("flag",{},{addClass:[(0,rn.d)("letter-head-calendar-button")]})},!e["preview-mode"]&&r().createElement(I.Z,{"radar-id":"head-calendar",title:i18n("Создать событие"),ico:"calendar-month",base:!0,secondary:!0,touch:e.touch,model:e.model,disabled:e["disable-edit"],centered:!0,remitEvents:{click:{prevent:!0,name:"calendar:create"}},remitDetails:{model:e.model,createContent:"web_email_letter_header"},broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,key:"button2"})))}function Jn(e){var t=e.model,n=t.get("correspondents.from.0");return r().createElement(r().Fragment,null,r().createElement("div",{className:qn.elem("avatar-wrap")},!e.compact&&this.statusUnread(e),r().createElement("div",{"data-qa-id":(0,St.qa)("avatar"),onClick:(0,xt.CH)(this,{stop:!0,prevent:!0,name:"clickavatar",details:n}),className:qn.elem("avatar")},r().createElement(Ln,{show:e.isOnline,colorMode:"success","test-id":e.isOnline&&"online-badge"},r().createElement(I.Z,{size:e.compact?"m":"s",src:t.get("correspondents.from.0.avatars.default"),touch:e.touch,component:jt.Z,key:"avatar"}))),!!e.compact&&this.statusUnread(e)))}function $n(e){var t,n=e.model,a=n.getFolder(),o="",l="";if(n.isHigh())o="important";if(!e["disable-category"]&&n.get("transaction_category")&&!a.isSpam())o=n.get("transaction_category");if(e.showfolder)l=a.get("name");return r().createElement(r().Fragment,null,r().createElement("div",{className:qn.elem("folder",(t={},t["".concat(!(!l&&!o))]=!0,t.react=!0,t))},r().createElement(I.Z,{short:!l,name:o,text:l,size:"l",component:Kt.Z,key:"letter-category"})))}function ea(e){var t=e.model;return r().createElement(r().Fragment,null,r().createElement("div",{"data-qa-id":(0,St.qa)("date"),className:qn.elem("date",{react:!0})},this.mods.getLocaleDateFull(t.get("date"))))}function ta(e){var t=e.model,n=this.getMessageCorrespondents(),a=n.length>3?2:n.length,o=n.length-a,l=e.model.get("correspondents.bcc.length"),i=e.model.get("correspondents.cc.length");return r().createElement(r().Fragment,null,!e["details-expanded"]?r().createElement("div",{"data-qa-id":(0,St.qa)("recipients:short"),className:qn.elem("recipients",{short:!0})},r().createElement("span",{className:qn.elem("recipient-type")},"".concat(i18n("Кому"),":")),this.correspondents(e,n,"to",a),!!(n.length>3)&&r().createElement("a",{"data-qa-id":(0,St.qa)("recipients:short-expand"),onClick:(0,xt.CH)(this,{prevent:!0,name:"details:expand"}),className:qn.elem("recipients-short-expand")},"".concat(i18n("и ещё")," "),!!e.touch&&{moreCount:o},!e.touch&&this.mods.correspondentsCount(o))):r().createElement("div",{"data-qa-id":(0,St.qa)("recipients:expanded"),className:qn.elem("recipients",{expanded:!0})},r().createElement("div",{className:qn.elem("header-details-recipient")},r().createElement("span",{className:qn.elem("recipient-type")},"".concat(i18n("Кому"),":")),this.correspondents(e,t.get("correspondents.to"),"to"),!(i||l)&&r().createElement("a",{"data-qa-id":(0,St.qa)("recipients:short-collapse"),onClick:(0,xt.CH)(this,{prevent:!0,name:"details:collapse"}),className:qn.elem("recipients-short-collapse")},i18n("Скрыть список"))),!!i&&r().createElement("div",{className:qn.elem("header-details-recipient")},r().createElement("span",{className:qn.elem("recipient-type")},"".concat(i18n("Копия"),":")),this.correspondents(e,t.get("correspondents.cc"),"cc"),!l&&r().createElement("a",{"data-qa-id":(0,St.qa)("recipients:short-collapse"),onClick:(0,xt.CH)(this,{prevent:!0,name:"details:collapse"}),className:qn.elem("recipients-short-collapse")},i18n("Скрыть список"))),!!l&&r().createElement("div",{className:qn.elem("header-details-recipient")},r().createElement("span",{className:qn.elem("recipient-type")},"".concat(i18n("Скрытая"),":")),this.correspondents(e,t.get("correspondents.bcc"),"bcc"),r().createElement("a",{"data-qa-id":(0,St.qa)("recipients:short-collapse"),onClick:(0,xt.CH)(this,{prevent:!0,name:"details:collapse"}),className:qn.elem("recipients-short-expand")},i18n("Скрыть список")))))}function na(e){var t=e.model,n=t.getFolder(),a=(0,Lt.gA)(t),o=e.folders;return r().createElement(r().Fragment,null,r().createElement("div",{"data-qa-id":(0,St.qa)("more"),className:qn.elem("more")},!e.readonly&&r().createElement(I.Z,{text:i18n("Ещё"),ico:"more-hor",secondary:!0,"expand-left":!0,"disable-edit":e["disable-edit"],model:t,parentThread:e.parentThread,folders:o,folder:e.model.folder,read:t.is("flags.unread")?!0:null,unread:!t.is("flags.unread")?!0:null,flag:!t.is("flags.flagged")?!0:null,unflag:t.is("flags.flagged")?!0:null,archive:!n.isArchive(),spam:this._showSpam(),selectedLettersIds:[t.get("id")],unsubscribe:this._showUnsubscribeInMoreMenu(),unspam:n.isSpam(),"dark-mode":this.isDarkMode(),metathreads:e.metathreads,"create-event":this._showDropdownCalendarButton(),"invite-call":this._showDropdownCallButton(),"create-filter":this._showFilterButton(),"category-feedback":e["category-feedback"]&&!e.touch,translate:!e["disable-translate"],more:!0,remove:!0,move:!0,readletter:!0,print:!0,reply:a?"all":!0,"radar-id":"more",useMediators:["letters-selection","compose-manager","letters-actions","calls-manager","calendar-manager","settings-filters-manager","translator-manager","unsubscribe-actions"],component:Yt.Z,key:"dropdown-actions"})))}function aa(e){var t=e.model,n=(0,Lt.gA)(t),a=t.get("id"),o=t.get("correspondents.from")[0].email;return r().createElement(r().Fragment,null,r().createElement("div",{"data-qa-id":(0,St.qa)("unsubscribe"),className:qn.elem("footer-button")},r().createElement(I.Z,{useMediators:["unsubscribe-actions","themes-manager"],touch:e.touch,senderFrom:o,letterId:a,"position-right":!0,short:n,component:Ft.mV,key:"unsubscribe"})))}function oa(e){var t=e.model;e.model.is("attaches.list.length")&&this.isEnableAttach();var n=t.get("drafts.replyall");return r().createElement("div",{className:qn.elem("dropdown-overlay")},r().createElement(I.Z,{text:i18n("Есть черновик, продолжить с ним"),remitEvents:{click:"letter:draft:replyall"},remitDetails:{model:e.model,draftId:n},broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,base:!0,pure:!0,touch:e.touch}),r().createElement(I.Z,{text:i18n("Новое письмо"),remitEvents:{click:"compose:replyall"},remitDetails:e.model,broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,base:!0,pure:!0,touch:e.touch}))}function ra(e){var t=e.model;e.model.is("attaches.list.length")&&this.isEnableAttach();var n=t.get("drafts.reply");return r().createElement("div",{className:qn.elem("dropdown-overlay")},r().createElement(I.Z,{text:i18n("Есть черновик, продолжить с ним"),remitEvents:{click:"letter:draft:reply"},remitDetails:{model:e.model,draftId:n},broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,base:!0,pure:!0,touch:e.touch}),r().createElement(I.Z,{text:i18n("Новое письмо"),remitEvents:{click:"compose:reply"},remitDetails:e.model,broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,base:!0,pure:!0,touch:e.touch}))}function la(e){var t=e.model.get("drafts.forward");return r().createElement("div",{className:qn.elem("dropdown-overlay")},r().createElement(I.Z,{text:i18n("Есть черновик, продолжить с ним"),remitEvents:{click:"letter:draft:forward"},remitDetails:{model:e.model,draftId:t},broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,base:!0,pure:!0,touch:e.touch}),r().createElement(I.Z,{text:i18n("Новое письмо"),remitEvents:{click:"compose:forward"},remitDetails:e.model,broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,base:!0,pure:!0,touch:e.touch}))}function ia(e){return r().createElement("div",{className:qn.elem("dropdown-overlay")},r().createElement(I.Z,{text:i18n("Позвонить сейчас"),ico:"categories:camera","data-qa-id":(0,St.qa)("calls:call"),"radar-id":"footer-calls-groupcall",disabled:!this.isEnableCall(),title:!e["disable-calls-tip"]&&i18n("Если собеседники онлайн на сайте Mail.ru, они увидят вызов и смогут ответить сразу"),remitEvents:{click:"calls:groupcall"},remitDetails:e.model,broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,base:!0,pure:!0}),r().createElement(I.Z,{text:i18n("Отправить ссылку на звонок"),ico:"status:link","data-qa-id":(0,St.qa)("calls:invite"),"radar-id":"footer-calls-invite",disabled:!this.isEnableCall(),title:!e["disable-calls-tip"]&&i18n("Собеседники получат ссылку для видеозвонка и присоединятся, когда перейдут по ней"),remitEvents:{click:"calls:invite"},remitDetails:e.model,broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,base:!0,pure:!0}))}function sa(){var e=this,t=Zn(Zn({},this.props),this.state),n=t.model,o=t.model.is("attaches.list.length")&&this.isEnableAttach(),l=(0,Lt.gA)(n),i=n.get("drafts.reply"),s=n.get("drafts.replyall"),c=n.get("drafts.forward"),d=t.ponymode,u=this.isAMPLetter(),m=t["amp-error"],p=this.getLetterMetaHeaderType(n),f=n.get("flags.maybe_phishing"),h=l&&t["sticky-reduce-reply"],E=t["marusia-portal-enabled"]&&this.isMarusiaReadLetterEnabled(),v=t["marusia-portal-enabled"]&&t["marusia-read-all-letters"],g=this.getMarusiaReadLetterRadarPrefix(),y=t.smart_replies&&this.isEnableReply();return r().createElement("div",{ref:this.letterRef,className:qn.root({priority:!0,unread:!0,attach:!0,single:t.single,first:t.first,last:t.last,touch:t.touch,compact:t.compact,fluid:!t.compact,sticky:t.sticky,"native-sticky":t["native-sticky"],"hover-support":t["hover-support"],"expanded-next":t["expanded-next"],"light-mode":!this.isDarkMode()})},r().createElement("div",{"data-qa-id":(0,St.qa)("head"),onClick:(0,xt.CH)(this,"clickhead"),className:qn.elem("head",{sticky:t["sticky-head"],"sticky-fade":t["sticky-head-fade"]})},r().createElement("div",{className:qn.elem("header-row")},this.avatarWrap(t),r().createElement("div",{"data-qa-id":(0,St.qa)("head:details"),className:qn.elem("header-details")},r().createElement("div",{className:qn.elem("author")},this.correspondents(t,n.get("correspondents.from"),"from"),!t.compact&&this.date(t),!t.compact&&this.folder(t),(u&&!t["preview-mode"]||m)&&!t.compact&&this.ampIcon(t)),this.getMessageCorrespondents().length&&this.recipients(t),t.compact&&this.folder(t),t.compact&&this.date(t),(u&&!t["preview-mode"]||m)&&t.compact&&this.ampIcon(t)),r().createElement("div",{"data-qa-id":(0,St.qa)("controls"),className:qn.elem("controls")},this.statusFlag(t),this.isDarkModePossible()&&this.darkModeToggle(t),!D.DISABLE_HEAD_PRINT&&this.showPrintButton(t),D.ENABLE_TAGS&&this.addTag(t),this.more(t)))),r().createElement("div",{className:qn.elem("before-letter-body")},D.ENABLE_TAGS&&r().createElement(_n,{model:n,tags:n.get("flags.tags")}),p&&r().createElement("div",{className:qn.elem("letter-meta-container",{phishing:f})},r().createElement(I.Z,{type:p,model:n,useMediators:["letters-actions"],remitEvents:{"attaches-cloud-save":"attaches:cloud:all"},updateRemitEventsName:!0,broadcastEvent:(0,xt.Yv)(this),component:Jt.Z,key:"letter-meta"})),this.isEnableConfirmationReceipt()&&r().createElement("div",{className:qn.elem("confirm-receipt")},r().createElement(I.Z,{id:"confirm-receipt",model:n,remitEvents:{confirm:"confirmreceipt"},broadcastEvent:(0,xt.Yv)(this),component:Xt.Z,key:"letter-confirm-receipt"})),this.isTranslatorVisible()&&r().createElement("div",{className:qn.elem("translator")},r().createElement(I.Z,{id:"translator",error:t["is-translator-error"],"from-default-selected":t["translator-default-from"],loading:t["is-translator-loading"],ponymode:d,compact:t.compactTranslator,"to-default-selected":t["translator-default-to"],translated:this.isLetterTranslated(),remitEvents:{close:"translator:close:click",original:"translator:original:click",retry:"translator:retry:click",translate:"translator:translate:click"},broadcastEvent:(0,xt.Yv)(this),component:tn.Z,key:"translator"}))),!this.isTranslatorVisible()&&this.isTooltipVisible()&&r().createElement("div",{className:qn.elem("tooltip")},!!this.isImagesHiddenTooltipVisible()&&r().createElement(I.Z,{type:"images-hidden-tooltip",ponymode:d,"title-text":i18n("Мы скрыли изображения в письме, чтобы защитить аккаунт"),"action-text":i18n("Показать изображения"),remitEvents:{action:"letter-tooltip:show-images:click",close:"letter-tooltip:close"},broadcastEvent:(0,xt.Yv)(this),component:en.Z,key:"letter-tooltip"})),!!o&&r().createElement("div",{className:qn.elem("attach-list",{react:!0})},r().createElement(I.Z,{"letter-length":t.model.get("body.text").length,models:t.model.get("attaches.list"),"total-size":t.model.getAttachmentsTotalSize(),"download-link":this.getAttachmentsDowloadLink(),"preview-mode":t["preview-mode"],useMediators:["layout-manager"],"dark-mode":this.isDarkModePossible(),remitEvents:{"attach-list-expanded":"attaches:expanded","attach-list-collapsed":"attaches:collapsed","attach-list-cloud":"attaches:cloud:all","thumb-open":"attaches:open","thumb-cloud":"attaches:cloud:one","force-recalc":"letter-force-recalc"},updateRemitEventsName:!0,broadcastEvent:(0,xt.Yv)(this),component:qt.Z,key:"attach-list"})),r().createElement("div",{"data-qa-id":(0,St.qa)("body"),className:qn.elem("body",{react:!0})},!(t["address-header-calendar"]&&n.getJsonLdEvent()||t["smart-card-ics"]&&(0,Zt.getCalendarIcsEvent)(n))&&r().createElement(I.Z,{key:"letter-calendar","dark-mode":this.isDarkMode(),calendars:n.getCalendarFromAttach(),component:Gt.Z}),u&&!t["preview-mode"]?r().createElement(I.Z,{ref:this.letterBody,model:n,remitEvents:{error:"amp:error","force-recalc":"letter-force-recalc"},updateRemitEventsName:!0,broadcastEvent:(0,xt.Yv)(this),component:zt.Z,key:"letter-body-amp"}):r().createElement(hn,{ref:this.letterBody,key:"letter-body",id:this.getLetterBodyKey(),bodyHtml:this.getLetterBody(),"collapsed-default":t["quotes-collapsed-default"],ponymode:d,"dark-mode":this.isDarkMode(),message:n,"preview-mode":t["preview-mode"],useMediators:["layout-manager","features","flags"],remitEvents:{resize:"resize",blockquote:"blockquote",allowedattrclick:"letter:body:allowedattrclick","data-attr-click":"letter:body:data-attr:click","force-recalc":"letter-force-recalc",finepayment:"letter:body:finepayment",finepaymentright:"letter:body:finepaymentright",monetapayment:"letter:body:monetapayment",tomyselfclick:"letter:body:tomyself"},updateRemitEventsName:!0,broadcastEvent:(0,xt.Yv)(this)})),!t.readonly&&this.isShowFooter()&&r().createElement("div",{"data-qa-id":(0,St.qa)("footer"),className:qn.elem("footer",{react:!0,sticky:t["sticky-footer"],"new-toolbar":D.NEW_TOOLBAR,"sticky-fade":t["sticky-footer-fade"]})},r().createElement("div",{className:qn.elem("footer-background",{react:!0})},r().createElement("div",{className:qn.elem("footer-buttons")},r().createElement("div",{className:qn.elem("footer-left")},l&&r().createElement("div",{className:qn.elem("footer-button")},s?r().createElement("div",{className:qn.elem("button-dropdown")},r().createElement(a.Dropdown,{placement:"topLeft",pureOverlay:!0,overlay:this.itemsReplyAll(t)},r().createElement(I.Z,{"radar-id":"replyall",text:i18n("Ответить всем"),ico:"reply-all",base:!0,pure:!0,touch:t.touch,disabled:!this.isEnableReply(),shortcut:"shift+r","title-shortcut":"Shift+R",component:Vt.Z}))):r().createElement(I.Z,{"radar-id":"replyall",text:i18n("Ответить всем"),ico:"reply-all",base:!0,pure:!0,touch:t.touch,model:t.model,disabled:!this.isEnableReply(),remitEvents:{click:"compose:replyall"},remitDetails:t.model,broadcastEvent:(0,xt.Yv)(this),shortcut:"shift+r","title-shortcut":"Shift+R",component:Vt.Z,key:"button2"})),r().createElement("div",{className:qn.elem("footer-button")},i?r().createElement("div",{className:qn.elem("button-dropdown")},r().createElement(a.Dropdown,{placement:"topLeft",pureOverlay:!0,overlay:this.itemsReply(t)},r().createElement(I.Z,{"radar-id":"reply",text:i18n("Ответить"),ico:"reply",base:!0,pure:!0,touch:t.touch,disabled:!this.isEnableReply(),short:h,shortcut:"r","title-shortcut":"R",component:Vt.Z}))):r().createElement(I.Z,{"radar-id":"reply",text:i18n("Ответить"),ico:"reply",base:!0,pure:!0,touch:t.touch,model:t.model,disabled:!this.isEnableReply(),short:h,remitEvents:{click:"compose:reply"},remitDetails:t.model,broadcastEvent:(0,xt.Yv)(this),shortcut:"r","title-shortcut":"R",component:Vt.Z,key:"button2"})),r().createElement("div",{className:qn.elem("footer-button")},c?r().createElement("div",{className:qn.elem("button-dropdown")},r().createElement(a.Dropdown,{placement:"topLeft",pureOverlay:!0,overlay:this.itemsForward(t)},r().createElement(I.Z,{"radar-id":"forward",text:i18n("Переслать"),ico:"forward",base:!0,pure:!0,touch:t.touch,disabled:!this.isEnableForward(),shortcut:"F","title-shortcut":"F",remitDetails:t.model,component:Vt.Z}))):r().createElement(I.Z,{"radar-id":"forward",text:i18n("Переслать"),ico:"forward",base:!0,pure:!0,touch:t.touch,model:t.model,disabled:!this.isEnableForward(),remitEvents:{click:"compose:forward"},remitDetails:t.model,broadcastEvent:(0,xt.Yv)(this),shortcut:"F","title-shortcut":"F",component:Vt.Z,key:"button2"}))),r().createElement("div",{className:qn.elem("footer-right")},!(this._showUnsubscribeButton()||this.isDatesMetadataEnabled())&&r().createElement(r().Fragment,null,t["invite-call"]&&!t["disable-call"]&&!t["disable-footer-call"]&&this.canCallTo(t.model)&&r().createElement("div",{"data-qa-id":(0,St.qa)("calls-dropdown"),className:qn.elem("footer-button",{},{addClass:[(0,rn.d)("footer-calls-dropdown")]})},r().createElement("div",{className:qn.elem("button-dropdown")},r().createElement(a.Dropdown,{placement:"topRight",pureOverlay:!0,overlay:this.itemsInviteCall(t)},r().createElement(I.Z,{"disable-expand-center":!0,"expand-left":!0,ico:"categories:camera",text:i18n("Позвонить"),title:i18n("Позвонить"),annotation:!t["disable-calls-tip"]&&i18n("Отправьте ссылку на звонок или позвоните сейчас — если ваши собеседники онлайн, они увидят вызов"),ponymode:t["pony-mode"],pure:!0,short:t["sticky-reduce-all-texts"],"radar-id":"footer-call-dropdown",disabled:!this.isEnableCall(),remitEvents:{"dropdown-change-state":"dropdown-change"},updateRemitEventsName:!0,broadcastEvent:(0,xt.Yv)(this),component:Vt.Z})))),t["invite-call"]&&!t["disable-call"]&&!t["disable-footer-call"]&&!this.canCallTo(t.model)&&r().createElement("div",{className:qn.elem("footer-button",{},{addClass:[(0,rn.d)("footer-calls-button")]})},r().createElement(I.Z,{className:qn.elem("calls-invite-button"),"data-qa-id":(0,St.qa)("calls:invite"),"radar-id":"footer-call",text:!t["sticky-reduce-all-texts"]&&i18n("Позвонить"),title:i18n("Позвонить"),annotation:!t["disable-calls-tip"]&&i18n("Участники встречи получат ссылку для видеозвонка и присоединятся, когда перейдут по ней"),ico:"categories:camera",base:!0,pure:!0,touch:t.touch,model:t.model,disabled:!this.isEnableCall(),remitEvents:{click:"calls:invite"},remitDetails:t.model,broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,key:"button2"})),!t["disable-create-event"]&&!t["disable-footer-calendar"]&&r().createElement("div",{className:qn.elem("footer-button")},r().createElement(I.Z,{model:t.model,"sticky-reduce-one-text":t["sticky-reduce-one-text"],useMediators:["calendar-manager"],component:Wt.Z,key:"calendar-button"}))),!!this._showVkMessengerButton()&&r().createElement("div",{className:qn.elem("vk-chat-button",{},{addClass:[(0,rn.d)("toolbar-vk-chat")]})},r().createElement(I.Z,{"data-qa-id":(0,St.qa)("vk-messenger:open"),"radar-id":"footer-vk",text:!t["sticky-reduce-one-text"]&&this._getVkMessengerParams().text,title:this._getVkMessengerParams().text,ico:"social:vk",base:!0,pure:!0,touch:t.touch,model:t.model,centered:t["sticky-reduce-one-text"],remitEvents:{click:"vk-messenger:open"},remitDetails:this._getVkMessengerParams().href,broadcastEvent:(0,xt.Yv)(this),component:Vt.Z,key:"button2"})),!(!this._showUnsubscribeButton()||this.isDatesMetadataEnabled())&&this.unsubscribe(t),!!this.isDatesMetadataEnabled()&&!t["disable-create-event"]&&!t["disable-footer-calendar"]&&r().createElement("div",{className:qn.elem("footer-button")},r().createElement(I.Z,{model:t.model,"dates-metadata":t["dates-metadata"],"sticky-reduce-one-text":t["sticky-reduce-one-text"],useMediators:["calendar-manager"],component:Wt.Z,key:"calendar-button"})))),(v||y)&&this.isShowSmartReplyAndMarusia()&&r().createElement("div",{className:qn.elem("footer-controls")},(E||v)&&r().createElement("span",{className:qn.elem("marusia-rl",{},{addClass:[(t.smart_replies_ready||v)&&"ready"]})},r().createElement(An,{model:t.model,useMediators:["marusia-manager"],"radar-prefix":g})),!!y&&t.smart_replies.map((function(n,a){return r().createElement("span",{key:a,className:qn.elem("smart-reply",{},{addClass:[t.smart_replies_ready&&"ready"]})},r().createElement(I.Z,{text:n,compact:!0,shadowless:!0,invert:!0,"radar-id":"smart-reply{message.is('flags.smart_reply_stage') ? '_stage' : ''}",remitEvents:{click:"compose:smartreply"},remitDetails:{model:t.model,key:a},broadcastEvent:(0,xt.Yv)(e),component:Vt.Z,key:"button2"}))}))))))}!function(e){e.mount="$mount",e.unmount="$destroyed",e.composeReply="compose:reply",e.composeReplyAll="compose:replyall",e.composeForward="compose:forward",e.composeSmartReply="compose:smartreply",e.toggleStatusUnread="togglestatus:unread",e.toggleStatusFlagged="togglestatus:flagged"}(Hn||(Hn={}));var ca=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),da=function(){return(da=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},ua=function(e,t,n){if(n||2===arguments.length)for(var a,o=0,r=t.length;o<r;o++)if(a||!(o in t)){if(!a)a=Array.prototype.slice.call(t,0,o);a[o]=t[o]}return e.concat(a||Array.prototype.slice.call(t))}([],Object.values(Pt.blockSpec.events),!0),ma=function(e){function t(t){var n=e.call(this,t)||this;return n.ampIcon=jn,n.calendarCreate=Qn,n.avatarWrap=Jn,n.correspondents=Vn,n.darkModeToggle=zn,n.date=ea,n.folder=$n,n.inviteCall=Kn,n.itemsForward=la,n.itemsInviteCall=ia,n.itemsReply=ra,n.itemsReplyAll=oa,n.more=na,n.recipients=ta,n.statusFlag=Gn,n.statusUnread=Wn,n.unsubscribe=aa,n.showPrintButton=Xn,n.addTag=Yn,n.reactComponent=!0,n.performanceTrace=Pt.blockSpec.performanceTrace,n.isolateEvents=Pt.blockSpec.isolateEvents,n.mods=Pt.blockSpec.mods,n.events=Pt.blockSpec.events,n.isFooterHiddenRadarSended=!1,n.isSmartReplyHiddenRadarSended=!1,n.radar=pt.ZP,n.onAttachmentsCloud=Pt.blockSpec.onAttachmentsCloud,n.onAttachmentCloud=Pt.blockSpec.onAttachmentCloud,n.onAttachmentClick=Pt.blockSpec.onAttachmentClick,n.onContactShow=Pt.blockSpec.onContactShow,n.onToggleDetails=Pt.blockSpec.onToggleDetails,n.onAllowedAttrClick=Pt.blockSpec.onAllowedAttrClick,n.onLetterDataAttributeClick=Pt.blockSpec.onLetterDataAttributeClick,n.onFinePaymentClick=Pt.blockSpec.onFinePaymentClick,n.onFinePaymentRightClick=Pt.blockSpec.onFinePaymentRightClick,n.onMonetaPaymentClick=Pt.blockSpec.onMonetaPaymentClick,n.onToMyselfClick=Pt.blockSpec.onToMyselfClick,n.onLetterComposeFromDraft=Pt.blockSpec.onLetterComposeFromDraft,n.onTranslatorClose=Pt.blockSpec.onTranslatorClose,n.onTranslatorHide=Pt.blockSpec.onTranslatorHide,n.onTranslatorOriginal=Pt.blockSpec.onTranslatorOriginal,n.onTranslatorTranslate=Pt.blockSpec.onTranslatorTranslate,n.onTooltipShowImagesClick=Pt.blockSpec.onTooltipShowImagesClick,n.onTooltipClose=Pt.blockSpec.onTooltipClose,n.onAmpError=Pt.blockSpec.onAmpError,n.onDarkModeToggle=Pt.blockSpec.onDarkModeToggle,n.onCallTo=Pt.blockSpec.onCallTo,n.onVkMessengerOpen=Pt.blockSpec.onVkMessengerOpen,n.formFinePaymentUrl=Pt.blockSpec.formFinePaymentUrl,n.isLetterTranslated=Pt.blockSpec.isLetterTranslated,n.isTranslationLoading=Pt.blockSpec.isTranslationLoading,n.isTranslatorVisible=Pt.blockSpec.isTranslatorVisible,n.isTooltipVisible=Pt.blockSpec.isTooltipVisible,n.isImagesHiddenTooltipVisible=Pt.blockSpec.isImagesHiddenTooltipVisible,n.getAttachmentsDowloadLink=Pt.blockSpec.getAttachmentsDowloadLink,n.getOriginalEvent=Pt.blockSpec.getOriginalEvent,n.getLetterBody=Pt.blockSpec.getLetterBody,n.getLetterBodyKey=Pt.blockSpec.getLetterBodyKey,n.getLetterBodyTranslation=Pt.blockSpec.getLetterBodyTranslation,n.getMessageCorrespondents=Pt.blockSpec.getMessageCorrespondents,n.isLetterIdEq=Pt.blockSpec.isLetterIdEq,n.canCallTo=Pt.blockSpec.canCallTo,n.updateSticky=Pt.blockSpec.updateSticky,n.updateStickyStatus=Pt.blockSpec.updateStickyStatus,n.updateOnlineStatus=Pt.blockSpec.updateOnlineStatus,n.updateSenderLastSeen=Pt.blockSpec.updateSenderLastSeen,n.updateLastSeenUnsubscribe=Pt.blockSpec.updateLastSeenUnsubscribe,n._showFilterButton=Pt.blockSpec._showFilterButton,n._showSpam=Pt.blockSpec._showSpam,n._startStickyTracking=Pt.blockSpec._startStickyTracking,n._stopStickyTracking=Pt.blockSpec._stopStickyTracking,n._showDropdownCallButton=Pt.blockSpec._showDropdownCallButton,n._showHeadCallButton=Pt.blockSpec._showHeadCallButton,n._showDropdownCalendarButton=Pt.blockSpec._showDropdownCalendarButton,n._showHeadCalendarButton=Pt.blockSpec._showHeadCalendarButton,n._showUnsubscribeButton=Pt.blockSpec._showUnsubscribeButton,n._showUnsubscribeInMoreMenu=Pt.blockSpec._showUnsubscribeInMoreMenu,n._showVkMessengerButton=Pt.blockSpec._showVkMessengerButton,n._getVkMessengerParams=Pt.blockSpec._getVkMessengerParams,n._sendVkMessengerEvent=Pt.blockSpec._sendVkMessengerEvent,n._windowResizeListeners=Pt.blockSpec._windowResizeListeners,n.hasReplyAll=Pt.blockSpec.hasReplyAll,n.isAMPLetter=Pt.blockSpec.isAMPLetter,n.isAMPLetterWithoutTheme=Pt.blockSpec.isAMPLetterWithoutTheme,n.setCssSelectorThemeAMP=Pt.blockSpec.setCssSelectorThemeAMP,n.isDarkMode=Pt.blockSpec.isDarkMode,n.isDarkModePossible=Pt.blockSpec.isDarkModePossible,n.isProbablyPhishing=Pt.blockSpec.isProbablyPhishing,n.checkFolderGrant=Pt.blockSpec.checkFolderGrant,n.isEnableReply=Pt.blockSpec.isEnableReply,n.isEnableCall=Pt.blockSpec.isEnableCall,n.isEnableForward=Pt.blockSpec.isEnableForward,n.isEnableMark=Pt.blockSpec.isEnableMark,n.isEnableAttach=Pt.blockSpec.isEnableAttach,n.isDatesMetadataEnabled=Pt.blockSpec.isDatesMetadataEnabled,n.isEnableConfirmationReceipt=Pt.blockSpec.isEnableConfirmationReceipt,n.isSmartRepliesAvailable=Pt.blockSpec.isSmartRepliesAvailable,n.isMarusiaReadLetterEnabled=Pt.blockSpec.isMarusiaReadLetterEnabled,n.getMarusiaReadLetterRadarPrefix=Pt.blockSpec.getMarusiaReadLetterRadarPrefix,n.hasCloudStockAttach=Pt.blockSpec.hasCloudStockAttach,n.getLetterMetaHeaderType=Pt.blockSpec.getLetterMetaHeaderType,n.isShowSmartReplyAndMarusia=Pt.blockSpec.isShowSmartReplyAndMarusia,n.isShowFooter=Pt.blockSpec.isShowFooter,n.isShowFakeCreateTodo=Pt.blockSpec.isShowFakeCreateTodo,n.useNewToolbar=Pt.blockSpec.useNewToolbar,n.getAttachSafetyStatus=Pt.blockSpec.getAttachSafetyStatus,n.isAllExtensionsInWhiteList=Pt.blockSpec.isAllExtensionsInWhiteList,n.isEveryStrictlyUnsafe=Pt.blockSpec.isEveryStrictlyUnsafe,n.isAllScanResolutionsOf=Pt.blockSpec.isAllScanResolutionsOf,n.isAllTypesOf=Pt.blockSpec.isAllTypesOf,n.hasSmartCardIcsMeta=Pt.blockSpec.hasSmartCardIcsMeta,n.attrs=da(da({},n.props),n.state),n.render=sa,n.letterRef=r().createRef(),n.letterBody=r().createRef(),n.checkIfShouldEnableDarkMode(),ua.forEach((function(e){n[e]=n[e].bind(n)})),n}return ca(t,e),Object.defineProperty(t.prototype,"el",{get:function(){return this.letterRef.current},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){Pt.blockSpec.didMount.bind(this)(),this.updateModel(da(da({},this.props),this.state)),this.updateStickyAttrs(da(da({},this.props),this.state),{}),this.updateStickyPositionAttrs(da(da({},this.props),this.state)),this.updateDatasetMetadataAttrs(da(da({},this.props),this.state))},t.prototype.componentDidUpdate=function(e,t){var n=da(da({},this.props),this.state),a=da(da({},e),t);if(n.model!==a.model)this.updateModel(n);if(n.sticky!==a.sticky)this.updateStickyAttrs(n,a);if(n["sticky-position"]!==a["sticky-position"])this.updateStickyPositionAttrs(n);if(n["dates-metadata"]!==a["dates-metadata"])this.updateDatasetMetadataAttrs(n)},t.prototype.componentWillUnmount=function(){Pt.blockSpec.didUnmount.bind(this)()},t.prototype.handleInnerEvent=function(e){var t=e.type;switch(t){case Hn.mount:return void(0,pt.ZP)(["thread_letter","mount"],1,(0,Ht.tA)(this));case Hn.unmount:return void(0,pt.ZP)(["thread_letter","unmount"],1,(0,Ht.tA)(this));case Hn.toggleStatusUnread:return void(0,pt.ZP)(["thread_letter",(0,Ht.aS)(this,"unread")]);case Hn.toggleStatusFlagged:return void(0,pt.ZP)(["thread_letter",(0,Ht.aS)(this,"flagged")]);case Hn.composeReply:case Hn.composeReplyAll:case Hn.composeForward:case Hn.composeSmartReply:(0,pt.ZP)(["thread_letter",t],1,(0,Ht.tA)(this))}},t.prototype.checkIfShouldEnableDarkMode=function(){if(this.get("model").getCalendarFromAttach().length)this.setState({"dark-mode-enabled":!1})},t.prototype.get=function(e){return da(da({},this.props),this.state)[e]},t.prototype.updateModel=function(e){var t=this,n=e.model;if(window.setTimeout((function(){var e=n.get("attaches").list;(0,pt.ZP)("letter_attaches",e.length);try{(0,Bt.Rc)(e)}catch(e){}}),500),this.isSmartRepliesAvailable(n)){this.setState({smart_replies_ready:!!n.getSmartReply()});var a=n.is("flags.smart_reply_stage")?"_stage":"";(0,pt.ZP)("smart_replies"+a+"_try-show"),n.fetchSmartReply().then((function(e){if(t.setState({smart_replies:e.get("replies")}),(0,pt.ZP)("smart_replies"+a+"_show"),e.is("is_default"))(0,pt.ZP)("smart_replies_default"+a+"_show");It.default.update()}),(function(){(0,pt.ZP)("smart_replies"+a+"_show-fail")}))}},t.prototype.updateStickyAttrs=function(e,t){var n=e.sticky||{},a=t.sticky||{};if(a.head!==n.head)this.updateSticky("head",n.top,n.headFade,!!n.maxWidth);if(a.footer!==n.footer)this.updateSticky("footer",n.bottom,n.footerFade,!!n.maxWidth)},t.prototype.updateStickyPositionAttrs=function(e){var t=e["sticky-position"],n=e.sticky;if(n)this.updateSticky("head",n.top,!1,!!t.maxWidth),this.updateSticky("footer",n.bottom,!1,!!t.maxWidth)},t.prototype.updateDatasetMetadataAttrs=function(e){var t=e["dates-metadata"];e.model.set("dates_metadata.priority_date",t)},t}(r().Component),pa=(0,xt.v$)("letter",ma,{syncMediatorsOnRender:!1});pa.defaultProps=Pt.blockSpec.defaults;var fa=pa,ha=n(34958),Ea="_2bU-4861SLM6KzZeT9w7Le",va="FClTaZ32w6rW2cRN9mlR5",ga="jg3HafoGPtODOJmBVxXx4",ya="_1xNRxLigVanrEcuqOjbGCY",ba="_1Kh8Jyr2zWkZOjXpRNlJ3P",_a="aPIXZRdAwdr5Op9C00D-D",Ta="_2NzA62gdKyyjboI7YXqOD0",ka="P0SlSCWwjvmid_61j5bvz",Ca="_2Z8MjNFe2bbXM_8oNEkfNY",Sa="_3Un83sJ9BmboNFib8JFCqm",Oa="_3uUr9nxSskaU2eu7woDRQJ",Ma=function(e){var t,n,a=e.darkMode,o=e.round,l=e.noAnimation,i=c()(_a,((t={})[Sa]=o,t[Oa]=o&&a,t[ka]=a,t)),s=c()(Ta,((n={})[Ca]=a,n));return r().createElement("div",{style:e,className:i},!l&&r().createElement("div",{className:s}))},wa=function(e){var t,n,l=e.darkMode,i=e.animateContent,s=e.onMount;(0,o.useEffect)((function(){null==s||s()}),[s]);var d=c()(Ea,((t={})[va]=l,t)),u=c()(((n={})[ga]=i,n));return r().createElement(a.Responsive,{mode:"desktopS"},r().createElement("div",{className:d,"data-test-id":"letter-meta-skeleton"},r().createElement("div",{className:u},r().createElement("div",{className:ya},r().createElement(Ma,{darkMode:l,height:32,width:32,round:!0,noAnimation:!0}),r().createElement(Ma,{darkMode:l,height:28,width:341})),r().createElement("div",{className:c()(ya,ba)},r().createElement(Ma,{darkMode:l,height:20,width:244})),r().createElement("div",{className:c()(ya,ba)},r().createElement(Ma,{darkMode:l,height:20,width:205})),r().createElement("div",{className:c()(ya,ba)},r().createElement(Ma,{darkMode:l,height:20,width:244})))))},Aa=n(24880),Ra=n(1229),Na=n(36),Ua=n(65390),Da=n(62313),Ba=n(71147),Ia=n(35760),Pa=function(e){var t;return r().createElement(a.Icon,{icon:te._i[null!==(t=null==e?void 0:e.emptyStateType)&&void 0!==t?t:ee.OX.EMPTY_FOLDER]})},xa={title:i18n("Вы уверены, что хотите {br}отменить загрузку файла?",{"unsafe-br":"<br/>"}),textCompose:i18n("Загрузка файла отменится и вы не сможете отправить его по почте."),textDnd:i18n("Загрузка файла отменится и вы не сможете сохранить его в Облако."),button:i18n("Загрузить с Облаком"),closeButton:i18n("Отменить загрузку")},Ha=function(e){var t=(0,o.useState)(!0),n=t[0],l=t[1],i=function(){e.onClose(),l(!1)},s=function(){e.onSubmit(),l(!1)},c=(D.LAYER_IFRAME_PARAMS.cloud_tariff||{}).width,u=void 0===c?491:c,m=e.from,p=null;if("dnd"===m)p=xa.textDnd;if("compose"===m)p=xa.textCompose;return r().createElement(a.Popup,{show:n,onHide:i,width:"".concat(u,"px"),testId:"oversize-attach-cancel-popup",closeByEsc:!1},r().createElement(a.Panel,{popup:!0,onClose:i,header:r().createElement(a.Text,{mode:"h1"},r().createElement("span",{dangerouslySetInnerHTML:{__html:xa.title}})),content:r().createElement(r().Fragment,null,r().createElement(a.Margin,{desktopX:1,mobileX:1}),r().createElement(a.Text,null,p)),controls:r().createElement(d.Z,null,(function(e){var t=e.Button;return r().createElement(r().Fragment,null,r().createElement(t,{size:"l",onClick:s,"data-test-id":"submit-button"},xa.button),r().createElement(a.Space,null),r().createElement(t,{size:"l",mode:"secondary",appearance:"neutral",onClick:i,"data-test-id":"close-button"},xa.closeButton))}))}))},La=function(e){var t=e.colorIconSecondary,n=e.colorBackgroundAccentAlternative;return{base:{display:"inline-block","& svg":{width:"16px",height:"16px",fill:t.normal.value}},disabled:{pointerEvents:"none"},container:{whiteSpace:"nowrap"},selected:{"& svg":{fill:n.normal.value}},ico:{cursor:"pointer","& svg":{width:20,height:20}}}},Fa=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Za=function(e,t,n,a){var o,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)if(o=e[i])l=(r<3?o(l):r>3?o(t,n,l):o(t,n))||l;return r>3&&l&&Object.defineProperty(t,n,l),l},qa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){e.preventDefault()},t}return Fa(t,e),t.prototype.render=function(){var e=this.props,t=e.icon,n=e.text,o=e.classes,l=e.selected,i=e.onClick,s=e.disabled;return r().createElement("div",{className:c()(o.base,l&&o.selected)},r().createElement(a.Tooltip,{placement:"top",overlay:r().createElement("div",{className:o.container},r().createElement(a.Text,null,n))},r().createElement("div",{className:c()(o.ico,s&&o.disabled),onClick:i,onMouseDown:this.onMouseDown},r().createElement(a.Icon,{icon:t}))))},t=Za([(0,a.withStyles)(La)],t)}(r().PureComponent),ja=function(){return{base:{}}},Va=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Wa=function(e,t,n,a){var o,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)if(o=e[i])l=(r<3?o(l):r>3?o(t,n,l):o(t,n))||l;return r>3&&l&&Object.defineProperty(t,n,l),l},Ya=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Va(t,e),t.prototype.render=function(){var e=this.props,t=e.selected,n=e.onClick,a=e.disabled;return r().createElement(qa,{icon:g.STATUS_WARNING_ROUND,text:i18n("Важное"),selected:t,onClick:n,disabled:a})},t=Wa([(0,a.withStyles)(ja)],t)}(r().PureComponent),za="_3Ryo8YfRYbW1DDQPAQGRzX",Ga="_3B87h5P5qaEzs4B-2LUf93",Ka="_1Sisr-tGB-UGZRVggYsBzB",Xa=function(){return(Xa=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},Qa=(0,Fe.Qe)(D.PROMT_ABOUT_AD_RAW)?D.PROMT_ABOUT_AD_RAW:D.PROMT_ABOUT_AD_DEFAULT,Ja=function(e){var t,n=e.children;return r().createElement("div",{className:za},n,r().createElement("span",{className:Ga},"•"),r().createElement("div",{className:Ka},D.TRANSLATE_ABOUT_AD?i18n("реклама"):"реклама"),r().createElement(Je,{adDescription:Xa((t={},t[Fe.Jo.Subject]=D.PROMT_LOGO_HREF,t),Qa),placement:"topRight",reservePlacement:"bottomRight"}))},$a="_3md5s6vZdEy2J2jPt9bmli",eo="_2S5z2vgnamhQiI_bV20p_p",to=function(){return(to=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},no=(0,Fe.Qe)(D.PROMT_ABOUT_AD_RAW)?D.PROMT_ABOUT_AD_RAW:D.PROMT_ABOUT_AD_DEFAULT,ao=function(e){var t,n=r().useRef(),o=r().useCallback((function(e){e.preventDefault()}),[]),l=D.PROMT_LOGO_WITH_AD_DROPDOWN?"div":r().Fragment;return r().createElement(l,to({},D.PROMT_LOGO_WITH_AD_DROPDOWN&&"div"===l&&{ref:n,className:$a}),r().createElement(a.Tooltip,{testId:"promt-tooltip",delayBeforeAnimation:2e3,arrow:!0,arrowMode:"soft",placement:D.PROMT_LOGO_WITH_AD_DROPDOWN?"topRight":"top",overlay:r().createElement("div",{className:"promt_tooltip_content"},i18n("Переведено с помощью"),r().createElement("div",{className:"icon"},r().createElement(a.Icon,{icon:g.STATIC_PROMT_WITH_LOGO}))),overlayContainer:document.querySelector('[data-container-id="tooltip-container"]'),paddingsMode:"none"},r().createElement("a",{href:D.PROMT_LOGO_HREF,target:"_blank",rel:"noreferrer",className:"tooltip_icon"},D.PROMT_LOGO_WITH_AD_DROPDOWN?r().createElement(r().Fragment,null,r().createElement("div",{className:eo},r().createElement(a.Icon,{icon:g.STATIC_PROMT}),r().createElement("div",null,D.TRANSLATE_ABOUT_AD?i18n("реклама"):"реклама")),r().createElement(Je,{adDescription:to((t={},t[Fe.Jo.Subject]=D.PROMT_LOGO_HREF,t),no),mode:"vertical",overlayContainer:n.current,onClick:o,placement:"bottomRight",reservePlacement:"topRight"})):r().createElement(a.Icon,{icon:g.STATIC_PROMT}))))},oo=function(){return{base:{"& svg":{width:"20px",height:"20px"}}}},ro=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),lo=function(e,t,n,a){var o,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)if(o=e[i])l=(r<3?o(l):r>3?o(t,n,l):o(t,n))||l;return r>3&&l&&Object.defineProperty(t,n,l),l},io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ro(t,e),t.prototype.render=function(){var e=this.props,t=e.classes,n=e.selected,a=e.onClick,o=e.disabled;return r().createElement("div",{className:t.base},r().createElement(qa,{icon:g.WYSIWYG_MAIL_READ,text:i18n("С уведомлением"),selected:n,onClick:a,disabled:o}))},t=lo([(0,a.withStyles)(oo)],t)}(r().PureComponent),so=function(e){var t=e.colorIconSecondary,n=e.colorBackgroundAccentAlternative,a=e.colorBackgroundSecondary,o=e.colorTextPrimary;return{base:{display:"inline-block","& svg":{width:"20px",height:"20px",fill:t.normal.value}},container:{padding:"4px",whiteSpace:"nowrap",display:"flex",flexDirection:"column",alignItems:"center"},selected:{"& svg":{fill:n.normal.value}},ico:{cursor:"pointer"},disabled:{pointerEvents:"none"},items:{paddingTop:"4px"},item:{"&:hover":{backgroundColor:a.hover.value},"& a":{color:o.normal.value},"& a:hover":{color:o.normal.value},cursor:"pointer",borderRadius:"2px",padding:"2px 10px",display:"inline-block"},itemSelecteded:{backgroundColor:a.active.value,fontWeight:"bold","& a":{textDecoration:"none"},"&:hover":{backgroundColor:a.active.value}}}},co=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),uo=function(e,t,n,a){var o,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)if(o=e[i])l=(r<3?o(l):r>3?o(t,n,l):o(t,n))||l;return r>3&&l&&Object.defineProperty(t,n,l),l},mo=function(e){return i18n.plural(e,[i18n("{count} часов",{count:e}),i18n("{count} час",{count:e}),i18n("{count} часа",{count:e})])},po=function(e){return i18n.plural(e,[i18n("{count} дней",{count:e}),i18n("{count} день",{count:e}),i18n("{count} дня",{count:e})])},fo=[{time:3600,label:mo(1)},{time:7200,label:mo(2)},{time:86400,label:po(1)},{time:172800,label:po(2)},{time:432e3,label:po(5)}],ho=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){e.preventDefault()},t}return co(t,e),t.prototype.getOptions=function(){var e=this,t=this.props,n=t.selected,o=t.timeSelected,l=t.classes,i=t.onChange;return fo.map((function(t,s){return r().createElement("div",{key:s,className:c()(l.item,n&&o===t.time?l.itemSelecteded:""),onClick:i&&i.bind(e,t.time)},r().createElement(a.Link,{secondary:!0},t.label))}))},t.prototype.render=function(){var e=this.props,t=e.classes,n=e.selected,o=e.onClick,l=e.disabled;return r().createElement("div",{className:c()(t.base,n&&t.selected)},r().createElement(a.Tooltip,{delay:2e3,placement:"topRight",overlay:r().createElement("div",{className:t.container},r().createElement("div",null,r().createElement(a.Text,null,i18n("Напомнить, если нет ответа через"))),r().createElement("div",{className:t.items},this.getOptions()))},r().createElement("div",{className:c()(t.ico,l&&t.disabled),onClick:o&&o.bind(this,fo[0].time),onMouseDown:this.onMouseDown},r().createElement(a.Icon,{icon:g.NAVIGATION_NOTIFICATION}))))},t=uo([(0,a.withStyles)(so)],t)}(r().PureComponent),Eo=a.TwoKitTheming.createUseStyles((function(e){var t=e.x1,n=e.colorTextSecondary,a=e.colorTextPrimary;return{base:{color:n.normal.value,wordBreak:"break-all","&:hover":{color:a.normal.value}},dropdown:{},dropdownRow:{"&:not(:last-child)":{paddingBottom:t.value}},noWrap:{whiteSpace:"nowrap"}}})),vo=function(e){return e.map((function(e){var t=e.name,n=e.email;return t?"".concat(n," (").concat(t,")"):n})).join(", ")},go=function(e){var t=e.resendFrom,n=e.resendTo,l=e.resendDate,i=e.receivedDate,s=e.qaEnabled,d=(0,o.useState)(!1),u=d[0],m=d[1],p=Eo(e),f=vo(n),h=vo(t),E=(0,o.useCallback)((function(e){return s?e:void 0}),[s]);(0,o.useEffect)((function(){$().send("resend_show")}),[]);var v=(0,o.useCallback)((function(e){if(e)$().send("resend_open");else if(u)$().send("resend_close");if(e&&f.length>875)$().send("resend_overflow");m(e)}),[f.length,h.length,u]),g=r().createElement("div",{className:p.dropdown,"data-test-id":E("resend-overlay")},r().createElement("div",{className:p.dropdownRow},r().createElement(a.Text,{secondary:!0},i18n("Переадресовано для:"))," ",r().createElement(a.Text,{testId:E("resend-to")},f)),r().createElement("div",{className:p.dropdownRow},r().createElement(a.Text,{secondary:!0},i18n("Переадресовано от:"))," ",r().createElement(a.Text,{testId:E("resend-from")},h)),l&&r().createElement("div",{className:c()(p.dropdownRow,p.noWrap)},r().createElement(a.Text,{secondary:!0},i18n("Письмо получено:"))," ",r().createElement(a.Text,{testId:E("resend-date")},l)),r().createElement("div",{className:c()(p.dropdownRow,p.noWrap)},r().createElement(a.Text,{secondary:!0},i18n("Перенаправлено вам:"))," ",r().createElement(a.Text,{testId:E("received-date")},i)));return r().createElement(a.Dropdown,{placement:"bottomLeft",overlay:g,testId:E("resend-dropdown"),onChangeExpandState:v},r().createElement("div",{className:p.base,"data-test-id":E("resend-dropdown-title")},r().createElement(a.Text,null,i18n("Переадресовано от:"))," ",r().createElement(a.Text,{testId:E("resend-from")},h)))},yo=n(74329),bo=n.n(yo),_o=n(37030),To={sameDay:"[".concat(_o.Gh.today,"]"),nextDay:"[".concat(_o.Gh.tomorrow,"]"),lastDay:"[".concat(_o.Gh.yesterday,"]"),nextWeek:"Do MMMM",lastWeek:"Do MMMM",sameElse:"DD.MM.YYYY"},ko=function(){var e={},t=i18n("в");for(var n in To)e[n]="".concat(To[n]," [").concat(t,"] HH:mm");return e}(),Co=function(e){var t=e.colorIconSecondary,n=e.colorBackgroundAccentAlternative;return{base:{position:"relative",display:"inline-block"},container:{whiteSpace:"nowrap"},disabled:{pointerEvents:"none"},ico:{cursor:"pointer","& > svg":{width:"20px",height:"20px",fill:t.normal.value}},selected:{"& > svg":{fill:n.normal.value}}}},So=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Oo=function(e,t,n,a){var o,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)if(o=e[i])l=(r<3?o(l):r>3?o(t,n,l):o(t,n))||l;return r>3&&l&&Object.defineProperty(t,n,l),l},Mo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){e.preventDefault()},t}return So(t,e),t.prototype.getDateData=function(e,t){var n=[],a=String(e.getHours()),o=String(e.getMinutes()),r=new Date,l=0;if(e.toDateString()===r.toDateString())l=t.getHours();for(var i=l;i<24;i++)n.push({label:(i<10?"0":"")+String(i),value:String(i)});var s=[];for(i=0;i<60;i++)s.push({label:(i<10?"0":"")+String(i),value:String(i)});return{hoursList:n,hoursSelected:a,minutesList:s,minutesSelected:o}},t.prototype.onHourChange=function(e){var t=this.props.onChange;this._currentDate.setHours(+e),t&&t(this._currentDate)},t.prototype.onMinuteChange=function(e){var t=this.props.onChange;this._currentDate.setMinutes(+e),t&&t(this._currentDate)},t.prototype.render=function(){var e=this,t=this.props,n=t.selected,o=t.onClick,l=t.classes,i=t.onChange,s=t.date,d=t.disabled,u=t.datePickerPosition,m=bo()().endOf("hour").add(1).toDate(),p=bo()().add(2,"years").toDate();if(s<m)this._currentDate=m;else this._currentDate=s;var f=this.getDateData(this._currentDate,m),h=f.hoursList,E=f.hoursSelected,v=f.minutesList,y=f.minutesSelected;return r().createElement(a.Responsive,{mode:D.TOUCH_MODE?"auto":"desktopS"},r().createElement("div",{className:c()(l.base,n&&l.selected)},r().createElement(a.Tooltip,{delay:2e3,placement:"topRight",overlay:r().createElement("div",{className:l.container},r().createElement(a.Text,null,"".concat(i18n("Отправить письмо")," ")),r().createElement(a.Dropdown,{placement:u,overlay:function(t){var n=t.closeOverlay;return r().createElement(a.DatePicker,{onChange:function(t){e.setState({date:t}),n(),e._currentDate=t,i&&i(t)},value:e._currentDate,min:m,max:p})}},r().createElement(a.Link,{inherit:!0},bo()(this._currentDate).calendar(null,To))),r().createElement(a.Text,null," ".concat(i18n("в")," ")),r().createElement(a.Select,{link:!0,inline:!0,menuForceTop:!0,value:E,options:h,onChange:this.onHourChange.bind(this),menuMaxHeight:280}),r().createElement(a.Text,null,":"),r().createElement(a.Select,{inline:!0,link:!0,menuForceTop:!0,value:y,options:v,onChange:this.onMinuteChange.bind(this),menuMaxHeight:280}))},r().createElement("div",{className:c()(l.ico,n&&l.selected,d&&l.disabled),onClick:function(){o&&o(e._currentDate)},onMouseDown:this.onMouseDown},r().createElement(a.Icon,{icon:g.STATUS_TIME})))))},t=Oo([(0,a.withStyles)(Co)],t)}(r().PureComponent),wo=n(2678),Ao=n(59333),Ro=n.n(Ao),No=function(e,t){for(;e;e=e.parentElement)if(t?e===t:e.classList.contains("letter-body"))return e;return null},Uo=n(72727),Do=n(90067),Bo=n(18053),Io=n(70325),Po=n(28125),xo=n.n(Po);var Ho,Lo=n(40132),Fo=n.n(Lo),Zo=n(16945),qo=n.n(Zo),jo=n(10476),Vo=n(54908),Wo="_1Fr1e5ip9mIEdMEr5ZIP3-",Yo="_1w7ZSONRVDOszTfoUA93JI",zo="_1d9AbWPfpFuAWIXRuuEvuy";!function(e){e.calendar="calendar",e.note="note"}(Ho||(Ho={}));var Go,Ko,Xo,Qo=function(e){e.preventDefault(),e.stopPropagation()},Jo=(0,o.memo)((function(e){var t=e.setShowContextMenu,n=e.selectedText,o=e.letterModel,l=(0,jo.C)({name:"SelectionContextMenuIntegration",mediators:["calendar-manager"]}),i=(l[0],l[1]),s=function(e){(function(e,t){var n=xo()(),a=(0,Do.O)(n,e,t);return(0,Io.Z)("".concat(D.NOTES_API_URL,"/notes"),JSON.stringify(a),{headers:{"Content-Type":"application/json;charset=utf-8"},method:"POST",oauthFeature:Bo.K.Notes})})(o.get("subject"),e).then((function(e){var t=e.body,n="".concat(D.NOTES_URL,"/notes/").concat(t.uid,"/?source=letter-selection");if("tab"===D.LETTER_BODY_SELECTION_INTEGRATION_NOTES_VARIANT)(0,Uo.default)(n);else Et.default.add({text:i18n("Заметка создана"),actions:[{link:n,text:i18n("Перейти в заметки")}]})})).catch((function(e){Et.default.error({text:i18n("Не удалось перенести в заметки")}),$().send("create-note-from-selection-err",{rlog:"octavius-text-selection-err",rlog_message:e})}))},c=function(e,a){if(e.preventDefault(),e.stopPropagation(),$().send("click_create_read_letter",{dwh:{type:a}}),a===Ho.note)s(n);if(a===Ho.calendar)r=n,i((0,Vo.BU)("calendar:createbyselection",{model:o,createContent:"letter-selection",description:r}));var r;t(!1)};return r().createElement("div",{className:Wo,onMouseDown:Qo,onMouseUp:Qo},r().createElement("div",{className:Yo,onClick:function(e){return c(e,Ho.note)}},r().createElement(a.Icon,{icon:qo()}),r().createElement("span",{className:zo},i18n("Добавить в заметку"))),r().createElement("div",{className:Yo,onClick:function(e){return c(e,Ho.calendar)}},r().createElement(a.Icon,{icon:Fo()}),r().createElement("span",{className:zo},i18n("Создать событие"))))})),$o="_1jwVyP6JIVRktFZUDMBhH9",er="_2pz50sUNzwGONV_saDMBUx",tr="_9YSfGLJNJLqiO7kVUcHjm",nr=function(e){var t=e.letterModel,n=(0,o.useState)(!1),a=n[0],l=n[1],i=(0,o.useState)(0),s=i[0],d=i[1],u=(0,o.useState)(0),m=u[0],p=u[1],f=(0,o.useState)(""),h=f[0],E=f[1],v=(0,o.useState)(!0),g=v[0],y=v[1],b=(0,o.useRef)(null),_=(0,o.useRef)(null),T=(0,o.useRef)(null),k=document.getElementById("portal-overlay"),C=(0,o.useCallback)((function(){var e,t=(null===(e=b.current)||void 0===e?void 0:e.toString())||"";if(t.length&&_.current!==t)if(_.current=t,function(){var e=window.getSelection(),t=No(e.anchorNode.parentElement);return t&&!!No(e.focusNode.parentElement,t)}())if($().send("text_selection",{i:{read_letter:1}}),D.SHOW_LETTER_BODY_SELECTION_INTEGRATION){var n=window.getSelection(),a=n.getRangeAt(n.rangeCount-1).getBoundingClientRect(),o=n.anchorNode,r=n.anchorOffset,i=n.focusNode,s=n.focusOffset,c=o.compareDocumentPosition(i),d=!(!c&&r>s||c===Node.DOCUMENT_POSITION_PRECEDING);y(d),p(d?a.bottom:a.top),E(t),l(!0),$().send("show_menu_create_read_letter")}}),[]),S=(0,o.useCallback)((function(e){d(e.pageX),C()}),[C]),O=(0,o.useCallback)((function(){document.addEventListener("mouseup",S,{once:!0})}),[S]),M=(0,o.useCallback)((function(){if(b.current=window.getSelection(),0===b.current.toString().length)l(!1),_.current=null}),[]),w=(0,o.useCallback)((function(e){if("Shift"===(null==e?void 0:e.key))document.removeEventListener("keyup",w),C()}),[C]),A=(0,o.useCallback)((function(e){if("Shift"===(null==e?void 0:e.key))document.addEventListener("keyup",w)}),[w]),R=(0,o.useCallback)((function(){l(!1)}),[]);(0,o.useEffect)((function(){return document.addEventListener("mousedown",O),document.addEventListener("selectionchange",M),document.addEventListener("keydown",A),function(){document.removeEventListener("mousedown",O),document.removeEventListener("selectionchange",M),document.removeEventListener("keydown",A),document.removeEventListener("mouseup",S)}}),[O,S,M,A]),(0,o.useEffect)((function(){var e;if(a){var t=function(e){for(;e;e=e.parentElement){if("auto"===window.getComputedStyle(e).overflowY)return e}return null}(null===(e=T.current)||void 0===e?void 0:e.parentElement);if(t)return t.addEventListener("scroll",R,{once:!0}),function(){t.removeEventListener("scroll",R)};else return}}),[a]);var N=(0,o.useMemo)((function(){return r().createElement("div",{className:c()($o,g?tr:er),style:{"--x-state":"".concat(s,"px"),"--y-state":"".concat(m,"px")}},r().createElement(Jo,{setShowContextMenu:l,selectedText:h,letterModel:t}))}),[g,t,s,m,h]);return r().createElement(r().Fragment,null,r().createElement("div",{ref:T}),D.SHOW_LETTER_BODY_SELECTION_INTEGRATION&&a&&(0,Ao.createPortal)(N,k))},ar=n(47299),or=n(81726),rr=n(99320),lr=n(51955),ir=n(18199),sr=n.n(ir),cr=n(98957),dr="_1D9hSrDIA9z3kWjTZSYaTB",ur="c7lIeZjcScbF8teC-Ggf_",mr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),pr=function(){return(pr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},fr=function(e){var t,n=null===(t=e.contacts)||void 0===t?void 0:t.length;return n&&i18n.plural(n,[i18n("{count} контактов",{count:n}),i18n("{count} контакт",{count:n}),i18n("{count} контакта",{count:n})])},hr=function(e){return e?(0,lr.checkTextValidity)(e).valid:!1},Er=function(e){function t(t){var n=e.call(this,t)||this;return n.suggests=new rr.Suggests({jssdkMethodContactSuggest:sr(),avatarMapper:function(e){return(0,cr.Z)({email:e.email,name:e.display_name,size:45})},labelSuggestIcon:g.NAVIGATION_USERS,limit:10,onStateChange:function(e){return n.setState(e)},mapLabelOptionToDescription:fr}),n.state=n.suggests.state,n.onSelect=n.onSelect.bind(n),n.onInputChange=n.onInputChange.bind(n),n.onDeselect=n.onDeselect.bind(n),n.onEmailSelect=n.onEmailSelect.bind(n),n.onPaste=n.onPaste.bind(n),n}return mr(t,e),t.prototype.componentDidMount=function(){$().send("l_redirect_form_show")},t.prototype.componentWillUnmount=function(){this.suggests.clearMemCache()},t.prototype.getAddresses=function(){return this.state.selected.map((function(e){return e.email}))},t.prototype.getAddressesCount=function(){return this.suggests.state.selected.length},t.prototype.changeValidity=function(e,t){this.suggests.changeValidity(this.state.selected.find((function(t){return t.email===e})),t)},t.prototype.selectCorrespondentsFromString=function(e){var t=this;if(void 0===e)e=this.state.searchValue;(0,lr.getCorrespondentsFromString)(e).forEach((function(e){var n=(0,lr.checkTextValidity)(e.email),a=n.str,o=n.valid;t.suggests.selectEmail({email:a,isEmailValid:o,name:e.name||a})}))},t.prototype.onInputChange=function(e){var t=(0,lr.checkTextValidity)(e).valid,n=e;if(e.endsWith(" ")&&t)n="",this.selectCorrespondentsFromString(e),$().send("l_redirect_form_email-select");this.suggests.changeSearchValue(n),this.props.onChange()},t.prototype.onSelect=function(e){this.suggests.select(pr(pr({},e),{invalid:!hr(e.email),contacts:e.contacts.map((function(e){return pr(pr({},e),{invalid:!hr(e.email)})}))})),this.props.onChange(),$().send("l_redirect_form_select")},t.prototype.onDeselect=function(e){this.suggests.deselect(e),this.props.onChange(),$().send("l_redirect_form_deselect")},t.prototype.onEmailSelect=function(e){if(0===this.suggests.state.options.length)this.selectCorrespondentsFromString(e),this.props.onChange(),$().send("l_redirect_form_email-select")},t.prototype.onPaste=function(e){e.preventDefault();var t=e.clipboardData.getData("text");this.selectCorrespondentsFromString(t),this.props.onChange(),$().send("l_redirect_form_paste")},t.prototype.render=function(){return r().createElement("div",{"data-test-id":"input-container",className:ur},r().createElement("div",{className:dr},r().createElement(a.FormField,{label:i18n("Кому"),errorMessage:this.props.error,errorMessageTestId:this.props.errorId},r().createElement(a.Hr,{mobileVisible:!0,oversize:!1,mode:this.props.error?"error":"normal"}),r().createElement(a.ContactsAutoComplete,{selected:this.state.selected,options:this.state.options,value:this.state.searchValue,highlightWords:this.state.searchWords,autoFocus:this.props.autoFocus,onChange:this.onInputChange,onPaste:this.onPaste,onDelete:this.onDeselect,onEmailSelect:this.onEmailSelect,onSelect:this.onSelect,dropdownOverlayContainer:document.body,placeholder:0===this.state.selected.length?i18n("Начните вводить имя адресата"):"",testIds:{chipPrefix:"autocomplete-chip-",dropdown:"autocomplete-dropdown",dropdownItemPrefix:"autocomplete-dropdownItem-",input:"autocomplete-input"},hideDropdownOnSelect:!0,checkEmailValidityOnEnter:!1,focusOnInputAfterDelete:!1}),r().createElement(a.Hr,{mobileVisible:!0,oversize:!1,mode:this.props.error?"error":"normal"}))))},t}(r().PureComponent),vr=n(28915),gr="unsubscribe_action",yr="unsubscribe_read_action",br="unsubscribe_remove_action",_r=function(){return(_r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},Tr=function(e){var t=e.x2,n=e.x4,o=e.x5,r=e.x12,l=e.fontFootnote,i=e.fontText;return{base:_r(_r({width:"328px",minWidth:"328px",margin:n.value},(0,a.getValuesStyles)(i.compact)),{whiteSpace:"normal"}),header:{display:"flex",flexDirection:"row",justifyContent:"space-between"},title:{display:"block",marginBottom:n.value},ico:{width:o.value,height:o.value,cursor:"pointer"},radio:{display:"block",margin:"0 ".concat(r.value," ").concat(n.value," 0"),"& > p":_r(_r({},(0,a.getValuesStyles)(l.compact)),{marginLeft:"26px"})},radioGroup:{paddingBottom:t.value},progressWrapper:{display:"flex",flexDirection:"row",alignItems:"center"},progressText:{marginLeft:"7px"}}},kr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Cr=function(){return(Cr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},Sr=function(e,t,n,a){var o,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)if(o=e[i])l=(r<3?o(l):r>3?o(t,n,l):o(t,n))||l;return r>3&&l&&Object.defineProperty(t,n,l),l},Or=[{key:0,action:br,label:i18n("Отписаться и удалить все письма"),footNote:i18n("Это не затронет письма с особыми отметками, например, учётные записи или заказы"),buttonText:i18n("Отписаться и удалить"),checked:!0,testId:"unsub-delete"},{key:1,action:yr,label:i18n("Отписаться и отметить все письма прочитанными"),buttonText:i18n("Отписаться и пометить прочитанными"),testId:"unsub-read"},{key:2,action:gr,label:i18n("Отписаться от адресата"),buttonText:i18n("Отписаться"),testId:"unsub"}],Mr=i18n("Отписываем от рассылки..."),wr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={buttonText:Or[0].buttonText,currentAction:Or[0].action},t.onRadioBtnClick=function(e,n){if(n)t.setState({buttonText:e.buttonText,currentAction:e.action})},t.onSubmit=function(){t.setState({buttonText:Mr},(function(){return t.props.onButtonClick(t.state.currentAction)}))},t.onClose=function(){t.props.onClose()},t}return kr(t,e),t.prototype.getRadioButton=function(e){var t=this,n=this.props,o=n.classes,l=n.inProgress,i=n.qaEnabled;return e.map((function(e){var n=e.key,s=e.label,c=e.footNote,d=e.checked,u=e.testId;return r().createElement("div",Cr({key:n,className:o.radio},i?{"data-test-id":"unsubscribe-radio-".concat(u)}:{}),r().createElement(a.Radio,{label:s,defaultChecked:d,name:"unsubscribeRadioBtn",onChange:t.onRadioBtnClick.bind(t,e),disabled:l}),r().createElement(a.Text,{block:!0,secondary:!0},c))}))},t.prototype.getButtonComponent=function(){var e=this,t=this.state.buttonText,n=this.props,a=n.inProgress,o=n.classes;return r().createElement(d.Z,null,(function(n){var l=n.Button,i=n.Spinner;return r().createElement(l,{type:"submit",onClick:e.onSubmit,disabled:a,size:"l",mode:"secondary",appearance:"neutral"},a?r().createElement("div",{className:o.progressWrapper},r().createElement(i,{size:"small"}),r().createElement("div",{className:o.progressText},t)):t)}))},t.prototype.getTitle=function(){var e=this.props.lettersCount;if(e)return i18n.plural(e,[i18n("У вас {lettersCount} писем от адресата",{lettersCount:e}),i18n("У вас {lettersCount} письмо от адресата",{lettersCount:e}),i18n("У вас {lettersCount} письма от адресата",{lettersCount:e})]);else return i18n("Больше не получать таких писем от")},t.prototype.getSenders=function(){var e=this.props.senderName;if(Array.isArray(e)){return Array.from(new Set(e)).map((function(e){return r().createElement(a.Text,{block:!0,bold:!0,key:e},e)}))}return r().createElement(a.Text,{block:!0,bold:!0},e)},t.prototype.render=function(){var e=this.props,t=e.classes,n=e.qaEnabled;return r().createElement("div",{className:t.base},r().createElement("div",{className:t.header},r().createElement("div",{className:t.title},r().createElement(a.Text,{block:!0},this.getTitle()),this.getSenders()),r().createElement("div",Cr({className:t.ico,onClick:this.onClose},n?{"data-test-id":"unsubscribe-close"}:{}),r().createElement(a.Icon,{icon:g.ACTIONS_CLOSE}))),r().createElement("div",{className:t.radioGroup},this.getRadioButton(Or)),r().createElement("span",Cr({},n?{"data-test-id":"unsubscribe-submit"}:{}),this.getButtonComponent()))},t=Sr([a.withResponsive,(0,a.withStyles)(Tr)],t)}(r().PureComponent),Ar=n(19465),Rr=n(19275),Nr=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function l(e){try{s(a.next(e))}catch(e){r(e)}}function i(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,i)}s((a=a.apply(e,t||[])).next())}))},Ur=function(e,t){var n,a,o,r,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;if(a=0,o)r=[2&r[0],o.value];switch(r[0]){case 0:case 1:o=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,a=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(o=l.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){l=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){l.label=r[1];break}if(6===r[0]&&l.label<o[1]){l.label=o[1],o=r;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(r);break}if(o[2])l.ops.pop();l.trys.pop();continue}r=t.call(e,l)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}},Dr=function(e){var t=e.router,n=(0,o.useState)(null),a=n[0],l=n[1];return(0,o.useEffect)((function(){if(a){var e=window.vkMiniApp.subscribe({onAppearanceChanged:function(e){Rr.Z.set("themeId",e)}});return window.vkMiniApp.render({navigate:function(e){return Nr(void 0,void 0,void 0,(function(){return Ur(this,(function(n){switch(n.label){case 0:if("number"==typeof e)return history.go(e),[2];if("string"!=typeof e)return[3,4];if(!e.startsWith("#"))return[3,2];else return[4,t.go(e,{},"inherit")];case 1:return[2,n.sent()];case 2:return[4,t.nav(e)];case 3:return[2,n.sent()];case 4:return[4,t.nav("".concat(e.pathname,"?").concat(e.search,"#").concat(e.hash))];case 5:return[2,n.sent()]}}))}))}}),function(){e(),window.vkMiniApp.unmount()}}}),[a,t]),r().createElement("div",{ref:function(e){return l(e)}})},Br=n(67604),Ir=n(20799),Pr=n(82010),xr=n(50987),Hr="_3WUN2v5JZWC8qq7MjJWQ-x",Lr="_2e15S0-qIlEqKmW5_oaQMa",Fr="_29m8FeNwZx_V-0UfFmonv0",Zr="_21GCqWnghrr7F2eHRZSSVA",qr="PGq1t3Gmk8fYUgOx5F9Kg",jr="_1fSw2zKY3t56fnlL27DS3s",Vr="_2ElecynG1ZCBLnwT74Nnah",Wr="_3oF1BVpAI582FhP0zuL9OX",Yr="_1nJssa_iP3RPmap2PwIlh6",zr=D.DEFAULT_AVATAR_SRC+"&width=52&height=52&email="+(null===(Go=xr.Z.get("initialUser"))||void 0===Go?void 0:Go.email)+"&name="+(null===(Xo=null===(Ko=xr.Z.get("initialUser"))||void 0===Ko?void 0:Ko.name)||void 0===Xo?void 0:Xo.first),Gr=function(e){var t=e.folderActive,n=e.models,l=e.router,i=(0,jo.C)({name:"webview-mobile-footer",mediators:["compose-manager","mobile-sidebar-manager"]}),s=(i[0],i[1]);(0,o.useEffect)((function(){(0,Ir.cU)({ids:[Pr.H.account,Pr.H.settings,Pr.H.folders,Pr.H.foldersSettings],data:{folderActive:t,models:n,router:l}})}),[t,n,l]);var d=(0,o.useCallback)((function(){(0,Ir.Ll)({id:Pr.H.account,data:{folderActive:t,models:n,router:l}}),$().send("mobile-account-dock_open")}),[t,n,l]),u=(0,o.useCallback)((function(){if(D.USE_NEW_MOBILE_FOLDERS_MODAL)(0,Ir.Ll)({id:Pr.H.folders,data:{folderActive:t,models:n,router:l}});else s(new Event("mobilesidebar:open"))}),[s,t,n,l]),m=(0,o.useCallback)((function(){s(new Event("compose:new"))}),[s]);return(0,o.useEffect)((function(){return document.documentElement.style.setProperty("--vkui--octavius_size_portal-footer_height--regular","48px"),function(){return document.documentElement.style.setProperty("--vkui--octavius_size_portal-footer_height--regular","0px")}}),[]),r().createElement("div",{className:Hr,"data-qa-id":(0,St.qa)("webview-mobile-footer")},r().createElement("div",{className:Lr},r().createElement("div",{className:c()(Fr,Zr),"data-qa-id":(0,St.qa)("open-sidebar"),onClick:u},r().createElement("div",{className:jr},r().createElement(a.Icon,{icon:g.NAVIGATION_MENU})),r().createElement("span",{className:qr},i18n("Папки"))),r().createElement("div",{className:Wr,"data-qa-id":(0,St.qa)("open-compose"),onClick:m},r().createElement("div",{className:Yr},r().createElement(a.Icon,{icon:g.UNION_ADD_24}))),r().createElement("div",{className:c()(Fr,Zr),"data-qa-id":(0,St.qa)("open-account"),onClick:d},r().createElement("img",{alt:"avatar",src:zr,className:Vr}),r().createElement("span",{className:qr},i18n("Аккаунт")))))},Kr=n(14553),Xr=n(57045),Qr="_3jPEmD1Z8udC_cjjX9EKVE",Jr="_2wSQYRNu6bHO7yiuXBJBeD",$r="B2sZCwno_KqnL5KGK-Omq",el="_2FIN-YZDQLsv6h0kzQ6nK1",tl="_1K3DIcVIz3SR0Uvej6ppka",nl="_3GvTN9SIpXghthZn4cxRt3",al=i18n("Спасибо за ваш интерес! Мы обязательно сообщим, когда всё будет готово"),ol=i18n("Функция вот-вот появится"),rl=i18n("Создать задачу"),ll=function(e){var t,n=e.compact,l=e.onClick,i=e.ponyMode,s=(0,o.useState)(!1),d=s[0],u=s[1];return r().createElement(a.Tooltip,{promo:!0,placement:n?"topRight":"top",visible:d,onClose:function(){u(!1)},overlay:r().createElement("div",{className:tl},r().createElement("div",{className:nl},r().createElement(a.Text,{mode:"h5"},ol)),r().createElement(a.Text,null,al))},r().createElement("button",{className:c()(Qr,(t={},t[Jr]=i,t[$r]=d,t)),onClick:function(){u(!0),null==l||l()}},r().createElement(a.Icon,{icon:g.STATUS_DONE_ROUND}),r().createElement("span",{className:el},rl)))},il=function(e){var t=e.compact,n=e.letterId,a=e.ponyMode;return(0,o.useEffect)((function(){$().send("show_task_from_letter_fake",{dwh:{letter_id:n}})}),[]),r().createElement(ll,{compact:t,ponyMode:a,onClick:function(){$().send("create_task_from_letter_fake",{dwh:{letter_id:n}}),Xr.ZP.set("create_todo_fake_button_shown","true")}})},sl=n(53595),cl=n(78740),dl=n(68021),ul=n(42765),ml=n(70357),pl=n(42061),fl=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),hl=function(e){function t(t){var n=e.call(this,t)||this;return n.handleSuggestClick=n.handleSuggestClick.bind(n),n}return fl(t,e),t.prototype.blur=function(){var e,t;null===(t=(e=this.props).onBlur)||void 0===t||t.call(e)},t.prototype.handleAppendSuggest=function(e,t,n,a){var o=this.props,r=o.search,l=o.onSuggestSelect,i=n?"_".concat(n):"";if($().send("".concat(t).concat(i),{t_feature:"operand_select"}),(0,ul.Sb)(r.smartInput,t,n))r.removeOperand(t,n);else if(t===dl.q.CATEGORY&&r.query.transaction_category)r.updateOperand(t,r.query.transaction_category,n,a);else r.applyOperand(t,n,a);if(!(t===dl.q.DATE||t===dl.q.FOLDER))null==l||l()},t.prototype.handleSuggestClick=function(e,t){var n,a,o=this.props.search;if(t.addressee){var r=t.addressee,l=o.query,i=void 0;if(void 0!==l.query)i=l.query,o.removeOperand(ee.tW.QUERY,ee.tW.QUERY);if(void 0!==l.subject)i=l.subject,o.removeOperand(ee.tW.QUERY,ee.tW.SUBJECT);if(void 0!==(null===(n=l.correspondents)||void 0===n?void 0:n.to))i=l.correspondents.to,o.removeOperand(ee.tW.QUERY,ee.tW.TO);if(void 0!==(null===(a=l.correspondents)||void 0===a?void 0:a.from))i=l.correspondents.from,o.removeOperand(ee.tW.QUERY,ee.tW.FROM);o.applyOperand(ee.tW.QUERY,r,i||""),$().send("".concat(ee.tW.QUERY,"_").concat(r,"}"),{t_feature:"operand_select"})}else if(void 0!==t.folder)if(o.query.folder===t.folder)o.removeOperand(dl.q.FOLDER);else if(void 0!==o.query.folder)o.updateOperand(dl.q.FOLDER,void 0,void 0,t.folder);else o.applyOperand(dl.q.FOLDER,void 0,t.folder)},t.prototype.handlePageClick=function(){},t.prototype.render=function(){var e=this.props.search;return r().createElement(ml.Z,{mobileView:ml.f.Filters,search:e,onSuggestClick:this.handleSuggestClick,onAppendSuggest:this.handleAppendSuggest,onAppendSuggestQuery:this.handleAppendSuggestQuery,onAppendSuggestOperand:this.handleAppendSuggestOperand,onItemsCounted:this.handleSuggestItemsCounted,qaEnabled:(0,St.U)()})},t}(pl.Z),El="_17XzAbEZiUUoTm-P4fLgHx",vl="_3u3rD2hBpqQcsqvZvbm9jc",gl="_39LNx7UF6dCON4-x9cJsHt",yl="sGiygJdoYoEUL1uRF8WdG",bl="_2qJMu-IAUDqlnuq2WbkZ-I",_l="_1BSPA6S1GesUW0M02d3gzw",Tl="_1AulVtyP2EhrjSbQx1fJIO",kl="EbkIV0tIJ8o8Vgczbrjh-",Cl="_2lNpZh5bHJxy8DAPv5XieW",Sl="_3CsuB8lwSJrFzLSjgrIi7m",Ol="_3NIQwXOwCgc4mdnqe6m9PC",Ml=n(77661),wl=function(e){var t=e.searched;return r().createElement(d.Z,null,(function(e){var n=e.Badge;return r().createElement("span",{className:Tl},t&&r().createElement(n,{className:kl,mode:"prominent"}),r().createElement(a.Icon,{icon:g.UNION_DROPDOWN_16}))}))},Al=function(e,t,n){var l=function(e){return(0,o.useMemo)((function(){var t,n,a=e.query;if(void 0!==a.subject)return i18n("Тема");if(void 0!==(null===(t=a.correspondents)||void 0===t?void 0:t.to))return i18n("Кому");if(void 0!==(null===(n=a.correspondents)||void 0===n?void 0:n.from))return i18n("От");else return i18n("Везде")}),[e.query])}(e);return(0,o.useMemo)((function(){var o,i=function(a){if(t&&e.displayedFilter===a)n(void 0);else n(a);e.setDisplayedFilters(a)},s=[{after:r().createElement(a.Icon,{icon:g.UNION_DROPDOWN_16}),type:dl.q.ADDRESSEE,title:l,onClick:function(){return i(dl.q.ADDRESSEE)}},{after:r().createElement(wl,{searched:!!e.query.flags}),type:dl.q.FILTER,title:i18n("Фильтр"),onClick:function(){return i(dl.q.FILTER)}}];if(e.hiddenSuggestMap[dl.q.FOLDER]&&(null===(o=e.folders)||void 0===o?void 0:o.length)>1||void 0!==e.query.folder)s.push({after:r().createElement(wl,{searched:void 0!==e.query.folder}),type:dl.q.FOLDER,title:i18n("Папка"),onClick:function(){return i(dl.q.FOLDER)}});if(!D.SEARCH_HIDE_CATEGORIES)s.push({after:r().createElement(wl,{searched:!!e.query.transaction_category}),type:dl.q.CATEGORY,title:i18n("Категория"),onClick:function(){return i(dl.q.CATEGORY)}});return s}),[l,e.query.folder,e.query.transaction_category,e.query.flags,e.displayedFilter,e.hiddenSuggestMap,e.folders,t])},Rl=function(e){var t=e.search,n=e.activeFilter,a=e.setActiveFilter,l=r().useRef(null),i=r().useRef(null),s=Al(t,n,a);return(0,o.useEffect)((function(){return function(){t.setDisplayedFilters()}}),[]),(0,Ml.O)(n===dl.q.FILTER?[l,i]:i,(function(){if(n)a(void 0)})),r().createElement("div",null,r().createElement(d.Z,null,(function(e){var a=e.Group,o=e.HorizontalScroll,c=e.Tabs,d=e.TabsItem,u=e.FixedLayout;return r().createElement(a,{className:Cl},r().createElement("div",{ref:i},r().createElement(c,{mode:"secondary","data-qa-id":(0,St.qa)("mobile-search-tabs")},r().createElement(o,null,s.map((function(e){return r().createElement(d,{key:e.type,"data-qa-id":(0,St.qa)("mobile-search-tab_"+e.type),after:e.after,onClick:e.onClick,selected:!0},e.title)}))))),r().createElement(u,{className:Sl},n&&r().createElement("div",{className:Ol,ref:l},r().createElement(hl,{active:!0,search:t}))))})))},Nl=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Ul=function(e){function t(t){var n=e.call(this,t)||this;return n.state={searchValue:null},n.onChange=n.onChange.bind(n),n.onClear=n.onClear.bind(n),n.onCancel=n.onCancel.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.state.searchValue=n.props.search.value||null,n}return Nl(t,e),t.prototype.setQueryValue=function(e){var t,n,a=this.props.search.query;this.setState({searchValue:e});var o=ee.tW.QUERY;if(void 0!==a.query)o=ee.tW.QUERY,this.props.search.removeOperand(ee.tW.QUERY,ee.tW.QUERY);if(void 0!==a.subject)o=ee.tW.SUBJECT,this.props.search.removeOperand(ee.tW.QUERY,ee.tW.SUBJECT);if(void 0!==(null===(t=a.correspondents)||void 0===t?void 0:t.to))o=ee.tW.TO,this.props.search.removeOperand(ee.tW.QUERY,ee.tW.TO);if(void 0!==(null===(n=a.correspondents)||void 0===n?void 0:n.from))o=ee.tW.FROM,this.props.search.removeOperand(ee.tW.QUERY,ee.tW.FROM);this.props.search.applyOperand(ee.tW.QUERY,o,e),this.props.search.setValue(e),this.fetchSearchModel(e)},t.prototype.onChange=function(e){var t=e.target.value;if(this.setState({searchValue:t}),this.props.search.setValue(t),!t)this.props.search.clear();this.fetchSearchModel(t)},t.prototype.onClear=function(){this.setState({searchValue:""}),this.props.search.clear()},t.prototype.onCancel=function(){var e,t;null===(t=(e=this.props).onCancel)||void 0===t||t.call(e)},t.prototype.handlePageClick=function(){},Object.defineProperty(t.prototype,"calcValue",{get:function(){var e,t,n=this.props.search.query;return this.state.searchValue||this.props.search.value||n.query||n.subject||(null===(e=n.correspondents)||void 0===e?void 0:e.to)||(null===(t=n.correspondents)||void 0===t?void 0:t.from)||""},enumerable:!1,configurable:!0}),t.prototype.onKeyDown=function(e){var t,n;if(e.keyCode===pl.t)$().send("search",{t_feature:"operand_select"}),null===(n=(t=this.props).onEnter)||void 0===n||n.call(t),this.blur(),this.setQueryValue(e.target.value)},t.prototype.render=function(){var e=this;return r().createElement(d.Z,null,(function(t){var n=t.Input,o=t.IconButton,l=t.AdaptivityProvider,i=t.SizeType;return r().createElement("div",{className:El},r().createElement(o,{onClick:e.onCancel,className:yl},r().createElement(a.Icon,{icon:g.NAVIGATION_ARROW_LIST_PREVIOUS})),r().createElement(l,{sizeY:i.COMPACT},r().createElement(n,{className:vl,type:"search",placeholder:i18n("Поиск"),before:r().createElement("span",{className:gl},r().createElement(a.Icon,{icon:g.NAVIGATION_SEARCH_S})),after:e.calcValue&&r().createElement(o,{hoverMode:"opacity",onClick:e.onClear,className:gl},r().createElement(a.Icon,{icon:g.ACTIONS_CLOSE})),value:e.calcValue,onChange:e.onChange,onKeyDown:e.onKeyDown,autoFocus:!0,onFocus:e.props.onFocus})))}))},t}(pl.Z),Dl=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Bl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Dl(t,e),t.prototype.blur=function(){var e,t;null===(t=(e=this.props).onBlur)||void 0===t||t.call(e)},t.prototype.handlePageClick=function(e){var t,n=this.props,a=n.active,o=n.searchRoot;if(a){var r=Ro().findDOMNode(null==o?void 0:o.current);if(r!==e.target&&!(null===(t=null==r?void 0:r.contains)||void 0===t?void 0:t.call(r,e.target))&&document.body.contains(e.target))this.blur()}},t.prototype.handleAppendSuggestCommon=function(t,n,a,o){if(e.prototype.handleAppendSuggestCommon.call(this,t,n,a,o),n===dl.q.MESSAGE||n===dl.q.QUERY)this.blur()},t.prototype.handleAppendSuggestQuery=function(t,n){e.prototype.handleAppendSuggestQuery.call(this,t,n),this.blur()},t.prototype.render=function(){var e=this.props.search;return r().createElement(ml.Z,{mobileView:ml.f.Suggest,search:e,onAppendSuggest:this.handleAppendSuggest,onAppendSuggestQuery:this.handleAppendSuggestQuery,onAppendSuggestOperand:this.handleAppendSuggestOperand,onItemsCounted:this.handleSuggestItemsCounted,qaEnabled:(0,St.U)()})},t}(pl.Z),Il=function(){document.documentElement.style.setProperty("--vkui--octavius_size_portal-menu_height--regular",D.DISABLE_FOOTER_APP_TOOLBAR?"148px":"112px")},Pl=function(e){var t,n=e.search,a=e.setSearchMode,l=e.searchMode,i=(0,jo.C)({name:"search-mobile-panel",mediators:["search-manager","letters-selection"]}),s=i[0],d=s.active,u=s.searching,m=s.selectMode,p=i[1],f=(0,o.useState)(),h=f[0],E=f[1],v=(0,o.useRef)(document.documentElement.style.getPropertyValue("--vkui--octavius_size_portal-menu_height--regular")),g=(0,o.useRef)(null),y=(0,o.useState)(!1),b=y[0],_=y[1],T=(0,o.useState)(0),k=T[0],C=T[1],S=(0,o.useCallback)((function(){document.documentElement.style.setProperty("--vkui--octavius_size_portal-menu_height--regular",v.current)}),[]);(0,o.useEffect)((function(){if(d)p(new Event("searchpanel:focus")),null==a||a(!0),Il();return function(){S()}}),[]),(0,o.useEffect)((function(){if(l&&!d)p(new Event("searchpanel:focus")),Il()}),[l,p]);var O=(0,o.useCallback)((function(){if(_(!1),!u)null==a||a(!1),S(),p(new Event("searchpanel:blur"))}),[u,p,a]);(0,o.useEffect)((function(){if(u)null==a||a(!0),Il();else O()}),[u,a]);var M=(0,o.useCallback)((function(){p(new Event("searchpanel:blur")),p(new Event("back")),S(),null==a||a(!1)}),[a,p]),w=(0,o.useCallback)((function(){_(!0)}),[]),A=(0,o.useCallback)((function(){_(!1)}),[]),R=(0,o.useCallback)((function(){C(k+1)}),[k]);if(!n||!d)return null;else return r().createElement("div",{ref:g},!!n&&d&&r().createElement(cl.Z,null,!m&&r().createElement(Ul,{active:d,search:n,onCancel:M,onFocus:w,onEnter:A,key:k}),r().createElement(Rl,{search:n,activeFilter:h,setActiveFilter:E}),b&&!h&&r().createElement("div",{className:c()(bl,(t={},t[_l]=D.DISABLE_FOOTER_APP_TOOLBAR,t))},r().createElement(Bl,{searchRoot:g,active:d,search:n,onBlur:O,onSuggestSelect:R}))))},xl=n(21610),Hl=n(73928),Ll=n(93974),Fl=n(4673),Zl=n(5910),ql=n(26510),jl=n(86334),Vl={container:"_1lwCBvq0cmXim-ZbQkhI4Z"},Wl=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Yl=function(){return(Yl=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},zl=function(e,t,n,a){var o,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)if(o=e[i])l=(r<3?o(l):r>3?o(t,n,l):o(t,n))||l;return r>3&&l&&Object.defineProperty(t,n,l),l},Gl=[Hl.OperandFilterTypes.UNREAD,Hl.OperandFilterTypes.FLAGGED,Hl.OperandFilterTypes.ATTACH];function Kl(e,t){if(!e||!t)return!1;else return Fl.ZP.fromRPCInterval(e).equalsEpsilon(Fl.ZP.fromRPCInterval(t))}var Xl,Ql=function(e){function t(t){var n=e.call(this,t)||this;return n.handleAppendSuggest=n.handleAppendSuggest.bind(n),n.handleAllFoldersClick=n.handleAllFoldersClick.bind(n),n.handleAllDatesClick=n.handleAllDatesClick.bind(n),n.handleDataPickerClick=n.handleDataPickerClick.bind(n),n}return Wl(t,e),t.prototype.handleAppendSuggest=function(e,t,n,a,o){var r=this.props.search,l=r.query,i=l.correspondents,s=l.folder,c=l.query,d=l.transaction_category,u=l.interval,m=n?"_".concat(n):"";if($().send("".concat(t).concat(m,"_s"),{t_feature:"operand_select"}),!o){if(!o){if(t===dl.q.CATEGORY&&d)return void r.updateOperand(t,d,n);if(t===dl.q.FOLDER&&s>=0&&s!==r.currentMailbox.id)return void r.updateOperand(t,void 0,void 0,a);if(t===dl.q.DATE&&u)return void r.updateOperand(t,void 0,void 0,a);if(t===dl.q.QUERY){var p=i.to?"to":"from";if(c&&"query"===n)return r.updateOperand(t,dl.q.QUERY,n,a+" "+c),void r.removeOperand(t,p);else return void r.updateOperand(t,p,n)}r.applyOperand(t,n,a)}}else if(t===dl.q.FILTER||t===dl.q.CATEGORY)r.removeOperand(t,n)},t.prototype.handleAllFoldersClick=function(){this.props.search.removeOperand(dl.q.FOLDER)},t.prototype.handleAllDatesClick=function(){this.props.search.removeOperand(dl.q.DATE)},t.prototype.handleDataPickerClick=function(e){var t=this.props,n=t.search,a=t.onSearchPanelFocus;e.stopPropagation(),n.setOperandActive(dl.q.DATE,void 0,{date:Date.now(),lapse:0}),a&&a()},t.prototype.renderElement=function(e){var t=this.props,n=t.search,a=t.shortcut,o=t.qaEnabled,l=t.ponyMode,i=t.nanoMode,s=(e.key||0===e.key)&&e.key.toString(),c=l&&i?"nano":l?"compact":"normal";return r().createElement(ql.Z,Yl({listType:Zl.EA.NAVIGATION,search:n,short:a,mode:c},e,{testId:o&&(e.testId||s),forceFilter:!0}))},t.prototype.renderMailboxes=function(){var e=this,t=this.props.search;if(1===t.allMailboxes.length)return null;var n=t.countedMailboxes,a=t.currentMailbox;return r().createElement(r().Fragment,null,n.map((function(t,n){var o=r().createElement(jl.Z,null,t.email),l=a.id===t.id,i=l,s=Yl(Yl({},t),{tooltip:o,boldText:i});return e.renderElement({key:n,testId:"".concat(dl.q.MAILBOX,":").concat(t.email),mailboxSuggest:s,selected:l,onAppendSuggest:e.handleAppendSuggest})})))},t.prototype.renderContacts=function(){var e=this.props,t=e.search,n=e.shortcut,a=t.query.correspondents;if(a&&!n){var o=a.to,l=a.from;if(!o||!l){var i=o||l;return r().createElement(r().Fragment,null,t.allMailboxes.length>1&&this.renderElement({hr:!0}),this.renderElement({contactSuggest:{email:i,avatarSize:16},onAppendSuggest:this.handleAppendSuggest,selected:!!o,text:"".concat(i18n("Кому"),": "),title:"".concat(i18n("Кому"),": ")+i}),this.renderElement({contactSuggest:{email:i,avatarSize:16},onAppendSuggest:this.handleAppendSuggest,selected:!!l,text:"".concat(i18n("От кого"),": "),title:"".concat(i18n("От кого"),": ")+i}),this.renderElement({onAppendSuggest:this.handleAppendSuggest,text:i18n("Вся переписка"),wordSuggest:{word:i}}))}}},t.prototype.renderFilters=function(){var e=this,t=this.props.search.query.flags,n=void 0===t?{}:t;return r().createElement(r().Fragment,null,this.renderElement({hr:!0}),Gl.map((function(t){return e.renderElement({key:t,onAppendSuggest:e.handleAppendSuggest,selected:n[t],type:t})})))},t.prototype.renderCategories=function(){var e=this;if(!D.SEARCH_HIDE_CATEGORIES){var t=this.props,n=t.search,a=t.categories,o=n.query.transaction_category,l=void 0===o?"":o;return r().createElement(r().Fragment,null,this.renderElement({hr:!0}),a.map((function(t){if(t===Hl.CategoryTypes.DOCUMENT_SCANS)return e.renderElement({key:Hl.CategoryTypes.DOCUMENT_SCANS,onAppendSuggest:e.handleAppendSuggest,selected:t===l,type:Hl.CategoryTypes.DOCUMENT_SCANS,testId:"category:".concat(Hl.CategoryTypes.DOCUMENT_SCANS)});else return e.renderElement({key:t,onAppendSuggest:e.handleAppendSuggest,selected:t===l,type:t,testId:"category:".concat(t)})})))}},t.prototype.renderFolders=function(){var e=this,t=this.props,n=t.search,a=t.shortcut,o=n.folders,l=n.currentMailbox,i=o.filter((function(e){return e.found&&e.folderModel})),s=n.query.folder,c=void 0===s?void 0:String(s);if(!a)if(i.length&&(1!==i.length||void 0!==c&&i[0].id!==c||i[0].isShareTake)){var d=!c&&"0"!==c||c===l.id;return r().createElement(r().Fragment,null,this.renderElement({hr:!0}),this.renderElement({key:"top",onMouseDown:this.handleAllFoldersClick,selected:d,text:i18n("Все папки")}),i.map((function(t){return e.renderElement({folderSuggest:t,key:t.idNumber,onAppendSuggest:e.handleAppendSuggest,selected:c===t.id})})))}},t.prototype.renderDates=function(){var e=this,t=this.props,n=t.search,a=t.shortcut,o=n.response.dates,l=n.query.interval,i=o.all;if(a)return r().createElement(r().Fragment,null,this.renderElement({hr:!0}),this.renderElement({key:"data-picker",iconName:ee.tW.CALENDAR,onMouseDown:function(){},onClick:this.handleDataPickerClick,selected:!1,text:i18n("Указать дату")}));if(!(o.all.length<=1))return r().createElement(cl.Z,{ponyMode:this.props.ponyMode,nanoMode:this.props.nanoMode},this.renderElement({hr:!0}),this.renderElement({key:"top-top",onClick:this.handleAllDatesClick,selected:!l,text:i18n("За всё время")}),i.map((function(t){return e.renderElement({dateSuggest:t,key:t.type+":"+t.from,onAppendSuggest:e.handleAppendSuggest,selected:Kl(t,l)})})))},t.prototype.renderColorTags=function(){var e=this;if(D.ENABLE_COLOR_TAGS_SEARCH){var t=this.props,n=t.search,a=t.colorTags,o=n.query.transaction_category,l=void 0===o?"":o;return r().createElement(r().Fragment,null,this.renderElement({hr:!0}),a.map((function(t){return e.renderElement({key:t,onAppendSuggest:e.handleAppendSuggest,selected:t===l,type:t,testId:"color-tag:".concat(t)})})))}},t.prototype.render=function(){var e,t=this.props,n=t.ponyMode,a=t.nanoMode,o=t.shortcut,l=t.qaEnabled,i=c()(((e={})[Vl.container]=!0,e[Vl.shortcut]=o,e));return r().createElement(cl.Z,{ponyMode:n,nanoMode:a},r().createElement("div",Yl({className:i},l?{"data-test-id":"categories"}:{}),this.renderMailboxes(),this.renderContacts(),this.renderFilters(),this.renderColorTags(),this.renderCategories(),this.renderFolders(),this.renderDates()))},t=zl([Ll.observer],t)}(r().Component),Jl=n(56925),$l=n(43845),ei=n(39385),ti=n(90926),ni=n(6119),ai=n(91206),oi=n(22083),ri=n(1267),li=function(){return(li=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},ii=new rn.k("thread"),si=new rn.k("delimeter");function ci(){var e,t,n=this,a=li(li({},this.props),this.state),o=a.model,l=o.get("subject")||i18n("<Без темы>"),i=a.folders,s=null===(t=null===(e=a.route)||void 0===e?void 0:e.params)||void 0===t?void 0:t.part,c=a.ponymode,d=o.get("transaction_metadata"),u=this.actualLettersEnabled(),m=o.get("messages.0.headers.X-Mailru-Bimi-Organization"),p=this.getResendData(),f=1==a.model.get("length"),h=this._formDatesMetadata(),E=o.get("transaction_category"),v=this.isHideCategory(o);return r().createElement("div",{ref:this.threadRef,"data-qa-id":(0,St.qa)("thread"),"data-transaction-category":a.model.get("transaction_category"),className:ii.root({preview:a["preview-mode"],fluid:!a.compact,compact:a.compact,rounded:a.rounded,touch:a.touch,"no-divider":a.noDivider,compressed:a.ponymode})},r().createElement("div",{className:ii.elem("header",{"pony-mode":a.ponymode})},!a["preview-mode"]&&r().createElement(r().Fragment,null,r().createElement("div",{className:ii.elem("meta-header")},function(){if(n.parentalControlDieEnabled())return r().createElement(I.Z,{type:"parent-filter",model:o,useMediators:["letters-actions","themes-manager"],component:Jt.Z,key:"letter-meta"});if(n.getMessageFolder().isSpam()&&o.get("messages.0.flags.blacklist_spam"))return r().createElement(I.Z,{type:"spam-blacklist",model:o,useMediators:["letters-actions","themes-manager"],component:Jt.Z,key:"letter-meta"});if(o.meta("unread-on-open")&&n.isShowPromoPush())return r().createElement(I.Z,{type:"promo-push-header",model:o,useMediators:["letters-actions","themes-manager"],component:"letter-meta",key:"letter-meta"});if(o.meta("unread-on-open")&&u&&a.actualReasonFeedback&&o.get("actual_reason"))return r().createElement(I.Z,{type:"actual-reason-feedback",model:o,useMediators:["letters-actions","themes-manager"],component:Jt.Z,key:"letter-meta"});if(n.isShowCategoryFeedbackPlate()&&o.meta("unread-on-open"))return r().createElement(I.Z,{type:"category-feedback",model:o,useMediators:["themes-manager"],component:Jt.Z,onShowCategoryFeedbackPlate:n.onShowCategoryFeedbackPlate.bind(n),key:"letter-meta"});if(a.showOfficialSender&&n.isOfficialSender(o))return r().createElement(I.Z,{type:"official-sender",model:o,sender:m,useMediators:["themes-manager"],"data-qa-id":"official-sender-promo",component:Jt.Z,key:"letter-meta"});if(n.isShowPlateMailingSubscribe())return r().createElement(I.Z,{type:"newsletter-mailing-subscribe",model:o,useMediators:["letters-actions","themes-manager"],component:Jt.Z,key:"letter-meta"});if(a.showReliableSender&&n.isReliableSender(o))return r().createElement(I.Z,{type:"reliable-sender",model:o,sender:m,useMediators:["themes-manager"],"data-qa-id":"reliable-sender-promo",component:Jt.Z,key:"letter-meta"});if(n.isFakeDoorFmail18333Visible(o))return r().createElement(I.Z,{type:"fake-door-header-fmail-18333",model:o,component:Jt.Z,key:"letter-meta"});else return}()),r().createElement(I.Z,{model:o,senderEmail:this.getSenderEmail(o),receivers:this.getReceivers(o),"dark-mode":a["dark-mode"],component:oi.Z,key:"promo-domain-die"})),r().createElement("div",{className:ii.elem("subject-line")},r().createElement("h2",{key:"thread-subject",className:ii.elem("subject",{"pony-mode":a.ponymode}),"data-qa-id":"subject"},l),!(a["disable-category"]||o.getFolder().isSpam())&&function(){if(a["category-feedback"]&&!o.getFolder().isShareTake())if(n.hasCategory(o)&&!v)return r().createElement("div",{className:ii.elem("category")},r().createElement(I.Z,{model:o,useMediators:["settings-manager","themes-manager"],component:ti.Z,key:"category-feedback"}));else return;if(E&&!v)return r().createElement("div",{className:ii.elem("category")},r().createElement(I.Z,{name:E,short:a.touch,component:Kt.Z,key:"letter-category"}))}()),!a.isResendDropdownDisabled&&p&&r().createElement(go,{"class-name":"thread__resend-dropdown",resendFrom:p.from,resendTo:p.to,resendDate:p.date,receivedDate:p.receivedDate,darkMode:a["dark-mode"],qaEnabled:(0,St.U)()}),r().createElement("div",{className:ii.elem("letter-meta")},this.needLetterMeta()&&r().createElement(I.Z,{model:o,metadata:d,ponymode:a.ponymode,calendar:this.getFirstCalendarAttach(),useMediators:["themes-manager","layout-manager","letters-selection"],remitEvents:{render:"letter-meta:render",letterclick:"letter-meta:letterclick"},broadcastEvent:(0,xt.Yv)(this),component:Jt.Z,needLetterMetaSkeleton:this.needLetterMetaSkeleton(),key:"letter-meta"}))),!!a.hasDraft&&r().createElement("div",{className:ii.elem("letter",{first:!0,expanded:!0})},a.draft?r().createElement(I.Z,{model:a.draft,touch:a.touch,disabled:!0,draft:!0,"disable-select":!0,"disable-subject":!0,"disable-category":!0,compressed:c,remitEvents:{click:"draft:open"},broadcastEvent:(0,xt.Yv)(this),component:ni.Z,key:"letter-list-item"}):r().createElement(I.Z,{touch:a.touch,compressed:c,component:ai.Z,key:"letter-list-item-placeholder"})),a.model.get("messages").map((function(e,t){var o=0==t,l=a.model.get("length")==t+1,u=!a.model.canUnfoldMessage(e),m=n.isPrevCollapsed(t),p=n.isNextCollapsed(t),E=n.isSticky(e.id),v=!n.isCollapsed(e.id),g=0!==t?a.model.get("messages")[t-1]:null,y=g&&(null==g?void 0:g.is("flags.bimi_important_msg"))&&D.SHOW_RELIABLE_ON_LETTER_LIST&&!D.DISABLE_GREEN_RELIABLE_ON_LETTER_LIST,b=g&&(null==g?void 0:g.is("flags.official"))&&D.SHOW_OFFICIAL_ON_LETTER_LIST&&!D.DISABLE_GREEN_OFFICIAL_ON_LETTER_LIST,_=!1,T=!1,k=(0,Lt.x9)(e),C=(0,Lt.NL)(e);if(!k&&!C)_=(0,Lt.F9)(e),T=(0,Lt.JM)(e);var S=o||y||b||T||k;if(!a["preview-mode"]||!n.isCollapsed(e.id))return r().createElement("div",{key:e.id,"data-id":e.id,"data-qa-id":(0,St.qa)("thread-letter:".concat(t+1)),"data-qa-state":(0,St.qa)("open:".concat(!n.isCollapsed(e.id))),className:ii.elem("letter",{expanded:v,"expanded-next":!p,"expanded-prev":!o&&!m,collapsed:n.isCollapsed(e.id)&&!a["preview-mode"],"collapsed-next":p,first:o,last:l,single:f,react:!0})},!n.isCollapsed(e.id)&&r().createElement(fa,{route:a.route,router:a.router,model:e,parentThread:a.model,folders:i,autoread:e.isDataFully()&&!a["preview-mode"],"allow-collapse":a.model.get("length")>1&&!a["preview-mode"],readonly:a["preview-mode"],single:f,"collapsed-default":u,first:o,last:l,touch:a.touch,sticky:n.isStickyEnabled()&&E&&a.sticky,showfolder:a.model.get("folder")!=e.get("folder"),"quotes-collapsed-default":!l,"disable-category":!0,"disable-edit":s,compactTranslator:a.compact,ponymode:c,"dark-mode":a["dark-mode"],"expanded-next":!p,"preview-mode":a["preview-mode"],"dates-metadata":h,"transaction-metadata":d,useMediators:["user-info","layout-manager","settings-filters-manager","attachments-manager","calendar-manager","translator-manager","addressbook-manager","share-folders-manager","settings-manager","calls-manager","marusia-manager","thread-scroller","letters-actions","compose-manager"],remitEvents:{clickhead:"letter:close","attaches:expanded":"letter:expand:attaches","attaches:collapsed":"letter:collapsed:attaches",resize:"letter:resize","letter-force-recalc":"force:recalc","translator:scrollto":"translator:scrollto"},updateRemitEventsName:!0,broadcastEvent:(0,xt.Yv)(n),remitDetails:e,key:"letter"}),!(!n.isCollapsed(e.id)||a["preview-mode"])&&r().createElement("div",{onClick:(0,xt.CH)(n,{name:"letter:open",details:e})},a.touch?r().createElement(Ra.Z,{"in-thread":!0,"disable-subject":!0,"disable-select":!0,"disable-avatar-hover":!0,"enable-user-select":!0,key:"list-letter-common",first:o||!m,hideDelimeter:S,isImportantReliable:T,isReliable:_,isOfficial:C,isOfficialGreen:k,last:l||!p,"pony-mode":c,model:e,"main-field":"from",showfolder:a.model.get("folder")!=e.get("folder"),welter:!1,useMediators:["letters-actions","layout-manager"],"layout-mode":"2pane",remitEvents:{contextmenu:"letter:rightclick"},broadcastEvent:(0,xt.Yv)(n),remitDetails:e,fromThread:!0}):r().createElement(ri.Z,{"in-thread":!0,"disable-subject":!0,"disable-select":!0,"disable-avatar-hover":!0,"enable-user-select":!0,key:"list-letter-common",first:o||!m,hideDelimeter:S,isImportantReliable:T,isReliable:_,isOfficial:C,isOfficialGreen:k,last:l||!p,"pony-mode":c,model:e,"main-field":"from",showfolder:a.model.get("folder")!=e.get("folder"),welter:!1,useMediators:["letters-actions","layout-manager"],"layout-mode":"2pane",remitEvents:{contextmenu:"letter:rightclick"},broadcastEvent:(0,xt.Yv)(n),remitDetails:e,fromThread:!0})),!a["preview-mode"]&&r().createElement("div",{className:si.root({full:v||!m})}));else return null})),r().createElement("div",{className:ii.elem("rounding-footer")}),a.kaspersky&&!a["preview-mode"]?r().createElement("div",{className:ii.elem("footer")},r().createElement("div",{className:ii.elem("kaspersky")},r().createElement(dt,{isEngLogo:this.isEngKasperskyLogo(),onLogoLinkClick:(0,xt.CH)(this,{stop:!0,name:"click-kaspersky"}),contrast:!(a.isDarkDefaultMode||a.isLightDefaultMode)}))):r().createElement("div",{className:ii.elem("footer",{empty:!0})}))}!function(e){e.mount="$mount",e.unmount="$destroyed",e.clickKaspersky="clickkaspersky"}(Xl||(Xl={}));var di=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),ui=function(){return(ui=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o];return e}).apply(this,arguments)},mi=function(e,t,n){if(n||2===arguments.length)for(var a,o=0,r=t.length;o<r;o++)if(a||!(o in t)){if(!a)a=Array.prototype.slice.call(t,0,o);a[o]=t[o]}return e.concat(a||Array.prototype.slice.call(t))}([],Object.values(ei.u.events),!0),pi=function(e){function t(t){var n=e.call(this,t)||this;if(n.thredMounted=!1,n.events=ei.u.events,n.isCollapsed=ei.u.isCollapsed,n.onDraftOpen=ei.u.onDraftOpen,n.onLetterOpen=ei.u.onLetterOpen,n.onLetterClose=ei.u.onLetterClose,n.onRightClick=ei.u.onRightClick,n.onLetterMetaRender=ei.u.onLetterMetaRender,n.onLetterMetaClick=ei.u.onLetterMetaClick,n.onTranslatorScrollTo=ei.u.onTranslatorScrollTo,n.bindThread=ei.u.bindThread,n.getSenderEmail=ei.u.getSenderEmail,n.getReceivers=ei.u.getReceivers,n.unbindThread=ei.u.unbindThread,n.isStickyEnabled=ei.u.isStickyEnabled,n.isSticky=ei.u.isSticky,n.isNextCollapsed=ei.u.isNextCollapsed,n.isPrevCollapsed=ei.u.isPrevCollapsed,n.isHideCategory=ei.u.isHideCategory,n.isReliableSender=ei.u.isReliableSender,n.onShowCategoryFeedbackPlate=ei.u.onShowCategoryFeedbackPlate,n.isShowPlateMailingSubscribe=ei.u.isShowPlateMailingSubscribe,n.isShowCategoryFeedbackPlate=ei.u.isShowCategoryFeedbackPlate,n.isShowPromoPush=ei.u.isShowPromoPush,n.parentalControlDieEnabled=ei.u.parentalControlDieEnabled,n.hasCategory=ei.u.hasCategory,n.actualLettersEnabled=ei.u.actualLettersEnabled,n.getMessageFolder=ei.u.getMessageFolder,n.setExpId=ei.u.setExpId,n._setExpanded=ei.u._setExpanded,n._loadDraft=ei.u._loadDraft,n.scrollLetterIntoView=ei.u.scrollLetterIntoView,n.scheduleScrollLetterIntoView=ei.u.scheduleScrollLetterIntoView,n._loadLetter=ei.u._loadLetter,n._closeLetter=ei.u._closeLetter,n.getFirstCalendarAttach=ei.u.getFirstCalendarAttach,n.isEngKasperskyLogo=ei.u.isEngKasperskyLogo,n._formDatesMetadata=ei.u._formDatesMetadata,n.getResendData=ei.u.getResendData,n.isOfficialSender=ei.u.isOfficialSender,n.usePortalSearchPanel=ei.u.usePortalSearchPanel,n.needLetterMeta=ei.u.needLetterMeta,n.needLetterMetaSkeleton=ei.u.needLetterMetaSkeleton,n.isFakeDoorFmail18333Visible=ei.u.isFakeDoorFmail18333Visible,n.onKasperskyLogoClick=ei.u.onKasperskyLogoClick,n.onToggleIcsAttach=ei.u.onToggleIcsAttach,n.needHideAttachList=ei.u.needHideAttachList,n.isTrackingStatusPlate=ei.u.isTrackingStatusPlate,n.render=ci,n.threadRef=r().createRef(),t.model)n._setExpanded(t.model);return mi.forEach((function(e){n[e]=n[e].bind(n)})),n}return di(t,e),Object.defineProperty(t.prototype,"el",{get:function(){return this.threadRef.current},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.thredMounted=!0,ei.u.didMount.bind(this)(),this.updateModel(ui(ui({},this.props),this.state).model,void 0),this.loadDraft(ui(ui({},this.props),this.state)),this.setExpanded(),(0,$l.PI)("readletter")},t.prototype.componentDidUpdate=function(e,t){var n=ui(ui({},this.props),this.state),a=ui(ui({},e),t);if(ei.u.didUpdate.bind(this)(),n.model!==a.model)this.updateModel(n.model,a.model);if(n["load-draft-disabled"]!==a["load-draft-disabled"]&&!1===n["load-draft-disabled"])this.loadDraft(n);if(this.props["expand-letter-id"]!==e["expand-letter-id"]&&this.props["expand-letter-id"]&&this.props.model)this.setExpanded()},t.prototype.componentWillUnmount=function(){this.thredMounted=!1,ei.u.didUnmount.bind(this)()},t.prototype.handleInnerEvent=function(e){switch(e.type){case Xl.mount:return void(0,pt.ZP)(["thread","mount"],1,(0,Ht.fo)(this));case Xl.unmount:return void(0,pt.ZP)(["thread","unmount"],1,(0,Ht.tA)(this));case Xl.clickKaspersky:(0,pt.ZP)(["thread","kaspersky_click"])}},t.prototype.updateModel=function(e,t){this.unbindThread(t),this.bindThread(e)},t.prototype.isMounted=function(){return this.thredMounted},t.prototype.loadDraft=function(e){this._loadDraft(e.model)},t.prototype.setExpanded=function(){this._setExpanded(this.get("model"),!0)},t.prototype.get=function(e){return ui(ui({},this.props),this.state)[e]},t.prototype.update=function(){this.forceUpdate()},t}(r().Component),fi=(0,xt.v$)("thread",pi,{syncMediatorsOnRender:!1});fi.defaultProps=ei.u.defaults;var hi=fi,Ei={AccountDock:i.Z,AdFeedback:v,AdFeedback2step:O,AttachIcon:M.default,AttachThumb:ye,AttachmentButton:w.default,AttachmentDropdown:A.default,AttachSafetyStatus:Q,ChangeLanguage:ar.Z,ClipInListItem:Me.Z,CreateTodo:il,DatasetLetters:sl.Z,ErrorBoundary:Le.Z,FeastBlock:I.Z,FileLimitPopup:Ne,KasperskyLogo:dt,LayerChooseSaveFolder:mt,LayerConfirmMoveToSpam:_t,LayerFakeDoor:Ct,LayerPromoEnabledPush:Mt,LayerTemplateSelect:Dt,Letter:fa,LetterBody:hn,LetterHeaderActions:ha.LetterHeaderActions,LetterMetaSkeleton:wa,LetterTags:_n,LettersDivider:Aa.Z,ListLetterCommonTouch:Ra.Z,ListLetterCompactTouch:Na.Z,ListLetterGoToActionButton:Ua.Z,ListLetterHeaderActions:Da.ListLetterHeaderActions,ListLetterTags:Ba.Z,MarusiaReadLetterButton:An,MetathreadsSettingsContainer:Ia.Z,NoadsButton:Oe,NotificationBadge:Ln,OctopusLogo:Pa,OversizeAttachCancelPopup:Ha,PriorityWidget:Ya,PromtAboutAdWrapper:Ja,PromtTooltip:ao,ReceiptWidget:io,RemindWidget:ho,ResendDropdown:go,SidebarUnsubscribeButton:or.Z,ScheduleWidget:Mo,SearchMobilePanel:Pl,SearchAttachmentButton:wo.Z,SearchPanel:xl.default,SearchPanelInput:pl.Z,SearchSidebar:Ql,SettingsDock:Jl.default,SuggestsForm:Er,Swipeable:vr.Z,TagsPicker:yn.Z,Thread:hi,UnsubscribeDropdown:wr,VKUIOverlay:Br.default,VkMessengerProvider:Ar.default,WebviewMobileFooter:Gr,WidgetColumn:Kr.WidgetColumn,getFullMomentFormat:function(e){return bo()(e).calendar(null,ko)},VKMiniApp:Dr,Error:He,AttachViolatedFileNamePopup:function(e){var t=(0,o.useState)(!0),n=t[0],i=t[1],s=e.violatedAttaches,c=function(){e.onClose(),i(!1)},d=e.uploadedAttachmentsCount>0?i18n("Остальные файлы загружены в хранилище."):null,u=i18n("Файлы {strongOpen}{violatedAttaches}{strongClose} не могут быть загружены в хранилище в соответствии с правилами безопасности. Обратитесь к администратору.",{violatedAttaches:s,"unsafe-strongOpen":"<strong>","unsafe-strongClose":"</strong>"});if(d)u="".concat(u," ").concat(d);return r().createElement(a.Popup,{show:n,onHide:c,testId:"attach-violated-file-name-popup"},r().createElement(a.Panel,{popup:!0,onClose:c,header:l.title,size:"small",content:r().createElement(r().Fragment,null,r().createElement(a.Text,null,r().createElement("span",{dangerouslySetInnerHTML:{__html:u}}))),controls:r().createElement(a.Button,{text:l.close,onClick:c,testId:"close-button"})}))},ContextMenuPositionManager:nr}},39061:function(){}}]);