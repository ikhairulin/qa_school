export const fingerPrint=()=>{let e="rb_sync_id",t=e=>{try{return window.localStorage.getItem(e)}catch(t){return null}},r=(e,t)=>{try{return window.localStorage.setItem(e,t)}catch(r){}},n=e=>{let r={};try{let n=t(e);n&&(r=JSON.parse(n))}catch($){}return r},$=(e,t)=>{try{r(e,JSON.stringify(t))}catch(n){}},c=t=>{let r=n(e)||{};return r?r[t]:null},a=(t,r)=>{let c=n(e)||{};c[t]=r,$(e,c)},f=t=>{let r=n(e)||{};delete r[t],$(e,r)},o=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]},l=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]},u=function(e,t){return 32==(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])},_=function(e,t){return 0==(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]},h=function(e,t){return[e[0]^t[0],e[1]^t[1]]},i=function(e){return e=h(e,[0,e[0]>>>1]),e=l(e,[4283543511,3981806797]),e=h(e,[0,e[0]>>>1]),e=l(e,[3301882366,444984403]),e=h(e,[0,e[0]>>>1])},s=function(e,t){t=t||0;for(var r=(e=e||"").length%16,n=e.length-r,$=[0,t],c=[0,t],a=[0,0],f=[0,0],s=[2277735313,289559509],d=[1291169091,658871167],x=0;x<n;x+=16)a=[255&e.charCodeAt(x+4)|(255&e.charCodeAt(x+5))<<8|(255&e.charCodeAt(x+6))<<16|(255&e.charCodeAt(x+7))<<24,255&e.charCodeAt(x)|(255&e.charCodeAt(x+1))<<8|(255&e.charCodeAt(x+2))<<16|(255&e.charCodeAt(x+3))<<24],f=[255&e.charCodeAt(x+12)|(255&e.charCodeAt(x+13))<<8|(255&e.charCodeAt(x+14))<<16|(255&e.charCodeAt(x+15))<<24,255&e.charCodeAt(x+8)|(255&e.charCodeAt(x+9))<<8|(255&e.charCodeAt(x+10))<<16|(255&e.charCodeAt(x+11))<<24],a=l(a,s),a=u(a,31),a=l(a,d),$=h($,a),$=u($,27),$=o($,c),$=o(l($,[0,5]),[0,1390208809]),f=l(f,d),f=u(f,33),f=l(f,s),c=h(c,f),c=u(c,31),c=o(c,$),c=o(l(c,[0,5]),[0,944331445]);switch(a=[0,0],f=[0,0],r){case 15:f=h(f,_([0,e.charCodeAt(x+14)],48));case 14:f=h(f,_([0,e.charCodeAt(x+13)],40));case 13:f=h(f,_([0,e.charCodeAt(x+12)],32));case 12:f=h(f,_([0,e.charCodeAt(x+11)],24));case 11:f=h(f,_([0,e.charCodeAt(x+10)],16));case 10:f=h(f,_([0,e.charCodeAt(x+9)],8));case 9:f=h(f,[0,e.charCodeAt(x+8)]),f=l(f,d),f=u(f,33),f=l(f,s),c=h(c,f);case 8:a=h(a,_([0,e.charCodeAt(x+7)],56));case 7:a=h(a,_([0,e.charCodeAt(x+6)],48));case 6:a=h(a,_([0,e.charCodeAt(x+5)],40));case 5:a=h(a,_([0,e.charCodeAt(x+4)],32));case 4:a=h(a,_([0,e.charCodeAt(x+3)],24));case 3:a=h(a,_([0,e.charCodeAt(x+2)],16));case 2:a=h(a,_([0,e.charCodeAt(x+1)],8));case 1:a=h(a,[0,e.charCodeAt(x)]),a=l(a,s),a=u(a,31),a=l(a,d),$=h($,a)}return $=h($,[0,e.length]),c=h(c,[0,e.length]),$=o($,c),c=o(c,$),$=i($),c=i(c),$=o($,c),c=o(c,$),("00000000"+($[0]>>>0).toString(16)).slice(-8)+("00000000"+($[1]>>>0).toString(16)).slice(-8)+("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)},d=()=>{let e=()=>{try{return navigator.userAgent?navigator.userAgent:null}catch(e){return null}},t=()=>{try{return navigator.webdriver?navigator.webdriver:null}catch(e){return null}},r=()=>{try{return navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||null}catch(e){return null}},n=()=>{try{return window.screen.colorDepth?window.screen.colorDepth:null}catch(e){return null}},$=()=>{try{return navigator.deviceMemory?navigator.deviceMemory:null}catch(e){return null}},c=()=>{try{return window.devicePixelRatio?window.devicePixelRatio:null}catch(e){return null}},a=()=>{try{let e=[window.screen.width,window.screen.height];return e.sort().reverse(),e.join(";")}catch(t){return null}},f=()=>{try{let e=[window.screen.availWidth,window.screen.availHeight];return e.sort().reverse(),e.join(";")}catch(t){return null}},o=()=>{try{return new Date().getTimezoneOffset()}catch(e){return null}},l=()=>{try{return window.Intl&&window.Intl.DateTimeFormat?new window.Intl.DateTimeFormat().resolvedOptions().timeZone:null}catch(e){return null}},u=()=>{try{return!!window.localStorage}catch(e){return null}},_=()=>{try{return!!window.sessionStorage}catch(e){return null}},h=()=>{try{return!!window.indexedDB}catch(e){return null}},i=()=>{try{return!!window.openDatabase}catch(e){return null}},s=()=>{try{return navigator.hardwareConcurrency?navigator.hardwareConcurrency:null}catch(e){return null}},d=()=>{try{return navigator.cpuClass?navigator.cpuClass:null}catch(e){return null}},x=()=>{try{return navigator.platform?navigator.platform:null}catch(e){return null}},y=()=>{try{return navigator.doNotTrack||navigator.msDoNotTrack||window.doNotTrack||null}catch(e){return null}},C=()=>{try{let e=0,t;void 0!==navigator.maxTouchPoints?e=navigator.maxTouchPoints:void 0!==navigator.msMaxTouchPoints&&(e=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent"),t=!0}catch(r){t=!1}let n="ontouchstart"in window;return[e,t,n].join(";")}catch($){return null}},g=()=>{try{window.location.hostname&&window.location.hostname}catch(e){return null}},A={domain:g(),userAgent:e(),webdriver:t(),language:r(),colorDepth:n(),deviceMemory:$(),pixelRatio:c(),screenResolution:a(),availableScreenResolution:f(),timezone:l(),timezoneOffset:o(),hasLocalStorage:u(),hasSessionStorage:_(),hasIndexedDb:h(),hasOpenDB:i(),hardwareConcurrency:s(),cpuClass:d(),platform:x(),dnt:y(),touchSupport:C()};return Object.keys(A).filter(function(e){return null!=A[e]}).reduce(function(e,t){return e[t]=A[t],e},{})},x=d(),y=s(JSON.stringify(x),15),C=e=>{let t="https://r3.mail.ru/fp/?id="+e;try{fetch(t,{method:"POST",body:JSON.stringify(x),headers:{"Content-Type":"application/json"}}).then(()=>{})}catch(r){}},g=()=>{let e=c("fid");e&&e!==y?a("fpid",e):f("fpid"),e!==y&&(a("fid",y),r("_syncml_id",y),C(y)),window.rb_sync_id=y};return{init:g}};